<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Writeup for MRCTF2021 crypto | Dawn_whisper's blog</title><meta name="keywords" content="Crypto,Writeup"><meta name="author" content="Dawn_whisper"><meta name="copyright" content="Dawn_whisper"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Writeup for MRCTF2021&#39;s crypto比赛前打了疫苗，困得要命，然后神志不清的写了一堆shi，虽然比赛的时候心态炸了，但高质量的题目该复现还得复现 friendly_sign-in签到题，定义了一个函数，要求提供使得 $f(x_{list})&#x3D;0$ 的x-list，回答一次给一位 $flag$ ，但之后的不能和之前的重复 直接系数两两交换，其中一个取相反数，然后为了前">
<meta property="og:type" content="article">
<meta property="og:title" content="Writeup for MRCTF2021 crypto">
<meta property="og:url" content="http://example.com/2021/04/16/Wp_for_mrctf2021/index.html">
<meta property="og:site_name" content="Dawn_whisper&#39;s blog">
<meta property="og:description" content="Writeup for MRCTF2021&#39;s crypto比赛前打了疫苗，困得要命，然后神志不清的写了一堆shi，虽然比赛的时候心态炸了，但高质量的题目该复现还得复现 friendly_sign-in签到题，定义了一个函数，要求提供使得 $f(x_{list})&#x3D;0$ 的x-list，回答一次给一位 $flag$ ，但之后的不能和之前的重复 直接系数两两交换，其中一个取相反数，然后为了前">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/img/top_img.jpg">
<meta property="article:published_time" content="2021-04-16T11:58:26.000Z">
<meta property="article:modified_time" content="2021-04-25T12:07:52.000Z">
<meta property="article:author" content="Dawn_whisper">
<meta property="article:tag" content="Crypto">
<meta property="article:tag" content="Writeup">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/img/top_img.jpg"><link rel="shortcut icon" href="/img/avatar.jpg"><link rel="canonical" href="http://example.com/2021/04/16/Wp_for_mrctf2021/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":false,"highlightLang":true},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":50,"languages":{"author":"作者: Dawn_whisper","link":"链接: ","source":"来源: Dawn_whisper's blog","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2021-04-25 20:07:52'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    })(window)</script><meta name="generator" content="Hexo 5.2.0"><link rel="alternate" href="/atom.xml" title="Dawn_whisper's blog" type="application/atom+xml">
</head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="/img/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">30</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">10</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">6</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/books/"><i class="fa-fw fas fa-book"></i><span> Paper&amp;books</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/links/"><i class="fa-fw fas fa-link"></i><span> Links</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/top_img.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Dawn_whisper's blog</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/books/"><i class="fa-fw fas fa-book"></i><span> Paper&amp;books</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/links/"><i class="fa-fw fas fa-link"></i><span> Links</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Writeup for MRCTF2021 crypto</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-04-16T11:58:26.000Z" title="发表于 2021-04-16 19:58:26">2021-04-16</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-04-25T12:07:52.000Z" title="更新于 2021-04-25 20:07:52">2021-04-25</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Writeup/">Writeup</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="Writeup-for-MRCTF2021-39-s-crypto"><a href="#Writeup-for-MRCTF2021-39-s-crypto" class="headerlink" title="Writeup for MRCTF2021&#39;s crypto"></a>Writeup for MRCTF2021&#39;s crypto</h1><p>比赛前打了疫苗，困得要命，然后神志不清的写了一堆shi，虽然比赛的时候心态炸了，但高质量的题目该复现还得复现</p>
<h2 id="friendly-sign-in"><a href="#friendly-sign-in" class="headerlink" title="friendly_sign-in"></a>friendly_sign-in</h2><p>签到题，定义了一个函数，要求提供使得 $f(x_{list})=0$ 的<code>x-list</code>，回答一次给一位 $flag$ ，但之后的不能和之前的重复</p>
<p>直接系数两两交换，其中一个取相反数，然后为了前后不重复再乘一个系数即可</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha512</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">table = <span class="string">&#x27;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&#x27;</span></span><br><span class="line"><span class="comment"># context(log_level=&#x27;debug&#x27;)</span></span><br><span class="line">r = remote(<span class="string">&quot;node.mrctf.fun&quot;</span>, <span class="string">&quot;10007&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">passpow</span>():</span></span><br><span class="line">    rev = r.recvuntil(<span class="string">&quot;POW: SHA512(&quot;</span>)</span><br><span class="line">    r.recv(<span class="number">1</span>)</span><br><span class="line">    suffix = r.recv(<span class="number">8</span>).decode()</span><br><span class="line">    print(suffix)</span><br><span class="line">    r.recvline()</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">f</span>(<span class="params">x</span>):</span></span><br><span class="line">        hashresult = hashlib.sha512((suffix+x).encode()).hexdigest()</span><br><span class="line">        <span class="keyword">if</span> hashresult.startswith(<span class="string">&quot;11111&quot;</span>):</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    prefix = util.iters.mbruteforce(f,table,<span class="number">4</span>,<span class="string">&#x27;upto&#x27;</span>)</span><br><span class="line">    r.sendline(str(prefix))</span><br><span class="line"></span><br><span class="line">passpow()</span><br><span class="line">r.recvline()</span><br><span class="line">r.recvuntil(<span class="string">&quot;N = &quot;</span>)</span><br><span class="line">data = r.recvline(<span class="literal">False</span>).strip().decode()[<span class="number">1</span>:<span class="number">-1</span>]</span><br><span class="line">data = data.split(<span class="string">&quot;,&quot;</span>)</span><br><span class="line">N = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> data:</span><br><span class="line">    N.append(int(i))</span><br><span class="line"><span class="comment"># print(len(N))</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> range(len(N)<span class="number">-1</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(N),<span class="number">2</span>):</span><br><span class="line">        r.sendline(str(-(j+<span class="number">1</span>)*N[i+<span class="number">1</span>]))</span><br><span class="line">        r.sendline(str((j+<span class="number">1</span>)*N[i]))</span><br><span class="line">    r.recvuntil(<span class="string">&quot;your gift:&quot;</span>)</span><br><span class="line">    ans = r.recvline(<span class="literal">False</span>).strip().decode()</span><br><span class="line">    flag += ans</span><br><span class="line">    print(flag)</span><br><span class="line"></span><br><span class="line">print(long_to_bytes(int(flag,<span class="number">2</span>)))</span><br><span class="line"></span><br><span class="line"><span class="comment"># r.interactive()</span></span><br></pre></td></tr></table></figure>

<h2 id="nomore"><a href="#nomore" class="headerlink" title="nomore"></a>nomore</h2><p>小模数RSA，其中 $e\in (9000,10000)$ ， $p,q\in (1000000, 3000000)$ ，给了 $A=(((y%x)^7)%(x%y))^7+y^5+(y+1)/x$ ，一个条件 $secret=e^3+p^3+q^3=(x+y)%7754486886526049041+210729175671163973$ 和 $x$ 的上界</p>
<p>感觉是为了出题而出题，条件给的好僵硬（</p>
<p>因为这里是 $(y+1)/x$ 整除，所以得到 $y+1=k\cdot x$ （这样出题这里好没有说服力啊= =），所以 $y=k\cdot x-1$ ，带入A中化简一下可得 $A=(x-1)^7+(kx-1)^5+k$ ，显然这个玩意是递增的，而且给了 $x$ 的上界，这里可以用二分法得到 $x$ 的值，随后得到 $secret$ ，接着爆破得到 $e,p,q$</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c = <span class="number">693282726315</span></span><br><span class="line">A = <span class="number">2235930885430590738951770802593215586722001521194365487273377655750584443688709547709496531484159367793509666612116139038917661713102981488722293426038029073850795986080412124312908732573382156365974821471629333126275130148211145598662897276781331183691743094904957217401055325352877284530068805608962270139656431076370452327497416723045785664344412694060886085511378779487559306015113302658964110922621164879307182468690182325142055960562810349297544601157473985262796723316777380726315782859115449976700612343978057140270903396910431420116573138154719798955123904805279320166126412714788508008881174164656203605409187705643395043643983135944514470267283183175620492198093264226038082725867230101096344723124629565311122528005863046865164876192248803940590219355154176343702897505891392317123983475290611327887699795851456183931854177169939743970260837586185988111368384484356413787993370384262996486824251003884057486063787194241555190688935624792041028246639984544749568167915235629185515957106136630401960066317998226671344793061752525215496195839080165952892472180997564802474095868944184005854120238623750555477937802107959321257495435617363809377093354132077991399603767147974592666019334636208414969819333321639542282741932229892501074615920120228860717401055433206357806353717291748096464569063777964784860874773660469621546777686833078007220613545223169043960754010332944526795605043595879174073360317477199909570141202125189377475655277483919081658123820105695508771837612756891055031293872293977244105248233915807603916034288916844336329883443200123825714530812637709561686224468031953278836676202928878535091578725509651544544672494980806630321114490828976895602038151224026672265830787863940762596976124958000977955469148027648603199590311852993367450800166591526272653355552342455506908317529193196174849749103073968182002498580115241030154502931088245539152380579199202750010140022979979488971008874424439325749039212427088023136971891092490697689178097172878439007028844083681030357488034860471042630885195387680286557424780235116405464735985082715745087677866688657626763753940919966662710093619034074861812080778855241391731006</span></span><br><span class="line"></span><br><span class="line">flag = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> range(<span class="number">1000</span>):</span><br><span class="line">    upper = <span class="number">4000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</span></span><br><span class="line">    lower = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span>(upper - lower &gt; <span class="number">1</span>):</span><br><span class="line">        x = (upper + lower) &gt;&gt; <span class="number">1</span></span><br><span class="line">        ans = (x<span class="number">-1</span>)**<span class="number">7</span> + (k*x<span class="number">-1</span>)**<span class="number">5</span> + k</span><br><span class="line">        <span class="keyword">if</span>(ans == A):</span><br><span class="line">            print(<span class="string">&quot;Ans Found!&quot;</span>)</span><br><span class="line">            print(k,x)</span><br><span class="line">            flag = <span class="number">1</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">elif</span>(ans &gt; A):</span><br><span class="line">            upper = x</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            lower = x</span><br><span class="line">    <span class="keyword">if</span>(flag):</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">y = k*x - <span class="number">1</span></span><br><span class="line">secret = (x + y) % <span class="number">7754486886526049041</span> + <span class="number">210729175671163973</span></span><br><span class="line">my_prime = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1000001</span>,min(<span class="number">3000000</span>,iroot(secret,<span class="number">3</span>)[<span class="number">0</span>]),<span class="number">2</span>):</span><br><span class="line">    <span class="keyword">if</span>(isPrime(i)):</span><br><span class="line">        my_prime.append(i)</span><br><span class="line">print(<span class="string">&quot;Prime ready! Found&quot;</span>,len(my_prime),<span class="string">&quot;primes.&quot;</span>)</span><br><span class="line"></span><br><span class="line">flag = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> e <span class="keyword">in</span> range(<span class="number">9001</span>,<span class="number">10001</span>,<span class="number">2</span>):</span><br><span class="line">    <span class="keyword">for</span> p <span class="keyword">in</span> my_prime:</span><br><span class="line">        ans = iroot(secret - e**<span class="number">3</span> - p**<span class="number">3</span>,<span class="number">3</span>)</span><br><span class="line">        <span class="keyword">if</span>(ans[<span class="number">1</span>]):</span><br><span class="line">            print(<span class="string">&quot;Ans Found!&quot;</span>)</span><br><span class="line">            q = ans[<span class="number">0</span>]</span><br><span class="line">            print(e,p,q)</span><br><span class="line">            flag = <span class="number">1</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span>(flag):</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">n = p * q</span><br><span class="line">phi = (p<span class="number">-1</span>) * (q<span class="number">-1</span>)</span><br><span class="line">d = inverse(e,phi)</span><br><span class="line">m = pow(c,d,n)</span><br><span class="line">flag = long_to_bytes(m)</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>

<h2 id="Common-Prime-RSA"><a href="#Common-Prime-RSA" class="headerlink" title="Common_Prime_RSA"></a>Common_Prime_RSA</h2><blockquote>
<p><a target="_blank" rel="noopener" href="https://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.33.1333&rep=rep1&type=pdf">paper</a></p>
</blockquote>
<p>如题， $p=2ag+1,q=2bg+1$ ，其中 $g=N^{\beta}$ ，$\beta_1=0.2247,\beta_2=0.3247$ </p>
<p>第一部分， $g$ 显然是个比较小的数，直接coppersmith就能拿到，接着来考虑分解 $N$ ， 显然 $N=p\cdot q=(2ag+1)(2bg+1)=4abg^2+2g(a+b)+1$ ，则</p>
<p>$$\frac{N-1}{2g}=2gab+(a+b)$$</p>
<p>但由于 $\beta=0.2247&lt;0.5$ ，导致 $g&lt;a,b$ ， 我们假设 $\frac{N-1}{2g}=2gu+v$ ，则 $v=a+b-2gc,u=ab+c$ ，那么 $x^{u2g}\equiv x^{ab2g+c2g}\equiv x^{c2g}\pmod{N}$ ，即 ${x^{2g}}^u={x^{2g}}^c$ ，所以我们可以使用 $bsgs$ 算法来得到 $c$ ，因为题目中 $p$ 与 $q$ 较为接近，所以上述的 $a$ 与 $b$ 也比较接近，我们知道 $a\cdot b≈u≈\frac{N}{(2\cdot g1)^2}$ ， 根据对勾函数的性质， $x≈y\in (\sqrt{u},\sqrt{2u})$ ，随后即可得到 $c$ 较为精确的答案区间</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n1 = <span class="number">0x48b11209b62c5bc580d00fc94886272b92814ce35fcd265b2915c6917a299bc54c2c0603c41f8bf7c8f6f2a545eb03d38f99ec995bf6658bb1a2d23056ee21c7230caa2decec688ea9ee00b0d50b39e8cd23eb2c3ddeb20f5ab26777b80052c171f47b716e72f6aee9cece92776fc65119046f9a1ad92c40e2094d7ed7526d49</span></span><br><span class="line">c1 = <span class="number">0x27d8d7249643668ffc115be8b61775c60596e51f6313b47ad5af8493526922f5e10026a2cdaef74e22c3eec959dd8771abe3495b18d19f97623f5a3f65f22ff8fc294fc37ceb3b43ebbbf8a9bcf622922e22c5520dbd523483b9dc54fdffcd1a1b3f02ca1f53b75413fb79399ca00034f2acf108ac9a01bd24d2b9df6e27d156</span></span><br><span class="line">e1 = <span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">kbits = int(1024*0.2247)</span></span><br><span class="line"><span class="string">m0 =  0x436f6d6d6f6e207072696d652052534120697320612076617269616e74206f66205253410000000000000000000000000000000000000000000000000000000000416e642074686520636f6d6d6f6e20666163746f722067206973206c61726765207072696d6520616e6420703d3267612b3120713d3267622b31</span></span><br><span class="line"><span class="string">PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span></span><br><span class="line"><span class="string">f = ((m0 + x*2**464)^e1) - c1</span></span><br><span class="line"><span class="string">f = f.monic()</span></span><br><span class="line"><span class="string">g1 = f.small_roots(X=2^kbits,beta=1)[0]</span></span><br><span class="line"><span class="string">print(g1)</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">g1 = <span class="number">1328458990599515056771144217738449144496664370133586446617480019409757</span></span><br><span class="line">v1 = ((n1 - <span class="number">1</span>) // (<span class="number">2</span>*g1)) % (<span class="number">2</span>*g1)</span><br><span class="line">u1 = ((n1 - <span class="number">1</span>) // (<span class="number">2</span>*g1)) // (<span class="number">2</span>*g1)</span><br><span class="line">left = (((<span class="number">2</span> * iroot(n1,<span class="number">2</span>)[<span class="number">0</span>]) // (<span class="number">2</span>*g1)) - v1) // (<span class="number">2</span>*g1)</span><br><span class="line">right = (((<span class="number">3</span> * iroot(<span class="number">2</span>*n1,<span class="number">2</span>)[<span class="number">0</span>]) // (<span class="number">4</span>*g1)) - v1) // (<span class="number">2</span>*g1)</span><br><span class="line"></span><br><span class="line">dic = &#123;&#125;</span><br><span class="line">b = pow(<span class="number">114514</span>,<span class="number">2</span>*g1,n1)</span><br><span class="line">base = pow(b,left,n1)</span><br><span class="line">D = iroot(right - left,<span class="number">2</span>)[<span class="number">0</span>]+<span class="number">1</span></span><br><span class="line">step = pow(b,D,n1)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(D):</span><br><span class="line">    dic[base] = i</span><br><span class="line">    base = base * step % n1</span><br><span class="line">print(<span class="string">&quot;baby step ready&quot;</span>)</span><br><span class="line"></span><br><span class="line">base = pow(b,u1,n1)</span><br><span class="line">step = inverse(b,n1)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(D):</span><br><span class="line">    <span class="keyword">if</span>(base <span class="keyword">in</span> dic):</span><br><span class="line">        print(<span class="string">&quot;ans found!&quot;</span>)</span><br><span class="line">        print(i,dic[base])</span><br><span class="line">        c = left+ i + D * dic[base]</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    base = base * step % n1</span><br><span class="line"></span><br><span class="line">A = u1 - c</span><br><span class="line">B = v1 + c * <span class="number">2</span> * g1</span><br><span class="line">C = iroot(B**<span class="number">2</span> - <span class="number">4</span>*A,<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line">x = (B+C) // <span class="number">2</span></span><br><span class="line">y = B-x</span><br><span class="line">p1 = x*g1*<span class="number">2</span>+<span class="number">1</span></span><br><span class="line">q1 = y*g1*<span class="number">2</span>+<span class="number">1</span></span><br><span class="line"><span class="keyword">assert</span> p1 * q1 == n1</span><br><span class="line">phi1 = (p1<span class="number">-1</span>) * (q1<span class="number">-1</span>)</span><br><span class="line">e1 = <span class="number">65537</span></span><br><span class="line">d1 = inverse(e1,phi1)</span><br><span class="line">c1 = <span class="number">0xeaf06b9050a809659f962251b14d6b93009a7010f0e8d8f0fa4d71591757e98243b8ff50ec98a4e140fd8a63bbb4b8bb0a6d302a48845b8b09d1e40874fcb586ddccbb0bbf86d21540ec6c15c1d2bf925942f6f384fdc1baae7f8e06150ccd9459eb65d0f07eea16a911fa0a17e876a145dbfec83537ca2bee4641897b9f7f5</span></span><br><span class="line">g2 = pow(c1,d1,n1)</span><br><span class="line"></span><br><span class="line">n2 = <span class="number">0x6d457110d6044472d786936acbd3cd93c7728daa3343b35ccaa5c55eba6b35c28c831bb245b8cdd8fc8cb67a72f57e62a0e1259f5e804c487a8478f6895b302d39277bd73947598a5f8ec0a535be9e9a4d34df91df948ee44cc3d13d14e23b9651089e4767c7f0e7245df55619c92fe24483225d35f5f3ee6f74375065766ffd</span></span><br><span class="line">c2 = <span class="number">0x15be2b0eaef8837a753587c47d3f31696a7d239d88837a9b7d903cd0d0648ef8e225ea555402693a23f305d19e7e13905be61b44c651dba5b26614bcf876234e765a724e0ed8af4a4e408e6a233c48ab9cc63e9c552ef9cd1999512aa0aca830fe6cbcbcc3c6bb354903124a2c3a12d442cdbdefdae6576f4bbc1515051b7111</span></span><br><span class="line">e2 = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">A = ((n2 - <span class="number">1</span>) // (<span class="number">2</span>*g2)) // (<span class="number">2</span>*g2)</span><br><span class="line">B = ((n2 - <span class="number">1</span>) // (<span class="number">2</span>*g2)) % (<span class="number">2</span>*g2)</span><br><span class="line">C = iroot(B**<span class="number">2</span> - <span class="number">4</span>*A,<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line">x = (B+C) // <span class="number">2</span></span><br><span class="line">y = B-x</span><br><span class="line">p2 = x*g2*<span class="number">2</span>+<span class="number">1</span></span><br><span class="line">q2 = y*g2*<span class="number">2</span>+<span class="number">1</span></span><br><span class="line"><span class="keyword">assert</span> p2 * q2 == n2</span><br><span class="line">phi2 = (p2<span class="number">-1</span>) * (q2<span class="number">-1</span>)</span><br><span class="line">d2 = inverse(e2,phi2)</span><br><span class="line">m = pow(c2,d2,n2)</span><br><span class="line">flag = long_to_bytes(m)</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>

<h2 id="strange-GCD"><a href="#strange-GCD" class="headerlink" title="strange_GCD"></a>strange_GCD</h2><blockquote>
<p><a target="_blank" rel="noopener" href="https://martinralbrecht.wordpress.com/2020/03/21/the-approximate-gcd-problem/">paper</a></p>
</blockquote>
<p>给出了9组公钥，满足 $N=P\cdot Q_i+R_i$ ，其中 $P$ 是444位、 $Q$ 是444位、 $R$ 是333位，那么显然只要求出 $P$ 、 $Q$ 其中一个即可，因为<br>$$<br>\begin{equation}\begin{split}<br>Q_1\cdot N_2-Q_2\cdot N_1&amp;=Q_0(Q_1P+R_1)-Q_1(Q_0P+R_2) \\<br>&amp;=Q_0R_1-Q_1R_0 \\<br>&amp;≈Q_{bits}\cdot P_{bits}<br>\end{split}\end{equation}<br>$$<br>所以我们构建这样的一个格子：<br>$$<br>M=<br>\begin{bmatrix}<br>2^{P_{bits}} &amp; x_1 &amp; x_2 &amp; \cdots &amp;x_n \\<br>&amp;-x_0 \\<br>&amp;&amp;-x_0 \\<br>&amp;&amp;&amp;\ddots \\<br>&amp;&amp;&amp;&amp;-x_0<br>\end{bmatrix}<br>$$<br>所以一定存在一个向量 $\vec{v}=(Q_0,Q_2,\cdots,Q_n)$ 满足 $\vec{v}\cdot M=(Q_0·2^P_{bits},Q_0N_1-Q_1N_0,…,Q_0N_n-Q_nN_0)$ ，那么就能得到 $Q_{list}$ ，自然就能分解 $N$ ，正常解密即可</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">N = [<span class="number">8321077117329356263954581766837194016859681833859374146551469738742553789565498761528408178000096341991081753628879035591190841107228873036782248755852096597317053559269854941020999105514186022112075838112491499884564745335454966665835001848999256218403570429047541524272647861099813598603292295695775504244505874838019009730562620216</span>, <span class="number">9663141503982563384103774905603769762205667685102275298721284964403449121449261483138514307090449027807047697811539118959328065885920230514670112839967221129701708335087378871176539521374006686377418843364889059913595942583737991465545688834167085579154677350865488342245644093471665857007588133415608450554035129609049971856915687905</span>, <span class="number">7080633525505006454857949889380886258474613936169915325357991912983821798902257837234148311383635716165386646093418183743215120431715933036921480432793786600194625124412063608565640368381660643929081066605712749838630092722581230189543696229548387666046034403406721477818265752443487173947232032487026509033018565048660685068628813900</span>, <span class="number">6348260112940191945095264085450804431350547836448100928568733296493334845533262312663784701113046746633754397388581143523779371919889446537883618910341310362947454041409541741124231406605654693961025815677260091930522280737378333554694234586235628097018111636491016261274584391201625445101930372416766825601778759258114504767453644116</span>, <span class="number">5453076441876067965962987075376616480678826248967242473452690159966124023105342358461519279607336831463834252487811766366887983597918775466645199024629945952612311092154451713992362747056489054444283302530500475646346968235522866557033556131387030809018889094871163097069588840212411234716020934787724757538389436231926479459435139729</span>, <span class="number">8539092301764573132139384894241535432591998166686651428176862041680365196821019488767353225937458669267710968146783359781905669306801237140282934737328995064410005908343087032652676207615356474601039341695241288937409773110450995503958663731870314493254162942656333393836208952363635746218345484752702086447693272390570444229475023063</span>, <span class="number">6519174659211289290465989985638494640591837577268694359892571134942820094011179335155100770258746122812579164176239810640710311061280175847537113068566174335469669480601670136633042879486860594176408555229541384726863069317134887988109513500264430505092783429319336134768414472691544453196941818593187717904852926051114502346647888426</span>, <span class="number">6961711680362025924587083752271982856615461409839316941574792747717174299272141804413488210456939607971950020060573061131683587521057101549266612028332060247289306929784809695126285828514889617483817766102136513569391338432827451306976412448973958662677599051104723480081915666230391091496248279567627159875132838397868850500912784991</span>, <span class="number">5464727156582411007360377345208743900616053705663005668786499961992377236151787056734059201141143278419642045996194426551642956434137382420547801325331080754615348522599387497424727626522195285281557448617564720973185851757117201639221059630112719699600469361046245232476531622290326229811709079901764559526124144866364301870192468062</span>]</span><br><span class="line">C = [<span class="number">800378461059400239726680783421062702546581299113618553895453491207714321944554499622887232532612118204284779120928524046451494597619154079853122057618867592408424421335915888671560524092660578952242621890439766919785431411789789232309134048322721650012432166587969915464252995890054635969469155870141839815222805619769926841873928532</span>, <span class="number">8685468246369062574820183134847029157229023858170863526469628501966638181721681547114662091162797572149161013458000532984909663639626346493828947027439012131912176125653717020650233650230608573276523862941298063827867869000918623143520066067119099918633173584693454642685133071154989133688921507896223776765538029556643440655490373815</span>, <span class="number">4635611296372235589362291842711945807825964919968727011796279830725567747087132786100965922682161492876463568645940638975728831156672106717718242995621775763972524561170035488180440169190421072680121175269363490806991700969253196228364471655905426168859215651384013432550900570720981720919343406680667172355882395426739478340888619526</span>, <span class="number">742099161415136628218807400531862454374875770332166710320711769923774839345990297388615457974047093967700994503615622499139058644697776431451063778211507061619987487339659448529973693084099004007650792690143707738139278995489030445825999666762580518420739517354868021396496747289677543653758101688499365196709600349831855157276274803</span>, <span class="number">4273006447766599851029197343910625305964779588947130545729882009677080459892767902139074897266046998378948193319329776150920821074305998905666368175737032487336505440974393061632257356697260043478850055918798196360043557336723402834256592984312957607731622934368169520289756716653736422872196593367101920308166527352079412344590114695</span>, <span class="number">1337615323422531101514598853478737615483725265103339849469231329210692205474781484172946466402355800190175297435923447189337380569240535257395618353403524999296122247241720498058900285176383928871155893061316083476812641934026019749574784965397208046520128690081232283708190247657782663414534596381371506499151016470118707739609022847</span>, <span class="number">6153442337491399463730666360630451953223069596225489087488144486112604050064388945200405772892415725900338512969888610774357818442533883395713661512978158729825590405567077341407532331228257558692149544940358814513930330757334104407683768945074261746314376336567331685071086776886141587264981001140113933152084084711732651014186070962</span>, <span class="number">3604640305526232611907645024550062043296875756707299105733076926046725900367109300556792007038226350415916164581084668832286944703572581980333135146219609212135443758296278947833224676930513359604019639508959092586550129343133801670578311053639151186604019506764426302411065588655525183584977810609190948096510237056027272167828516985</span>, <span class="number">2085633143403792178757363870459578017278494765962824809917819295576034993395441252397370078671500834434293581806342828037037877739374959864038090394888141183851040814572501861997433316552606005140700519616064369570511427453278726929921212633252656552135711332324923683242632912449218888750151556281762432994484741408165895663710356342</span>]</span><br><span class="line"></span><br><span class="line">M = [[<span class="number">1</span>&lt;&lt;<span class="number">334</span>]+N[<span class="number">1</span>:]]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(N)<span class="number">-1</span>):</span><br><span class="line">    M.append([<span class="number">0</span>]*(i+<span class="number">1</span>)+[-N[<span class="number">0</span>]]+[<span class="number">0</span>]*(len(N)-i<span class="number">-2</span>))</span><br><span class="line"><span class="comment"># print(M)</span></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">M = [</span></span><br><span class="line"><span class="string">    [34996011596528190789960035633881941845650710894291398982812329702559247987190014771576210832368861184, 9663141503982563384103774905603769762205667685102275298721284964403449121449261483138514307090449027807047697811539118959328065885920230514670112839967221129701708335087378871176539521374006686377418843364889059913595942583737991465545688834167085579154677350865488342245644093471665857007588133415608450554035129609049971856915687905, 7080633525505006454857949889380886258474613936169915325357991912983821798902257837234148311383635716165386646093418183743215120431715933036921480432793786600194625124412063608565640368381660643929081066605712749838630092722581230189543696229548387666046034403406721477818265752443487173947232032487026509033018565048660685068628813900, 6348260112940191945095264085450804431350547836448100928568733296493334845533262312663784701113046746633754397388581143523779371919889446537883618910341310362947454041409541741124231406605654693961025815677260091930522280737378333554694234586235628097018111636491016261274584391201625445101930372416766825601778759258114504767453644116, 5453076441876067965962987075376616480678826248967242473452690159966124023105342358461519279607336831463834252487811766366887983597918775466645199024629945952612311092154451713992362747056489054444283302530500475646346968235522866557033556131387030809018889094871163097069588840212411234716020934787724757538389436231926479459435139729, 8539092301764573132139384894241535432591998166686651428176862041680365196821019488767353225937458669267710968146783359781905669306801237140282934737328995064410005908343087032652676207615356474601039341695241288937409773110450995503958663731870314493254162942656333393836208952363635746218345484752702086447693272390570444229475023063, 6519174659211289290465989985638494640591837577268694359892571134942820094011179335155100770258746122812579164176239810640710311061280175847537113068566174335469669480601670136633042879486860594176408555229541384726863069317134887988109513500264430505092783429319336134768414472691544453196941818593187717904852926051114502346647888426, 6961711680362025924587083752271982856615461409839316941574792747717174299272141804413488210456939607971950020060573061131683587521057101549266612028332060247289306929784809695126285828514889617483817766102136513569391338432827451306976412448973958662677599051104723480081915666230391091496248279567627159875132838397868850500912784991, 5464727156582411007360377345208743900616053705663005668786499961992377236151787056734059201141143278419642045996194426551642956434137382420547801325331080754615348522599387497424727626522195285281557448617564720973185851757117201639221059630112719699600469361046245232476531622290326229811709079901764559526124144866364301870192468062], </span></span><br><span class="line"><span class="string">    [0, -8321077117329356263954581766837194016859681833859374146551469738742553789565498761528408178000096341991081753628879035591190841107228873036782248755852096597317053559269854941020999105514186022112075838112491499884564745335454966665835001848999256218403570429047541524272647861099813598603292295695775504244505874838019009730562620216, 0, 0, 0, 0, 0, 0, 0], </span></span><br><span class="line"><span class="string">    [0, 0, -8321077117329356263954581766837194016859681833859374146551469738742553789565498761528408178000096341991081753628879035591190841107228873036782248755852096597317053559269854941020999105514186022112075838112491499884564745335454966665835001848999256218403570429047541524272647861099813598603292295695775504244505874838019009730562620216, 0, 0, 0, 0, 0, 0], </span></span><br><span class="line"><span class="string">    [0, 0, 0, -8321077117329356263954581766837194016859681833859374146551469738742553789565498761528408178000096341991081753628879035591190841107228873036782248755852096597317053559269854941020999105514186022112075838112491499884564745335454966665835001848999256218403570429047541524272647861099813598603292295695775504244505874838019009730562620216, 0, 0, 0, 0, 0], </span></span><br><span class="line"><span class="string">    [0, 0, 0, 0, -8321077117329356263954581766837194016859681833859374146551469738742553789565498761528408178000096341991081753628879035591190841107228873036782248755852096597317053559269854941020999105514186022112075838112491499884564745335454966665835001848999256218403570429047541524272647861099813598603292295695775504244505874838019009730562620216, 0, 0, 0, 0], </span></span><br><span class="line"><span class="string">    [0, 0, 0, 0, 0, -8321077117329356263954581766837194016859681833859374146551469738742553789565498761528408178000096341991081753628879035591190841107228873036782248755852096597317053559269854941020999105514186022112075838112491499884564745335454966665835001848999256218403570429047541524272647861099813598603292295695775504244505874838019009730562620216, 0, 0, 0], </span></span><br><span class="line"><span class="string">    [0, 0, 0, 0, 0, 0, -8321077117329356263954581766837194016859681833859374146551469738742553789565498761528408178000096341991081753628879035591190841107228873036782248755852096597317053559269854941020999105514186022112075838112491499884564745335454966665835001848999256218403570429047541524272647861099813598603292295695775504244505874838019009730562620216, 0, 0], </span></span><br><span class="line"><span class="string">    [0, 0, 0, 0, 0, 0, 0, -8321077117329356263954581766837194016859681833859374146551469738742553789565498761528408178000096341991081753628879035591190841107228873036782248755852096597317053559269854941020999105514186022112075838112491499884564745335454966665835001848999256218403570429047541524272647861099813598603292295695775504244505874838019009730562620216, 0], </span></span><br><span class="line"><span class="string">    [0, 0, 0, 0, 0, 0, 0, 0, -8321077117329356263954581766837194016859681833859374146551469738742553789565498761528408178000096341991081753628879035591190841107228873036782248755852096597317053559269854941020999105514186022112075838112491499884564745335454966665835001848999256218403570429047541524272647861099813598603292295695775504244505874838019009730562620216]</span></span><br><span class="line"><span class="string">]</span></span><br><span class="line"><span class="string">M = Matrix(ZZ,M)</span></span><br><span class="line"><span class="string">ans = M.LLL()[0]</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">ans = (<span class="number">4599191779324727072633164871296325902208765537352604303273175255453504312615500983406477011435819405305852059674048438016100668090246407849496908743817335622801573073136122188609246369046057261291320848819844418920893230598376364951805862565686868625621955071425273509220849374947161975251582041718784</span>, <span class="number">104098035638581595369723778375711537486830709046687306114704921816239533823901066113680320504395210089789340199402154288158599251547931748565815387310900885326892681968536308019715590493310968628489043723240348362149053110811668282038727688689374505928586075094912392544924601844136642390813222425809</span>, <span class="number">1102834391862716869946827309486981604079530638763397950737361315055931768373793498250981455412829162997772327814660070857951309312894092377859437366989526531813223828179941289064128320123411973263239142716310770401174174815638810202859450962632995611863799694649198457635953086959463939627719575381012</span>, <span class="number">753994729336183961852361196205654448289304004519434287316796470222521627865083763102251102951626213588497716067551706990220346381353586508856365765536744873026409087910505560761761024675350156647185336440841519838638415417607956807382719719007131540587566462617043290548957627028678429439567176392108</span>, <span class="number">-71708524916293121808333775279085691365967960919759775147913431698619192878017855212957980666806523648996086462040461850162074426038300683815953081712090679643498963889027587516137252350693864785830427057530016147319149926968346502476418390469709928547235995568090970863872980806983047965126211827423</span>, <span class="number">-1031944069356990593465028628753183012193322903943969718261363844383250576817774501764794204795605186147444430878687291921605373814843580367545369212301939780213941922732623750390324618190490307261983930269957183493345355165692496865409582827167136484989492550271511982793001065621702409883049993239817</span>, <span class="number">-1960547215826715829528682564527292643865866291188443591530567078511330848396016229325567425830200701694380104625201031396661972809519249893882531604307311435727272867042265335921514343841646164420771255718802644103398765492144311189111408831887333483581772033575516358581006829893858562536866631199694</span>, <span class="number">-1402335387560657499009395932180425308829816453818907356038567333645529829409747360872073366794556975860774421104509218449157997408918101385420918273310166387609041772539330599075043569860214109051067579537008367501834723009929827486300772678346407596106869832512579102180928086682172345775047825906065</span>, <span class="number">6492859743402427013224957526773612476031280993044690607784160057686880229209831538939045987606076773313125546427811186808795218860181360435151657439459135171731642225975056613348164819235317913083153227881911185574679170305638348499347070097938480392885289493284095645409615468925393679398090634630</span>)</span><br><span class="line">Q = []</span><br><span class="line">Q.append(ans[<span class="number">0</span>]&gt;&gt;<span class="number">333</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,len(ans)):</span><br><span class="line">    Q.append(-(ans[i]-Q[<span class="number">0</span>]*N[i])//N[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">P = N[<span class="number">0</span>] // Q[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">e = <span class="number">0x1337</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(C)):</span><br><span class="line">    flag += long_to_bytes(pow(C[i],inverse(e,(P<span class="number">-1</span>)*(Q[i]<span class="number">-1</span>)),(P*Q[i])))[<span class="number">-5</span>:]</span><br><span class="line">    print(flag)</span><br></pre></td></tr></table></figure>

<h2 id="strange-CRT"><a href="#strange-CRT" class="headerlink" title="strange_CRT"></a>strange_CRT</h2><blockquote>
<p><a target="_blank" rel="noopener" href="https://link.springer.com/content/pdf/10.1007%2F3-540-45708-9_16.pdf">paper</a></p>
</blockquote>
<p>二元的coppersmith，首先有 $e\cdot dq=1\pmod{q-1}$ ，即 $e\cdot dq-k\cdot(q-1)-1=0$ ，即 $e\cdot dq+k-1=k\cdot q$ ，因为 $dq$ 只有40位，所以 $dq$ 和 $k$ 都比较小，我们设 $f(x,y)=ex+y$ ，一定存在一个根 $(dq,k-1)$ ，我们使用 $x-shifted$ 方法构造方程组，</p>
<p>$$<br>B_P(4)=<br>\begin{bmatrix}<br>N^2X^3 \\<br>eNX^3 &amp; -NX^2Y \\<br>e^2X^3 &amp; -2eX^2Y &amp; XY^2 \\<br>e^3X^3 &amp; -3e^2X^2Y &amp; 3eXY^2 &amp; -Y^3<br>\end{bmatrix}<br>$$<br>随后找到根 $(dq,k-1)$ ，即可分解 $N$ 了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = <span class="number">7194944829894746935571965271122989443610702698015123026500274312320541540511952275333536082176132102091625202863345739074691901574020649953130369453360247690506566827078013306825941200018330639608298539682191482947557146237487451707849833303794107411686130468587672820352641436722348277258977791778239539008852841749667581869688275892813664557078043533743669277649148468667399393518112220602616186358353262921270486781426670131125521444335280904901224934061164334131460273779473387748722008412594372005590209919098686472153912130124772089012962023984089123929555594332030502775588070235834837667605812843128059372243</span></span><br><span class="line">e = <span class="number">5872666789397408936685003821802975734744078884385553897196686533187747297681714766542317071546532454504513425295170366015384657690105523240363850101369048640430719519784564240908244756652800934680608667950183962226340288720771217107508516125044088043789281574833079766048266075717484676158307477384862873719462770774288252074344824446884295300603035728339571606659365040029505127532956295163195257002051007447197735267997104725561159289832252522298457628452222155625714679911912616173849423059919537353814530280736653541415686756485413316581322357887750268983241858913704388088485132644523120028234659344174431547087</span></span><br><span class="line">c = <span class="number">6601667269134560091452287214083525217696007424340765571114688738279264700361513951309195757650152324371826111195352731779137577044473630747863137747356695892337017953751159248388157498368915463745769509485009626774902347006319659852239932231921393353157319713540010424345134411781723171111939891127671029064626426950125001347122070491553845919803891156107693973027238705710354919725550360159383455222982999904576805089837067774838194257113022653159325313574447189639317397889065351340828031907571541750274329094240472180870714728295651611160552345500801797030280900507979459558944006193012524181456837126192865748097</span></span><br><span class="line">m = <span class="number">114514</span></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">beta = 0.34</span></span><br><span class="line"><span class="string">delta = 0.02</span></span><br><span class="line"><span class="string">amplification = 2048</span></span><br><span class="line"><span class="string">X = int(pow(n,delta) * (5/2))</span></span><br><span class="line"><span class="string">Y = int(pow(n,(beta+delta)) * (5/2))</span></span><br><span class="line"><span class="string">M = []</span></span><br><span class="line"><span class="string">M.append([n*n*X*X*X,0,0,0])</span></span><br><span class="line"><span class="string">M.append([e*n*X*X*X,-n*X*X*Y,0,0])</span></span><br><span class="line"><span class="string">M.append([e*e*X*X*X,-2*e*X*X*Y,X*Y*Y,0])</span></span><br><span class="line"><span class="string">M.append([e*e*e*X*X*X,-3*e*e*X*X*Y,3*e*X*Y*Y,-Y*Y*Y])</span></span><br><span class="line"><span class="string">M = Matrix(M)</span></span><br><span class="line"><span class="string">A = M.LLL()[0]</span></span><br><span class="line"><span class="string">p = []</span></span><br><span class="line"><span class="string">p.append(A[0]//(X**3))</span></span><br><span class="line"><span class="string">p.append(A[1]//(X^2*Y))</span></span><br><span class="line"><span class="string">p.append(A[2]//(X*Y^2))</span></span><br><span class="line"><span class="string">p.append(A[3]//(Y^3))</span></span><br><span class="line"><span class="string">R.&lt;x,y&gt; = ZZ[]</span></span><br><span class="line"><span class="string">f = x**3*p[0] + x**2*y*p[1] + x*y**2*p[2] + y**3*p[3]</span></span><br><span class="line"><span class="string">f.factor()</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">(-1) * (144242809483056840663075735623298553029680437297789965222541248349475437890222709450048997656976387390752105996145725490546933534602744908786700426835710727511955799912350818546609860818884274334936799981304721460528637717*x + 636751972323*y) * (22360612316620576265962363998986325309879295954423979763235633587165509772463851121464450246995467551277856854280313242339679743870302000793124620978436719868879086932947083203923324893801655101558128409321266258664105566594644972878236716985754511292295147466953475408456421662883470405599945529089115443773171753380747253399676451061853675376543473713650224588466737340581901289431253330538396922770846601154595827366651699780258116005162252520473266535156064285895366446187694020122502168871153774940666139567620938830703125690675687869510298889906793*x^2 + 267647155976378743685890593144685469708715653490308593667201283907775452606689307120817149553958120371639890271685148603015657241238590179583153694790949220206995033824074078242830758458739742301161015368049847345525661233185551949155450470189603595130241004416639482696460716023144193868351704190287775402159037407591606868297555272291534131071*x*y - 1177035497855139471300150596073079881470359423070664560562543221821780066461677777154411563960425838478371703085673516387654415520557027*y^2)</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">k = <span class="number">144242809483056840663075735623298553029680437297789965222541248349475437890222709450048997656976387390752105996145725490546933534602744908786700426835710727511955799912350818546609860818884274334936799981304721460528637717</span> + <span class="number">1</span></span><br><span class="line">dq = <span class="number">636751972323</span></span><br><span class="line">q = (e * dq + k - <span class="number">1</span>) // k</span><br><span class="line">p = n // q</span><br><span class="line"><span class="keyword">assert</span> n == p * q</span><br><span class="line">phi = (p<span class="number">-1</span>) * (q<span class="number">-1</span>)</span><br><span class="line">d = inverse(e,phi)</span><br><span class="line">m = pow(c,d,n)</span><br><span class="line">flag = long_to_bytes(m)</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Dawn_whisper</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://example.com/2021/04/16/Wp_for_mrctf2021/">http://example.com/2021/04/16/Wp_for_mrctf2021/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank">Dawn_whisper's blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Crypto/">Crypto</a><a class="post-meta__tags" href="/tags/Writeup/">Writeup</a></div><div class="post_share"><div class="social-share" data-image="/img/top_img.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button button--animated"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat.png" target="_blank"><img class="post-qr-code-img" src="/img/wechat.png" alt="wechat"/></a><div class="post-qr-code-desc">wechat</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2021/06/20/Frist_AWD_at_ciscn2021/"><img class="prev-cover" src="/img/top_img.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">First AWD at ciscn2021</div></div></a></div><div class="next-post pull-right"><a href="/2021/03/27/Writeup_for_MAR_DASCTF's_crypto/"><img class="next-cover" src="/img/top_img.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Writeup for MAR DASCTF's crypto</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> 相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2021/03/27/Writeup_for_MAR_DASCTF's_crypto/" title="Writeup for MAR DASCTF's crypto"><img class="cover" src="/img/top_img.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-03-27</div><div class="title">Writeup for MAR DASCTF's crypto</div></div></a></div><div><a href="/2021/03/14/Writeup_for_V&NCTF2021's_crypto/" title="Writeup for V&NCTF's crypto"><img class="cover" src="/img/top_img.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-03-14</div><div class="title">Writeup for V&NCTF's crypto</div></div></a></div><div><a href="/2021/03/08/Wp_for_AntCTF_X_D^3CTF's_crypto/" title="Write up for AntCTF X D^3CTF's crypto"><img class="cover" src="/img/top_img.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-03-08</div><div class="title">Write up for AntCTF X D^3CTF's crypto</div></div></a></div><div><a href="/2021/01/19/Wp_for_星ctf's_crypto/" title="Write up for *ctf2021"><img class="cover" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-01-19</div><div class="title">Write up for *ctf2021</div></div></a></div><div><a href="/2020/12/23/Wp-for-华为XCTF2020-s-crypto/" title="Wp for 华为XCTF2020鸿蒙计算专场's crypto"><img class="cover" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-12-23</div><div class="title">Wp for 华为XCTF2020鸿蒙计算专场's crypto</div></div></a></div><div><a href="/2020/12/07/Wp_for_SWPUCTF2020/" title="Write up for SWPUCTF2020's Crypto"><img class="cover" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-12-07</div><div class="title">Write up for SWPUCTF2020's Crypto</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-info-avatar is-center"><img class="avatar-img" src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">Dawn_whisper</div><div class="author-info__description">弱到不行的crypto手+退役OI选手</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">30</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">10</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">6</div></a></div></div><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/dawnwhisper" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:dawn_whisper@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="https://space.bilibili.com/179833081" target="_blank" title="Bilibili"><i class="fas fa-heartbeat"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">Welcome to Dawn_whisper's blog~   If you have any idea about my blog, plz send an email to me~</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Writeup-for-MRCTF2021-39-s-crypto"><span class="toc-number">1.</span> <span class="toc-text">Writeup for MRCTF2021&#39;s crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#friendly-sign-in"><span class="toc-number">1.1.</span> <span class="toc-text">friendly_sign-in</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#nomore"><span class="toc-number">1.2.</span> <span class="toc-text">nomore</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Common-Prime-RSA"><span class="toc-number">1.3.</span> <span class="toc-text">Common_Prime_RSA</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#strange-GCD"><span class="toc-number">1.4.</span> <span class="toc-text">strange_GCD</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#strange-CRT"><span class="toc-number">1.5.</span> <span class="toc-text">strange_CRT</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2022/07/13/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/" title="内网渗透笔记">内网渗透笔记</a><time datetime="2022-07-13T02:58:41.000Z" title="发表于 2022-07-13 10:58:41">2022-07-13</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2021/10/09/2021%E9%A2%86%E8%88%AA%E6%9D%AF/" title="2021领航杯 &amp; 蚌埠住了">2021领航杯 &amp; 蚌埠住了</a><time datetime="2021-10-09T15:09:20.000Z" title="发表于 2021-10-09 23:09:20">2021-10-09</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2021/06/26/AWD%E6%A1%86%E6%9E%B6/" title="AWD框架">AWD框架</a><time datetime="2021-06-26T11:42:06.000Z" title="发表于 2021-06-26 19:42:06">2021-06-26</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2021/06/20/Frist_AWD_at_ciscn2021/" title="First AWD at ciscn2021">First AWD at ciscn2021</a><time datetime="2021-06-20T04:51:30.000Z" title="发表于 2021-06-20 12:51:30">2021-06-20</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2021/04/16/Wp_for_mrctf2021/" title="Writeup for MRCTF2021 crypto">Writeup for MRCTF2021 crypto</a><time datetime="2021-04-16T11:58:26.000Z" title="发表于 2021-04-16 19:58:26">2021-04-16</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('/img/top_img.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2022 By Dawn_whisper</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    loader: {
      source: {
        '[tex]/amsCd': '[tex]/amscd'
      }
    },
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, ''],
        addClass: [200,() => {
          document.querySelectorAll('mjx-container:not([display=\'true\']').forEach( node => {
            const target = node.parentNode
            if (!target.classList.contains('has-jax')) {
              target.classList.add('mathjax-overflow')
            }
          })
        }, '', false]
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typeset()
}</script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.css"><script>(() => {
  document.querySelectorAll('#article-container span.katex-display').forEach(item => {
    btf.wrap(item, 'div', '', 'katex-wrap')
  })
})()</script></div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/fireworks.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>